<<<<<<< HEAD
!function(){var Ajax={settings:{},post:function(t){return new AjaxRequest("post",t)},get:function(t){return new AjaxRequest("get",t)}},AjaxRequest=function(t,e){var i={method:t,url:"",before:function(){},success:function(){},error:function(){},data:!1,async:!0,headers:{}};this.p=this.extend(i,e),this.p=this.extend(this.p,Ajax.settings),this.p.method=this.p.method.toUpperCase(),this.prepareData(),this.xhr=new XMLHttpRequest,this.xhr.open(this.p.method,this.p.url,this.p.async),this.setHeaders(),!1!==("function"!=typeof this.p.before||this.p.before(this.xhr))&&this.send()};AjaxRequest.prototype={extend:function(t,e){if(e)for(var i in e)t[i]=e[i];return t},prepareData:function(){"POST"!==this.p.method||this.isFormData()||(this.p.headers["Content-Type"]="application/x-www-form-urlencoded"),"object"!=typeof this.p.data||this.isFormData()||(this.p.data=this.toParams(this.p.data)),"GET"===this.p.method&&(this.p.url=this.p.data?this.p.url+"?"+this.p.data:this.p.url)},setHeaders:function(){for(var t in this.xhr.setRequestHeader("X-Requested-With",this.p.headers["X-Requested-With"]||"XMLHttpRequest"),this.p.headers)this.xhr.setRequestHeader(t,this.p.headers[t])},isFormData:function(){return void 0!==window.FormData&&this.p.data instanceof window.FormData},isComplete:function(){return!(this.xhr.status<200||this.xhr.status>=300&&304!==this.xhr.status)},send:function(){this.p.async?(this.xhr.onload=this.loaded.bind(this),this.xhr.send(this.p.data)):(this.xhr.send(this.p.data),this.loaded.call(this))},loaded:function(){if(this.isComplete()){var t=this.xhr.response,e=this.parseJson(t);t=e||t,"function"==typeof this.p.success&&this.p.success(t,this.xhr)}else"function"==typeof this.p.error&&this.p.error(this.xhr.statusText)},parseJson:function(t){try{var e=JSON.parse(t);if(e&&"object"==typeof e)return e}catch(t){}return!1},toParams:function(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}};var DomCache=[0],DomExpando="data"+(new Date).getTime(),DomHClass="is-hidden",DomHMClass="is-hidden-mobile",Dom=function(t,e){return this.parse(t,e)};Dom.ready=function(t){"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)},Dom.prototype={get dom(){return!0},get length(){return this.nodes.length},parse:function(t,e){var i;if(t){if(t.dom)return this.nodes=t.nodes,t;i="string"!=typeof t?t.nodeType&&11===t.nodeType?t.childNodes:t.nodeType||t===window?[t]:t:/^\s*<(\w+|!)[^>]*>/.test(t)?this.create(t):this._query(t,e)}else i=[];this.nodes=this._slice(i)},create:function(t){if(/^<(\w+)\s*\/?>(?:<\/\1>|)$/.test(t))return[document.createElement(RegExp.$1)];var e=[],i=document.createElement("div"),s=i.childNodes;i.innerHTML=t;for(var n=0,o=s.length;n<o;n++)e.push(s[n]);return e},add:function(t){this.nodes=this.nodes.concat(this._toArray(t))},get:function(t){return this.nodes[t||0]||!1},getAll:function(){return this.nodes},eq:function(t){return new Dom(this.nodes[t])},first:function(){return new Dom(this.nodes[0])},last:function(){return new Dom(this.nodes[this.nodes.length-1])},contents:function(){return this.get().childNodes},each:function(t){for(var e=this.nodes.length,i=0;i<e;i++)t.call(this,this.nodes[i].dom?this.nodes[i].get():this.nodes[i],i);return this},is:function(t){return this.filter(t).length>0},filter:function(t){var e;return void 0===t?this:(e="function"==typeof t?t:function(e){return t instanceof Node?t===e:t&&t.dom?-1!==t.nodes.indexOf(e):(e.matches=e.matches||e.msMatchesSelector||e.webkitMatchesSelector,1===e.nodeType&&e.matches(t||"*"))},new Dom(this.nodes.filter(e)))},not:function(t){return this.filter(function(e){return!new Dom(e).is(t||!0)})},find:function(t){var e=[];return this.each(function(i){for(var s=this._query(t||"*",i),n=0;n<s.length;n++)e.push(s[n])}),new Dom(e)},children:function(t){var e=[];return this.each(function(t){if(t.children)for(var i=t.children,s=0;s<i.length;s++)e.push(i[s])}),new Dom(e).filter(t)},parent:function(t){var e=[];return this.each(function(t){t.parentNode&&e.push(t.parentNode)}),new Dom(e).filter(t)},parents:function(t,e){e=this._getContext(e);var i=[];return this.each(function(s){for(var n=s.parentNode;n&&n!==e;)t?new Dom(n).is(t)&&i.push(n):i.push(n),n=n.parentNode}),new Dom(i)},closest:function(t,e){e=this._getContext(e);var i=[],s=(t=t.dom?t.get():t)&&t.nodeType;return this.each(function(n){do{if(s&&n===t||new Dom(n).is(t))return i.push(n)}while((n=n.parentNode)&&n!==e)}),new Dom(i)},next:function(t){return this._getSibling(t,"nextSibling")},nextElement:function(t){return this._getSibling(t,"nextElementSibling")},prev:function(t){return this._getSibling(t,"previousSibling")},prevElement:function(t){return this._getSibling(t,"previousElementSibling")},css:function(t,e){if(void 0===e&&"object"!=typeof t){var i=this.get();return"width"===t||"height"===t?i.style?this._getHeightOrWidth(t,i,!1)+"px":void 0:i.style?getComputedStyle(i,null)[t]:void 0}return this.each(function(i){var s={};for(var n in"object"==typeof t?s=t:s[t]=e,s)i.style&&(i.style[n]=s[n])})},attr:function(t,e,i){if(i=i?"data-":"",void 0===e&&"object"!=typeof t){var s=this.get();return s&&3!==s.nodeType?"checked"===t?s.checked:this._getBooleanFromStr(s.getAttribute(i+t)):void 0}return this.each(function(s){var n={};for(var o in"object"==typeof t?n=t:n[t]=e,n)3!==s.nodeType&&("checked"===o?s.checked=n[o]:s.setAttribute(i+o,n[o]))})},data:function(t,e){if(void 0===t){var i=/^data\-(.+)$/,s=this.get().attributes,n={},o=function(t){return t[1].toUpperCase()};for(var r in s)if(s[r]&&i.test(s[r].nodeName)){var a=s[r].nodeName.match(i)[1],l=s[r].value;a=a.replace(/-([a-z])/g,o),l=this._isObjectString(l)?this._toObject(l):this._isNumber(l)?parseFloat(l):this._getBooleanFromStr(l),n[a]=l}return n}return this.attr(t,e,!0)},val:function(t){if(void 0===t){var e=this.get();return e.type&&"checkbox"===e.type?e.checked:e.value}return this.each(function(e){e.value=t})},removeAttr:function(t){return this.each(function(e){t.split(" ").forEach(function(t){3!==e.nodeType&&e.removeAttribute(t)})})},removeData:function(t){return this.each(function(e){t.split(" ").forEach(function(t){3!==e.nodeType&&e.removeAttribute("data-"+t)})})},dataset:function(t,e){return this.each(function(i){DomCache[this.dataindex(i)][t]=e})},dataget:function(t){return DomCache[this.dataindex(this.get())][t]},dataindex:function(t){var e=t[DomExpando],i=DomCache.length;return e||(e=t[DomExpando]=i,DomCache[e]={}),e},addClass:function(t){return this._eachClass(t,"add")},removeClass:function(t){return this._eachClass(t,"remove")},toggleClass:function(t){return this._eachClass(t,"toggle")},hasClass:function(t){return this.nodes.some(function(e){return!!e.classList&&e.classList.contains(t)})},empty:function(){return this.each(function(t){t.innerHTML=""})},html:function(t){return void 0===t?this.get().innerHTML||"":this.empty().append(t)},text:function(t){return void 0===t?this.get().textContent||"":this.each(function(e){e.textContent=t})},after:function(t){return this._inject(t,function(t,e){if("string"==typeof t)e.insertAdjacentHTML("afterend",t);else for(var i=t instanceof Node?[t]:this._toArray(t).reverse(),s=0;s<i.length;s++)e.parentNode.insertBefore(i[s],e.nextSibling);return e})},before:function(t){return this._inject(t,function(t,e){if("string"==typeof t)e.insertAdjacentHTML("beforebegin",t);else for(var i=t instanceof Node?[t]:this._toArray(t),s=0;s<i.length;s++)e.parentNode.insertBefore(i[s],e);return e})},append:function(t){return this._inject(t,function(t,e){if("string"==typeof t||"number"==typeof t)e.insertAdjacentHTML("beforeend",t);else for(var i=t instanceof Node?[t]:this._toArray(t),s=0;s<i.length;s++)e.appendChild(i[s]);return e})},prepend:function(t){return this._inject(t,function(t,e){if("string"==typeof t||"number"==typeof t)e.insertAdjacentHTML("afterbegin",t);else for(var i=t instanceof Node?[t]:this._toArray(t).reverse(),s=0;s<i.length;s++)e.insertBefore(i[s],e.firstChild);return e})},wrap:function(t){return this._inject(t,function(t,e){var i="string"==typeof t||"number"==typeof t?this.create(t)[0]:t instanceof Node?t:this._toArray(t)[0];return e.parentNode&&e.parentNode.insertBefore(i,e),i.appendChild(e),new Dom(i)})},unwrap:function(){return this.each(function(t){var e=new Dom(t);return e.replaceWith(e.contents())})},replaceWith:function(t){return this._inject(t,function(t,e){for(var i=document.createDocumentFragment(),s="string"==typeof t||"number"==typeof t?this.create(t):t instanceof Node?[t]:this._toArray(t),n=0;n<s.length;n++)i.appendChild(s[n]);var o=i.childNodes[0];return e.parentNode.replaceChild(i,e),o})},remove:function(){return this.each(function(t){t.parentNode&&t.parentNode.removeChild(t)})},clone:function(t){var e=[];return this.each(function(i){var s=this._clone(i);t&&(s=this._cloneEvents(i,s)),e.push(s)}),new Dom(e)},show:function(){return this.each(function(t){if(t.style&&this._hasDisplayNone(t)){var e,i=t.getAttribute("domTargetShow"),s=!!t.classList&&t.classList.contains(DomHClass),n=!!t.classList&&t.classList.contains(DomHMClass);s?(e=DomHClass,t.classList.remove(DomHClass)):n?(e=DomHMClass,t.classList.remove(DomHMClass)):t.style.display=i||"block",e&&t.setAttribute("domTargetHide",e),t.removeAttribute("domTargetShow")}}.bind(this))},hide:function(){return this.each(function(t){if(t.style&&!this._hasDisplayNone(t)){var e=t.style.display,i=t.getAttribute("domTargetHide");i===DomHClass?t.classList.add(DomHClass):i===DomHMClass?t.classList.add(DomHMClass):("block"!==e&&t.setAttribute("domTargetShow",e),t.style.display="none"),t.removeAttribute("domTargetHide")}})},scrollTop:function(t){var e=this.get(),i=e===window,s=9===e.nodeType,n=s?document.scrollingElement||document.body.parentNode||document.body||document.documentElement:e;if(void 0===t)return s?void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0:i?window.pageYOffset:n.scrollTop;i?window.scrollTo(0,t):n.scrollTop=t},offset:function(){return this._getDim("Offset")},position:function(){return this._getDim("Position")},width:function(t,e){return this._getSize("width","Width",t,e)},height:function(t,e){return this._getSize("height","Height",t,e)},outerWidth:function(){return this._getInnerOrOuter("width","outer")},outerHeight:function(){return this._getInnerOrOuter("height","outer")},innerWidth:function(){return this._getInnerOrOuter("width","inner")},innerHeight:function(){return this._getInnerOrOuter("height","inner")},click:function(){return this._triggerEvent("click")},focus:function(){return this._triggerEvent("focus")},trigger:function(t){return this.each(function(e){for(var i=t.split(" "),s=0;s<i.length;s++){var n;try{n=new window.CustomEvent(i[s],{bubbles:!0,cancelable:!0})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent(i[s],!0,!0)}e.dispatchEvent(n)}})},on:function(t,e,i){return this.each(function(s){for(var n=t.split(" "),o=0;o<n.length;o++){var r=this._getEventName(n[o]),a=this._getEventNamespace(n[o]);e=i?this._getOneHandler(e,t):e,s.addEventListener(r,e),s._e=s._e||{},s._e[a]=s._e[a]||{},s._e[a][r]=s._e[a][r]||[],s._e[a][r].push(e)}})},one:function(t,e){return this.on(t,e,!0)},off:function(t,e){var i=function(t,e,i){return t===i},s=function(t,e,i,s){return e===s},n=function(t,e,i,s){return t===i&&e===s},o=function(){return!0};return void 0===t?this.each(function(t){this._offEvent(t,!1,!1,e,o)}):this.each(function(o){for(var r=t.split(" "),a=0;a<r.length;a++){var l=this._getEventName(r[a]),h=this._getEventNamespace(r[a]);"_events"===h?this._offEvent(o,l,h,e,i):l||"_events"===h?this._offEvent(o,l,h,e,n):this._offEvent(o,l,h,e,s)}})},serialize:function(t){for(var e={},i=this.get().elements,s=0;s<i.length;s++){var n=i[s];if((!/(checkbox|radio)/.test(n.type)||n.checked)&&(n.name&&!n.disabled&&"file"!==n.type)){if("select-multiple"===n.type)for(var o=0;o<n.options.length;o++){var r=n.options[o];r.selected&&(e[n.name]=r.value)}e[n.name]=this._isNumber(n.value)?parseFloat(n.value):this._getBooleanFromStr(n.value)}}return t?e:this._toParams(e)},ajax:function(t,e){if(void 0!==AjaxRequest){var i=this.attr("method")||"post",s={url:this.attr("action"),data:this.serialize(),success:t,error:e};return new AjaxRequest(i,s)}},_queryContext:function(t,e){return 3!==(e=this._getContext(e)).nodeType&&"function"==typeof e.querySelectorAll?e.querySelectorAll(t):[]},_query:function(t,e){if(e)return this._queryContext(t,e);if(/^[.#]?[\w-]*$/.test(t)){if("#"===t[0]){var i=document.getElementById(t.slice(1));return i?[i]:[]}return"."===t[0]?document.getElementsByClassName(t.slice(1)):document.getElementsByTagName(t)}return document.querySelectorAll(t)},_getContext:function(t){return(t="string"==typeof t?document.querySelector(t):t)&&t.dom?t.get():t||document},_inject:function(t,e){for(var i=this.nodes.length,s=[];i--;){var n="function"==typeof t?t.call(this,this.nodes[i]):t,o=0===i?n:this._clone(n),r=e.call(this,o,this.nodes[i]);r&&(r.dom?s.push(r.get()):s.push(r))}return new Dom(s)},_cloneEvents:function(t,e){var i=t._e;if(i)for(var s in e._e=i,i._events)for(var n=0;n<i._events[s].length;n++)e.addEventListener(s,i._events[s][n]);return e},_clone:function(t){if(void 0!==t)return"string"==typeof t?t:t instanceof Node||t.nodeType?t.cloneNode(!0):"length"in t?[].map.call(this._toArray(t),function(t){return t.cloneNode(!0)}):void 0},_slice:function(t){return t&&0!==t.length?t.length?[].slice.call(t.nodes||t):[t]:[]},_eachClass:function(t,e){return this.each(function(i){if(t){t.split(" ").forEach(function(t){i.classList&&i.classList[e](t)})}})},_triggerEvent:function(t){var e=this.get();return e&&3!==e.nodeType&&e[t](),this},_getOneHandler:function(t,e){var i=this;return function(){t.apply(this,arguments),i.off(e)}},_getEventNamespace:function(t){var e=t.split("."),i=e[1]?e[1]:"_events";return e[2]?i+e[2]:i},_getEventName:function(t){return t.split(".")[0]},_offEvent:function(t,e,i,s,n){for(var o in t._e)for(var r in t._e[o])if(n(r,o,e,i))for(var a=t._e[o][r],l=0;l<a.length;l++)void 0!==s&&a[l].toString()!==s.toString()||(t.removeEventListener(r,a[l]),t._e[o][r].splice(l,1),0===t._e[o][r].length&&delete t._e[o][r],0===Object.keys(t._e[o]).length&&delete t._e[o])},_getInnerOrOuter:function(t,e){return this[t](void 0,e)},_getDocSize:function(t,e){var i=t.body,s=t.documentElement;return Math.max(i["scroll"+e],i["offset"+e],s["client"+e],s["scroll"+e],s["offset"+e])},_getSize:function(t,e,i,s){if(void 0===i){var n=this.get();return i=3===n.nodeType?0:9===n.nodeType?this._getDocSize(n,e):n===window?window["inner"+e]:this._getHeightOrWidth(t,n,s||"normal"),Math.round(i)}return this.each(function(e){i=parseFloat(i),i+=this._adjustResultHeightOrWidth(t,e,s||"normal"),new Dom(e).css(t,i+"px")}.bind(this))},_getHeightOrWidth:function(t,e,i){if(!e)return 0;var s=t.charAt(0).toUpperCase()+t.slice(1),n=0,o=getComputedStyle(e,null),r=new Dom(e),a=r.parents().filter(function(t){return 1===t.nodeType&&"none"===getComputedStyle(t,null).display&&t});if("none"===o.display&&a.add(e),0!==a.length){var l="visibility: hidden !important; display: block !important;",h=[];a.each(function(t){var e=new Dom(t),i=e.attr("style");null!==i&&h.push(i),e.attr("style",null!==i?i+";"+l:l)}),n=r.get()["offset"+s]-this._adjustResultHeightOrWidth(t,e,i),a.each(function(t,e){var i=new Dom(t);void 0===h[e]?i.removeAttr("style"):i.attr("style",h[e])})}else n=e["offset"+s]-this._adjustResultHeightOrWidth(t,e,i);return n},_adjustResultHeightOrWidth:function(t,e,i){if(!e||!1===i)return 0;var s=0,n=getComputedStyle(e,null),o="border-box"===n.boxSizing;return"height"===t?(("inner"===i||"normal"===i&&o)&&(s+=(parseFloat(n.borderTopWidth)||0)+(parseFloat(n.borderBottomWidth)||0)),"outer"===i&&(s-=(parseFloat(n.marginTop)||0)+(parseFloat(n.marginBottom)||0))):(("inner"===i||"normal"===i&&o)&&(s+=(parseFloat(n.borderLeftWidth)||0)+(parseFloat(n.borderRightWidth)||0)),"outer"===i&&(s-=(parseFloat(n.marginLeft)||0)+(parseFloat(n.marginRight)||0))),s},_getDim:function(t){var e=this.get();return 3===e.nodeType?{top:0,left:0}:this["_get"+t](e)},_getPosition:function(t){return{top:t.offsetTop,left:t.offsetLeft}},_getOffset:function(t){var e=t.getBoundingClientRect(),i=t.ownerDocument,s=i.documentElement,n=i.defaultView;return{top:e.top+n.pageYOffset-s.clientTop,left:e.left+n.pageXOffset-s.clientLeft}},_getSibling:function(t,e){var i,s=(t=t&&t.dom?t.get():t)&&t.nodeType;return this.each(function(n){for(;n=n[e];)if(s&&n===t||new Dom(n).is(t))return void(i=n)}),new Dom(i)},_toArray:function(t){if(t instanceof NodeList){for(var e=[],i=0;i<t.length;i++)e[i]=t[i];return e}return void 0===t?[]:t.dom?t.nodes:t},_toParams:function(t){var e="";for(var i in t)e+="&"+this._encodeUri(i)+"="+this._encodeUri(t[i]);return e.replace(/^&/,"")},_toObject:function(t){return new Function("return "+t)()},_encodeUri:function(t){return encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},_isNumber:function(t){return!isNaN(t)&&!isNaN(parseFloat(t))},_isObjectString:function(t){return-1!==t.search(/^{/)},_getBooleanFromStr:function(t){return"true"===t||"false"!==t&&t},_hasDisplayNone:function(t){return"none"===t.style.display||"none"===(t.currentStyle?t.currentStyle.display:getComputedStyle(t,null).display)}};var uuid=0,$R=function(t,e){return RedactorApp(t,e,[].slice.call(arguments,2))};$R.app=[],$R.version="3.2.2",$R.options={},$R.modules={},$R.services={},$R.classes={},$R.plugins={},$R.mixins={},$R.modals={},$R.lang={},$R.dom=function(t,e){return new Dom(t,e)},$R.ajax=Ajax,$R.Dom=Dom,$R.keycodes={BACKSPACE:8,DELETE:46,UP:38,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37},$R.env={plugin:"plugins",module:"modules",service:"services",class:"classes",mixin:"mixins"},"undefined"!=typeof jQuery&&(jQuery.fn.redactor=function(t){return RedactorApp(this.toArray(),t,[].slice.call(arguments,1))});var RedactorApp=function(t,e,i){for(var s,n="redactor",o=Array.isArray(t)?t:t&&t.nodeType?[t]:document.querySelectorAll(t),r="string"==typeof e||"function"==typeof e,a=[],l=0;l<o.length;l++){var h=o[l],c=$R.dom(h);if((s=c.dataget(n))||r||(s=new App(h,e,uuid),c.dataset(n,s),$R.app[uuid]=s,uuid++),s&&r){var d,u="destroy"===e;"function"==typeof(e=u?"stop":e)?d=e.apply(s,i):(i.unshift(e),d=s.api.apply(s,i)),void 0!==d&&a.push(d),u&&c.dataset(n,!1)}}return 0===a.length||1===a.length?0===a.length?s:a[0]:a};$R.add=function(t,e,i){if(void 0!==$R.env[t])if(i.translations&&($R.lang=$R.extend(!0,{},$R.lang,i.translations)),i.modals&&($R.modals=$R.extend(!0,{},$R.modals,i.modals)),"mixin"===t)$R[$R.env[t]][e]=i;else{var s=function(){};if(s.prototype=i,i.mixins)for(var n=0;n<i.mixins.length;n++)$R.inherit(s,$R.mixins[i.mixins[n]]);$R[$R.env[t]][e]=s}},$R.addLang=function(t,e){void 0===$R.lang[t]&&($R.lang[t]={}),$R.lang[t]=$R.extend($R.lang[t],e)},$R.create=function(t){var e=t.split("."),i=[].slice.call(arguments,1),s="classes";void 0!==$R.env[e[0]]&&(s=$R.env[e[0]],t=e.slice(1).join("."));var n=new $R[s][t];if(n.init){var o=n.init.apply(n,i);return o||n}return n},$R.inherit=function(t,e){var i=function(){};i.prototype=e;var s=new i;for(var n in t.prototype)t.prototype.__lookupGetter__(n)?s.__defineGetter__(n,t.prototype.__lookupGetter__(n)):s[n]=t.prototype[n];return t.prototype=s,t.prototype.super=e,t},$R.error=function(t){throw t},$R.extend=function(){var t={},e=!1,i=0,s=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],i++);for(var n=function(i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e&&"[object Object]"===Object.prototype.toString.call(i[s])?t[s]=$R.extend(!0,t[s],i[s]):t[s]=i[s])};i<s;i++){n(arguments[i])}return t},$R.opts={animation:!0,lang:"en",direction:"ltr",spellcheck:!0,structure:!1,scrollTarget:!1,styles:!0,stylesClass:"redactor-styles",placeholder:!1,source:!0,showSource:!1,inline:!1,breakline:!1,markup:"p",enterKey:!0,clickToEdit:!1,clickToSave:!1,clickToCancel:!1,focus:!1,focusEnd:!1,minHeight:!1,maxHeight:!1,maxWidth:!1,plugins:[],callbacks:{},preClass:!1,preSpaces:4,tabindex:!1,tabAsSpaces:!1,tabKey:!0,autosave:!1,autosaveName:!1,autosaveData:!1,toolbar:!0,toolbarFixed:!0,toolbarFixedTarget:document,toolbarFixedTopOffset:0,toolbarExternal:!1,toolbarContext:!0,air:!1,formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,formattingHide:!1,buttons:["html","format","bold","italic","deleted","lists","image","file","link"],buttonsTextLabeled:!1,buttonsAdd:[],buttonsAddFirst:[],buttonsAddAfter:!1,buttonsAddBefore:!1,buttonsHide:[],buttonsHideOnMobile:[],imageUpload:!1,imageUploadParam:"file",imageData:!1,imageEditable:!0,imageCaption:!0,imageLink:!0,imagePosition:!1,imageResizable:!1,imageFloatMargin:"10px",imageFigure:!0,fileUpload:!1,fileUploadParam:"file",fileData:!1,fileAttachment:!1,uploadData:!1,dragUpload:!0,multipleUpload:!0,clipboardUpload:!0,uploadBase64:!1,linkTarget:!1,linkTitle:!1,linkNewTab:!1,linkNofollow:!1,linkSize:30,linkValidation:!0,cleanOnEnter:!0,cleanInlineOnEnter:!1,paragraphize:!0,removeScript:!0,removeNewLines:!1,removeComments:!0,replaceTags:{b:"strong",i:"em",strike:"del"},pastePlainText:!1,pasteLinkTarget:!1,pasteImages:!0,pasteLinks:!0,pasteClean:!0,pasteKeepStyle:[],pasteKeepClass:[],pasteKeepAttrs:["td","th"],pasteBlockTags:["pre","h1","h2","h3","h4","h5","h6","table","tbody","thead","tfoot","th","tr","td","ul","ol","li","blockquote","p","figure","figcaption"],pasteInlineTags:["a","img","br","strong","ins","code","del","span","samp","kbd","sup","sub","mark","var","cite","small","b","u","em","i","abbr"],activeButtons:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",u:"underline"},activeButtonsAdd:{},activeButtonsObservers:{},autoparse:!0,autoparseStart:!0,autoparsePaste:!0,autoparseLinks:!0,autoparseImages:!0,autoparseVideo:!0,shortcodes:{"p.":{format:"p"},"quote.":{format:"blockquote"},"pre.":{format:"pre"},"h1.":{format:"h1"},"h2.":{format:"h2"},"h3.":{format:"h3"},"h4.":{format:"h4"},"h5.":{format:"h5"},"h6.":{format:"h6"},"*.":{format:"ul"}},shortcodesAdd:!1,shortcuts:{"ctrl+shift+m, meta+shift+m":{api:"module.inline.clearformat"},"ctrl+b, meta+b":{api:"module.inline.format",args:"b"},"ctrl+i, meta+i":{api:"module.inline.format",args:"i"},"ctrl+u, meta+u":{api:"module.inline.format",args:"u"},"ctrl+h, meta+h":{api:"module.inline.format",args:"sup"},"ctrl+l, meta+l":{api:"module.inline.format",args:"sub"},"ctrl+k, meta+k":{api:"module.link.open"},"ctrl+alt+0, meta+alt+0":{api:"module.block.format",args:"p"},"ctrl+alt+1, meta+alt+1":{api:"module.block.format",args:"h1"},"ctrl+alt+2, meta+alt+2":{api:"module.block.format",args:"h2"},"ctrl+alt+3, meta+alt+3":{api:"module.block.format",args:"h3"},"ctrl+alt+4, meta+alt+4":{api:"module.block.format",args:"h4"},"ctrl+alt+5, meta+alt+5":{api:"module.block.format",args:"h5"},"ctrl+alt+6, meta+alt+6":{api:"module.block.format",args:"h6"},"ctrl+shift+7, meta+shift+7":{api:"module.list.toggle",args:"ol"},"ctrl+shift+8, meta+shift+8":{api:"module.list.toggle",args:"ul"}},shortcutsAdd:!1,grammarly:!0,notranslate:!1,bufferLimit:100,emptyHtml:"<p></p>",markerChar:"\ufeff",imageTypes:["image/png","image/jpeg","image/gif"],inlineTags:["a","span","strong","strike","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small","abbr"],blockTags:["pre","ul","ol","li","p","h1","h2","h3","h4","h5","h6","dl","dt","dd","div","table","tbody","thead","tfoot","tr","th","td","blockquote","output","figcaption","figure","address","section","header","footer","aside","article","iframe"],regex:{youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/(http|https)?:\/\/(?:www.|player.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_-]+)?/gi,imageurl:/((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/gi,url:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi},input:!0,zindex:!1,modes:{inline:{pastePlainText:!0,pasteImages:!1,enterKey:!1,toolbar:!1,autoparse:!1,source:!1,showSource:!1,styles:!1,air:!1},original:{styles:!1}}},$R.lang.en={format:"Format",image:"Image",file:"File",link:"Link",bold:"Bold",italic:"Italic",deleted:"Strikethrough",underline:"Underline",superscript:"Superscript",subscript:"Subscript","bold-abbr":"B","italic-abbr":"I","deleted-abbr":"S","underline-abbr":"U","superscript-abbr":"Sup","subscript-abbr":"Sub",lists:"Lists","link-insert":"Insert Link","link-edit":"Edit Link","link-in-new-tab":"Open link in new tab",unlink:"Unlink",cancel:"Cancel",close:"Close",insert:"Insert",save:"Save",delete:"Delete",text:"Text",edit:"Edit",title:"Alt",paragraph:"Normal text",quote:"Quote",code:"Code",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",filename:"Name",optional:"optional",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",horizontalrule:"Line",upload:"Upload","upload-label":"Drop files here or click to upload","accessibility-help-label":"Rich text editor",caption:"Caption",bulletslist:"Bullets",numberslist:"Numbers","image-position":"Position",none:"None",left:"Left",right:"Right",center:"Center",undo:"Undo",redo:"Redo"},$R.buttons={html:{title:"HTML",icon:!0,api:"module.source.toggle"},undo:{title:"## undo ##",icon:!0,api:"module.buffer.undo"},redo:{title:"## redo ##",icon:!0,api:"module.buffer.redo"},format:{title:"## format ##",icon:!0,dropdown:{p:{title:"## paragraph ##",api:"module.block.format",args:{tag:"p"}},blockquote:{title:"## quote ##",api:"module.block.format",args:{tag:"blockquote"}},pre:{title:"## code ##",api:"module.block.format",args:{tag:"pre"}},h1:{title:"## heading1 ##",api:"module.block.format",args:{tag:"h1"}},h2:{title:"## heading2 ##",api:"module.block.format",args:{tag:"h2"}},h3:{title:"## heading3 ##",api:"module.block.format",args:{tag:"h3"}},h4:{title:"## heading4 ##",api:"module.block.format",args:{tag:"h4"}},h5:{title:"## heading5 ##",api:"module.block.format",args:{tag:"h5"}},h6:{title:"## heading6 ##",api:"module.block.format",args:{tag:"h6"}}}},bold:{title:"## bold-abbr ##",icon:!0,tooltip:"## bold ##",api:"module.inline.format",args:{tag:"b"}},italic:{title:"## italic-abbr ##",icon:!0,tooltip:"## italic ##",api:"module.inline.format",args:{tag:"i"}},deleted:{title:"## deleted-abbr ##",icon:!0,tooltip:"## deleted ##",api:"module.inline.format",args:{tag:"del"}},underline:{title:"## underline-abbr ##",icon:!0,tooltip:"## underline ##",api:"module.inline.format",args:{tag:"u"}},sup:{title:"## superscript-abbr ##",icon:!0,tooltip:"## superscript ##",api:"module.inline.format",args:{tag:"sup"}},sub:{title:"## subscript-abbr ##",icon:!0,tooltip:"## subscript ##",api:"module.inline.format",args:{tag:"sub"}},lists:{title:"## lists ##",icon:!0,observe:"list",dropdown:{observe:"list",unorderedlist:{title:"&bull; ## unorderedlist ##",api:"module.list.toggle",args:"ul"},orderedlist:{title:"1. ## orderedlist ##",api:"module.list.toggle",args:"ol"},outdent:{title:"< ## outdent ##",api:"module.list.outdent"},indent:{title:"> ## indent ##",api:"module.list.indent"}}},ul:{title:"&bull; ## bulletslist ##",icon:!0,api:"module.list.toggle",observe:"list",args:"ul"},ol:{title:"1. ## numberslist ##",icon:!0,api:"module.list.toggle",observe:"list",args:"ol"},outdent:{title:"## outdent ##",icon:!0,api:"module.list.outdent",observe:"list"},indent:{title:"## indent ##",icon:!0,api:"module.list.indent",observe:"list"},image:{title:"## image ##",icon:!0,api:"module.image.open"},file:{title:"## file ##",icon:!0,api:"module.file.open"},link:{title:"## link ##",icon:!0,observe:"link",dropdown:{observe:"link",link:{title:"## link-insert ##",api:"module.link.open"},unlink:{title:"## unlink ##",api:"module.link.unlink"}}},line:{title:"## horizontalrule ##",icon:!0,api:"module.line.insert"}};var App=function(t,e,i){this.module={},this.plugin={},this.instances={},this.started=!1,this.stopped=!1,this.uuid=i,this.rootElement=t,this.rootOpts=e,this.dragInside=!1,this.dragComponentInside=!1,this.keycodes=$R.keycodes,this.namespace="redactor",this.$win=$R.dom(window),this.$doc=$R.dom(document),this.$body=$R.dom("body"),this.editorReadOnly=!1,this.opts=$R.create("service.options",e,t),this.lang=$R.create("service.lang",this),this.buildServices(),this.buildModules(),this.buildPlugins(),this.start()};App.prototype={start:function(){this.stopped=!1,this.broadcast("start"),this.broadcast("startcode"),this.opts.clickToEdit?this.broadcast("startclicktoedit"):(this.broadcast("enable"),this.opts.showSource&&this.broadcast("startcodeshow"),this.broadcast("enablefocus")),this.broadcast("started"),this.started=!0},stop:function(){this.started=!1,this.stopped=!0,this.broadcast("stop"),this.broadcast("disable"),this.broadcast("stopped")},isStarted:function(){return this.started},isStopped:function(){return this.stopped},buildServices:function(){var t=["options","lang"],e=["uuid","keycodes","opts","lang","$win","$doc","$body"],i=[];for(var s in $R.services)-1===t.indexOf(s)&&(this[s]=$R.create("service."+s,this),i.push(s),e.push(s));for(var n=0;n<i.length;n++)for(var o=i[n],r=0;r<e.length;r++){var a=e[r];o!==a&&(this[o][a]=this[a])}},buildModules:function(){for(var t in $R.modules)this.module[t]=$R.create("module."+t,this),this.instances[t]=this.module[t]},buildPlugins:function(){for(var t=this.opts.plugins,e=0;e<t.length;e++){var i=t[e];void 0!==$R.plugins[i]&&(this.plugin[i]=$R.create("plugin."+i,this),this.instances[i]=this.plugin[i])}},isDragInside:function(){return this.dragInside},setDragInside:function(t){this.dragInside=t},isDragComponentInside:function(){return this.dragComponentInside},setDragComponentInside:function(t){this.dragComponentInside=t},getDragComponentInside:function(){return this.dragComponentInside},isReadOnly:function(){return this.editorReadOnly},enableReadOnly:function(){this.editorReadOnly=!0,this.broadcast("enablereadonly"),this.component.clearActive(),this.toolbar.disableButtons()},disableReadOnly:function(){this.editorReadOnly=!1,this.broadcast("disablereadonly"),this.toolbar.enableButtons()},callMessageHandler:function(t,e,i){var s=e.split(".");if(1===s.length)"function"==typeof t["on"+e]&&t["on"+e].apply(t,i);else{s[0]="on"+s[0];var n=this.utils.checkProperty(t,s);"function"==typeof n&&n.apply(t,i)}},broadcast:function(t){var e=[].slice.call(arguments,1);for(var i in this.instances)this.callMessageHandler(this.instances[i],t,e);return this.callback.trigger(t,e)},on:function(t,e){this.callback.add(t,e)},off:function(t,e){this.callback.remove(t,e)},api:function(t){if((this.isStarted()||"start"===t)&&(!this.isReadOnly()||"disableReadOnly"===t)){this.broadcast("state");var e=[].slice.call(arguments,1),i=t.split("."),s=1===i.length,n="on"===i[0]||"off"===i[0],o=!n&&2===i.length,r="plugin"===i[0],a="module"===i[0];if(s){if("function"==typeof this[i[0]])return this.callInstanceMethod(this,i[0],e)}else{if(n)return"on"===i[0]?this.on(i[1],e[0]):this.off(i[1],e[0]||void 0);if(o){if(this.isInstanceExists(this,i[0]))return this.callInstanceMethod(this[i[0]],i[1],e);$R.error(new Error('Service "'+i[0]+'" not found'))}else if(r){if(this.isInstanceExists(this.plugin,i[1]))return this.callInstanceMethod(this.plugin[i[1]],i[2],e);$R.error(new Error('Plugin "'+i[1]+'" not found'))}else if(a){if(this.isInstanceExists(this.module,i[1]))return this.callInstanceMethod(this.module[i[1]],i[2],e);$R.error(new Error('Module "'+i[1]+'" not found'))}}}},isInstanceExists:function(t,e){return void 0!==t[e]},callInstanceMethod:function(t,e,i){if("function"==typeof t[e])return t[e].apply(t,i)}},$R.add("mixin","formatter",{buildArgs:function(t){this.args={class:t.class||!1,style:t.style||!1,attr:t.attr||!1},this.args.class||this.args.style||this.args.attr||(this.args=!1)},applyArgs:function(t,e){return t=this.args?this[this.type](this.args,!1,t,e):this._clearAll(t,e)},clearClass:function(t,e){this.selection.save();var i=e?$R.dom(e):this.getElements(t,!0);return i.removeAttr("class"),e=this._unwrapSpanWithoutAttr(i.getAll()),this.selection.restore(),e},clearStyle:function(t,e){this.selection.save();var i=e?$R.dom(e):this.getElements(t,!0);return i.removeAttr("style"),e=this._unwrapSpanWithoutAttr(i.getAll()),this.selection.restore(),e},clearAttr:function(t,e){this.selection.save();var i=e?$R.dom(e):this.getElements(t,!0);return this._removeAllAttr(i),e=this._unwrapSpanWithoutAttr(i.getAll()),this.selection.restore(),e},set:function(t,e,i,s){!1!==s&&this.selection.save();var n=i?$R.dom(i):this.getElements(e);return t.class&&(n.removeAttr("class"),n.addClass(t.class)),t.style&&(n.removeAttr("style"),n.css(t.style),n.each(function(t){var e=$R.dom(t);e.attr("data-redactor-style-cache",e.attr("style"))})),t.attr&&(this._removeAllAttr(n),n.attr(t.attr)),!1!==s&&this.selection.restore(),n.getAll()},toggle:function(t,e,i,s){!1!==s&&this.selection.save();var n,o=i?$R.dom(i):this.getElements(e);return t.class&&(o.toggleClass(t.class),o.each(function(t){""===t.className&&t.removeAttribute("class")})),t.style&&(n=t.style,o.each(function(t){var e=$R.dom(t);for(var i in n){var s=n[i],o=e.css(i);o=this.utils.isRgb(o)?this.utils.rgb2hex(o):o.replace(/"/g,""),s=this.utils.isRgb(s)?this.utils.rgb2hex(s):s.replace(/"/g,""),o=this.utils.hex2long(o),("string"==typeof(s=this.utils.hex2long(s))?s.toLowerCase():s)===("string"==typeof o?o.toLowerCase():o)?e.css(i,""):e.css(i,s)}this._convertStyleQuotes(e),this.utils.removeEmptyAttr(t,"style")?e.removeAttr("data-redactor-style-cache"):e.attr("data-redactor-style-cache",e.attr("style"))}.bind(this))),t.attr&&(n=t.attr,o.each(function(t){var e=$R.dom(t);for(var i in n)e.attr(i)?e.removeAttr(i):e.attr(i,n[i])})),!1!==s&&this.selection.restore(),o.getAll()},add:function(t,e,i,s){!1!==s&&this.selection.save();var n=i?$R.dom(i):this.getElements(e);if(t.class&&n.addClass(t.class),t.style){var o=t.style;n.each(function(t){var e=$R.dom(t);e.css(o),e.attr("data-redactor-style-cache",e.attr("style")),this._convertStyleQuotes(e)}.bind(this))}return t.attr&&n.attr(t.attr),!1!==s&&this.selection.restore(),n.getAll()},remove:function(t,e,i,s){!1!==s&&this.selection.save();var n=i?$R.dom(i):this.getElements(e);if(t.class&&(n.removeClass(t.class),n.each(function(t){""===t.className&&t.removeAttribute("class")})),t.style){var o=t.style;n.each(function(t){var e=$R.dom(t);e.css(o,""),this.utils.removeEmptyAttr(t,"style")?e.removeAttr("data-redactor-style-cache"):e.attr("data-redactor-style-cache",e.attr("style"))}.bind(this))}return t.attr&&n.removeAttr(t.attr),i=this._unwrapSpanWithoutAttr(n.getAll()),!1!==s&&this.selection.restore(),i},_removeAllAttr:function(t){t.each(function(t){for(var e=t.attributes.length;e-- >0;){var i=t.attributes[e],s=i.name;"style"!==s&&"class"!==s&&t.removeAttributeNode(i)}})},_convertStyleQuotes:function(t){var e=t.attr("style");e&&t.attr("style",e.replace(/"/g,"'"))},_clearAll:function(t,e){!1!==e&&this.selection.save();for(var i=0;i<t.length;i++)for(var s=t[i];s.attributes.length>0;)s.removeAttribute(s.attributes[0].name);return t=this._unwrapSpanWithoutAttr(t),!1!==e&&this.selection.restore(),t},_unwrapSpanWithoutAttr:function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i];s.attributes.length<=0&&3!==s.nodeType&&"SPAN"===s.tagName?$R.dom(s).unwrap():e.push(s)}return e}}),$R.add("mixin","dom",$R.Dom.prototype),$R.add("mixin","component",{get cmnt(){return!0}}),$R.add("service","options",{init:function(t,e){var i=$R.dom(e),s=$R.extend({},$R.opts,e?i.data():{},$R.options);return s=$R.extend(!0,s,t)}}),$R.add("service","lang",{init:function(t){this.app=t,this.opts=t.opts,this.vars=this._build(this.opts.lang)},rebuild:function(t){this.opts.lang=t,this.vars=this._build(t)},extend:function(t){this.vars=$R.extend(this.vars,t)},parse:function(t){if(void 0===t)return"";var e=t.match(/## (.*?) ##/g);if(e)for(var i=0;i<e.length;i++){var s=e[i].replace(/^##\s/g,"").replace(/\s##$/g,"");t=t.replace(e[i],this.get(s))}return t},get:function(t){var e="";return void 0!==this.vars[t]?e=this.vars[t]:"en"!==this.opts.lang&&void 0!==$R.lang.en[t]&&(e=$R.lang.en[t]),e},_build:function(t){var e=$R.lang.en;return"en"!==t&&(e=void 0!==$R.lang[t]?$R.lang[t]:e),e}}),$R.add("service","callback",{init:function(t){this.app=t,this.opts=t.opts,this.callbacks={},this.opts.callbacks&&this._set(this.opts.callbacks,"")},stop:function(){this.callbacks={}},add:function(t,e){this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e)},remove:function(t,e){if(void 0===e)delete this.callbacks[t];else{for(var i=0;i<this.callbacks[t].length;i++)this.callbacks[t].splice(i,1);0===Object.keys(this.callbacks[t]).length&&delete this.callbacks[t]}},trigger:function(t,e){var i=this._loop(t,e,this.callbacks);return void 0===i&&e&&!1!==e[0]?e[0]:i},_set:function(t,e){for(var i in t){var s=""===e?i:e+"."+i;"object"==typeof t[i]?this._set(t[i],s):(this.callbacks[s]=[],this.callbacks[s].push(t[i]))}},_loop:function(t,e,i){var s;for(var n in i)if(t===n)for(var o=0;o<i[n].length;o++)s=i[n][o].apply(this.app,e);return s}}),$R.add("service","animate",{init:function(t){this.animationOpt=t.opts.animation},start:function(t,e,i,s){var n={duration:!1,iterate:!1,delay:!1,timing:!1,prefix:"redactor-"};return n="function"==typeof i?n:$R.extend(n,i),s="function"==typeof i?i:s,new $R.AnimatePlay(t,e,n,s,this.animationOpt)},stop:function(t){this.$el=$R.dom(t),this.$el.removeClass("redactor-animated");var e=this.$el.attr("redactor-animate-effect");this.$el.removeClass(e),this.$el.removeAttr("redactor-animate-effect");var i=this.$el.attr("redactor-animate-hide");i&&this.$el.addClass(i).removeAttr("redactor-animate-hide"),this.$el.off("animationend webkitAnimationEnd")}}),$R.AnimatePlay=function(t,e,i,s,n){return this.hidableEffects=["fadeOut","flipOut","slideUp","zoomOut","slideOutUp","slideOutRight","slideOutLeft"],this.prefixes=["","-webkit-"],this.$el=$R.dom(t),this.$body=$R.dom("body"),this.callback=s,this.animation=n?e:this.buildAnimationOff(e),this.defaults=i,"slideUp"===this.animation&&this.$el.height(this.$el.height()),this.isInanimate()?this.inanimate():this.animate()},$R.AnimatePlay.prototype={buildAnimationOff:function(t){return this.isHidable(t)?"hide":"show"},buildHideClass:function(){return"redactor-animate-hide"},isInanimate:function(){return"show"===this.animation||"hide"===this.animation},isAnimated:function(){return this.$el.hasClass("redactor-animated")},isHidable:function(t){return-1!==this.hidableEffects.indexOf(t)},inanimate:function(){var t;return this.defaults.timing="linear","show"===this.animation?(t=this.buildHideClass(),this.$el.attr("redactor-animate-hide",t),this.$el.removeClass(t)):(t=this.$el.attr("redactor-animate-hide"),this.$el.addClass(t).removeAttr("redactor-animate-hide")),"function"==typeof this.callback&&this.callback(this),this},animate:function(){var t=this.defaults.delay?this.defaults.delay:0;return setTimeout(function(){if(this.$body.addClass("no-scroll-x"),this.$el.addClass("redactor-animated"),!this.$el.attr("redactor-animate-hide")){var t=this.buildHideClass();this.$el.attr("redactor-animate-hide",t),this.$el.removeClass(t)}this.$el.addClass(this.defaults.prefix+this.animation),this.$el.attr("redactor-animate-effect",this.defaults.prefix+this.animation),this.set(this.defaults.duration+"s",this.defaults.iterate,this.defaults.timing),this.complete()}.bind(this),1e3*t),this},set:function(t,e,i){for(var s=this.prefixes.length;s--;)!1===t&&""!==t||this.$el.css(this.prefixes[s]+"animation-duration",t),!1===e&&""!==e||this.$el.css(this.prefixes[s]+"animation-iteration-count",e),!1===i&&""!==i||this.$el.css(this.prefixes[s]+"animation-timing-function",i)},clean:function(){this.$body.removeClass("no-scroll-x"),this.$el.removeClass("redactor-animated"),this.$el.removeClass(this.defaults.prefix+this.animation),this.$el.removeAttr("redactor-animate-effect"),this.set("","","")},complete:function(){this.$el.one("animationend webkitAnimationEnd",function(){if(this.$el.hasClass(this.defaults.prefix+this.animation)&&this.clean(),this.isHidable(this.animation)){var t=this.$el.attr("redactor-animate-hide");this.$el.addClass(t).removeAttr("redactor-animate-hide")}"slideUp"===this.animation&&this.$el.height(""),"function"==typeof this.callback&&this.callback(this.$el)}.bind(this))}},$R.add("service","caret",{init:function(t){this.app=t},setStart:function(t){this._setCaret("Start",t)},setEnd:function(t){this._setCaret("End",t)},setBefore:function(t){this._setCaret("Before",t)},setAfter:function(t){this._setCaret("After",t)},isStart:function(t){return this._isStartOrEnd(t,"First")},isEnd:function(t){return this._isStartOrEnd(t,"Last")},setAtEnd:function(t){var e=this.inspector.parse(t).getTag(),i=document.createRange();if(this._isInPage(t)){if("a"===e){var s=this.utils.createInvisibleChar();$R.dom(t).after(s),i.selectNodeContents(s),i.collapse(!0)}else i.selectNodeContents(t),i.collapse(!1);this.selection.setRange(i)}},setAtStart:function(t){var e=document.createRange(),i=this.inspector.parse(t);if(this._isInPage(t)){if(e.setStart(t,0),e.collapse(!0),i.isInline()||this.utils.isEmpty(t)){var s=this.utils.createInvisibleChar();e.insertNode(s),e.selectNodeContents(s),e.collapse(!1)}this.selection.setRange(e)}},setAtBefore:function(t){var e=this.inspector.parse(t),i=document.createRange();if(this._isInPage(t)){if(i.setStartBefore(t),i.collapse(!0),e.isInline()){var s=this.utils.createInvisibleChar();t.parentNode.insertBefore(s,t),i.selectNodeContents(s),i.collapse(!1)}this.selection.setRange(i)}},setAtAfter:function(t){var e=document.createRange();if(this._isInPage(t)){e.setStartAfter(t),e.collapse(!0);var i=this.utils.createInvisibleChar();e.insertNode(i),e.selectNodeContents(i),e.collapse(!1),this.selection.setRange(e)}},setAtPrev:function(t){var e=t.previousSibling;e&&(e=3===e.nodeType&&this._isEmptyTextNode(e)?e.previousElementSibling:e)&&this.setEnd(e)},setAtNext:function(t){var e=t.nextSibling;e&&(e=3===e.nodeType&&this._isEmptyTextNode(e)?e.nextElementSibling:e)&&this.setStart(e)},_setCaret:function(t,e){var i=this.inspector.parse(e),s=i.getNode();s&&(this.component.clearActive(),this["_set"+t](s,i,i.getTag()))},_setStart:function(t,e,i){if(e.isText())return this.editor.focus(),this.setAtStart(t);if("ul"===i||"ol"===i){t=e.findFirstNode("li");var s=this.utils.getFirstElement(t),n=this.inspector.parse(s);if(s&&n.isComponent())return this.setStart(n.getComponent())}else if("dl"===i)t=e.findFirstNode("dt");else{if("br"===i||"hr"===i)return this.setBefore(t);if("td"===i||"th"===i){var o=e.getFirstElement(t);if(o)return this.setStart(o)}else{if("table"===i||"tr"===i)return this.setStart(e.findFirstNode("th, td"));if(e.isComponentType("code")&&!e.isFigcaption()){var r=e.findLastNode("pre, code");return this.editor.focus(),this.setAtStart(r)}if("figure"===i&&e.isComponentType("table")){var a=e.getTable(),l=this.inspector.parse(a);return this.setStart(l.findFirstNode("th, td"))}if(!e.isComponentType("table")&&e.isComponent()&&!e.isFigcaption())return this.component.setActive(t)}}this.editor.focus(),this._setInline(t,"Start")||this.setAtStart(t)},_setEnd:function(t,e,i){if(e.isText())return this.editor.focus(),this.setAtEnd(t);if("ul"===i||"ol"===i){t=e.findLastNode("li");var s=this.utils.getLastElement(t),n=this.inspector.parse(s);if(s&&n.isComponent())return this.setEnd(n.getComponent())}else if("dl"===i)t=e.findLastNode("dd");else{if("br"===i||"hr"===i)return this.setAfter(t);if("td"===i||"th"===i){var o=e.getLastElement();if(o)return this.setEnd(o)}else{if("table"===i||"tr"===i)return this.setEnd(e.findLastNode("th, td"));if(e.isComponentType("code")&&!e.isFigcaption()){var r=e.findLastNode("pre, code");return this.editor.focus(),this.setAtEnd(r)}if("figure"===i&&e.isComponentType("table")){var a=e.getTable(),l=this.inspector.parse(a);return this.setEnd(l.findLastNode("th, td"))}if(!e.isComponentType("table")&&e.isComponent()&&!e.isFigcaption())return this.component.setActive(t)}}if(this.editor.focus(),!this._setInline(t,"End")){if(this.utils.isEmpty(t))return this.setStart(t);this.setAtEnd(t)}},_setBefore:function(t,e,i){return 3===t.nodeType?this.setAtBefore(t):e.isInline()?this.setAtBefore(t):e.isFirstTableCell()?this.setAtPrev(e.getComponent()):"td"===i||"th"===i?this.setAtPrev(t):e.isFirstListItem()?this.setAtPrev(e.getList()):e.isFigcaption()?this.setStart(e.getComponent()):!e.isComponentType("table")&&e.isComponent()?this.setAtPrev(e.getComponent()):e.isBlock()?this.setAtPrev(t):(this.editor.focus(),void this.setAtBefore(t))},_setAfter:function(t,e,i){return 3===t.nodeType?this.setAtAfter(t):e.isInline()?this.setAtAfter(t):e.isLastTableCell()?this.setAtNext(e.getComponent()):"td"===i||"th"===i?this.setAtNext(t):e.isFirstListItem()?this.setAtNext(e.getList()):!e.isComponentType("table")&&e.isComponent()?this.setAtNext(e.getComponent()):e.isBlock()?this.setAtNext(t):(this.editor.focus(),void this.setAtAfter(t))},_setInline:function(t,e){var i=this._hasInlineChild(t,"Start"===e?"first":"last");if(i)return"Start"===e?this.setStart(i):this.setEnd(i),!0},_isStartOrEnd:function(t,e){var i=this.utils.getNode(t);if(!i)return!1;var s=this.inspector.parse(i);if((i=this._getStartEndNode(i,s,e))&&3!==i.nodeType&&"LI"!==i.tagName){var n=3===i.nodeType?i.textContent:i.innerHTML;if(""===(n=this.utils.trimSpaces(n)))return!0}if(!s.isFigcaption()&&s.isComponent()&&!s.isComponentEditable())return!0;var o=this.offset.get(i,!0);return!!o&&("First"===e?0===o.start:o.end===this.offset.size(i,!0))},_isInPage:function(t){return!(!t||!t.nodeType)&&(t!==document.body&&document.body.contains(t))},_hasInlineChild:function(t,e){var i=this.inspector.parse(t),s="first"===e?i.getFirstNode():i.getLastNode(),n=$R.dom(s);if(s&&3!==s.nodeType&&this.inspector.isInlineTag(s.tagName)&&!n.hasClass("redactor-component")&&!n.hasClass("non-editable"))return s},_isEmptyTextNode:function(t){var e=t.textContent.trim().replace(/\n/,"");return""===(e=this.utils.removeInvisibleChars(e))},_getStartEndNode:function(t,e,i){return e.isFigcaption()?t=e.getFigcaption():e.isTable()?t=e["find"+i+"Node"]("th, td"):e.isList()?t=e["find"+i+"Node"]("li"):e.isComponentType("code")&&(t=e.findLastNode("pre, code")),t}}),$R.add("service","selection",{init:function(t){this.app=t},is:function(){var t=this.get();if(t){var e=t.anchorNode,i=this.inspector.parse(e);return i.isInEditor()||i.isEditor()}return!1},isCollapsed:function(){var t=this.get(),e=this.getRange();return!(!t||!t.isCollapsed)||!(!e||0!==e.toString().length)},isBackwards:function(){var t=!1,e=this.get();if(e&&!e.isCollapsed){var i=document.createRange();i.setStart(e.anchorNode,e.anchorOffset),i.setEnd(e.focusNode,e.focusOffset),t=i.collapsed,i.detach()}return t},isIn:function(t){var e=$R.dom(t).get(),i=this.getCurrent();return!(!i||!e)&&e.contains(i)},isText:function(){var t=this.get();if(t){var e=t.anchorNode,i=this.getBlock(e),s=this.getBlocks();if(i&&this.inspector.isTableCellTag(i.tagName)||!1===i&&0===s.length)return!0}return!1},isAll:function(t){var e=this.utils.getNode(t);if(!e)return!1;var i=this.editor.isEditor(e),s=this.inspector.parse(e);if(!s.isFigcaption()&&this.component.isNonEditable(e)&&this.component.isActive(e))return!0;if(i){var n=this.editor.getElement().html().replace(/<p><\/p>$/i,"");if(this.getHtml(!1).length!==n.length)return!1}if(i&&this.editor.isEmpty()||this.isCollapsed())return!1;var o=this.offset.get(e,!0),r=this.offset.size(e,!0);return!i&&s.isComponentType("code")&&(r=this.getText().trim().length),!(!o||0!==o.start||o.end!==r)},hasNonEditable:function(){var t=this.getHtml(),e=$R.dom("<div>").html(t);return!this.isCollapsed()&&0!==e.find(".non-editable").length},setRange:function(t){var e=window.getSelection();e.removeAllRanges(),e.addRange(t)},setAll:function(t){var e=this.utils.getNode(t);if(e){var i=this.inspector.parse(e);if(this.component.clearActive(),this.editor.focus(),this.editor.saveScroll(),this.editor.disableNonEditables(),e&&"TABLE"===e.tagName){var s=i.findFirstNode("td, th"),n=i.findLastNode("td, th");$R.dom(s).prepend(this.marker.build("start")),$R.dom(n).append(this.marker.build("end")),this.restoreMarkers()}else if(!i.isFigcaption()&&this.component.isNonEditable(e))this.component.setActive(e);else{i.isComponentType("code")&&(e=i.getComponentCodeElement()).focus();var o=document.createRange();o.selectNodeContents(e),this.setRange(o)}this.editor.enableNonEditables(),this.editor.restoreScroll()}},get:function(){var t=window.getSelection();return t.rangeCount>0?t:null},getRange:function(){var t=this.get();return t&&t.getRangeAt(0)?t.getRangeAt(0):null},getTextBeforeCaret:function(t){t=void 0===t?1:t;var e=this.editor.getElement().get(),i=this.getRange(),s=!1;return i&&((i=i.cloneRange()).collapse(!0),i.setStart(e,0),s=i.toString().slice(-t)),s},getTextAfterCaret:function(t){t=void 0===t?1:t;var e=this.editor.getElement().get(),i=this.getRange(),s=!1;if(i){var n=i.cloneRange();n.selectNodeContents(e),n.setStart(i.endContainer,i.endOffset),s=n.toString().slice(0,t)}return s},getPosition:function(){var t=this.getRange(),e={top:0,left:0,width:0,height:0};if(window.getSelection&&t.getBoundingClientRect){var i=(t=t.cloneRange()).startOffset-1;t.setStart(t.startContainer,i<0?0:i);var s=t.getBoundingClientRect();e={top:s.top,left:s.left,width:s.right-s.left,height:s.bottom-s.top}}return e},getCurrent:function(){var t=!1,e=this.get(),i=this.component.getActive();if(i)t=i;else if(e&&this.is()){t=!this.inspector.parse(e.anchorNode).isEditor()&&e.anchorNode}return t},getParent:function(){var t=!1,e=this.getCurrent();if(e){var i=e.parentNode;t=!this.inspector.parse(i).isEditor()&&i}return t},getElement:function(t){for(var e=t||this.getCurrent();e;){var i=this.inspector.parse(e);if(i.isElement()&&i.isInEditor())return e;e=e.parentNode}return!1},getInline:function(t){for(var e=t||this.getCurrent(),i=!1;e;)this._isInlineNode(e)&&(i=e),e=e.parentNode;return i},getInlineFirst:function(t){for(var e=t||this.getCurrent();e;){if(this._isInlineNode(e))return e;e=e.parentNode}return!1},getInlineAll:function(t){for(var e=t||this.getCurrent(),i=[];e;)this._isInlineNode(e)&&i.push(e),e=e.parentNode;return i},getBlock:function(t){for(var e=t||this.getCurrent();e;){var i=this.inspector.parse(e);if(this.inspector.isBlockTag(e.tagName)&&i.isInEditor(e))return e;e=e.parentNode}return!1},getInlinesAllSelected:function(t){if(this.isAll())return[];var e=this.getInlines({all:!0}),i=this.getNodes({textnodes:!0,inline:!1}),s=this.getText().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n=[];if(0!==i.length)return n;if(""===s)n=e;else if(e.length>1)for(var o=0;o<e.length;o++)this._isTextSelected(e[o],s)&&n.push(e[o]);else 1===e.length&&this._isTextSelected(e[0],s)&&(n=e);return n=t&&t.tags?this._filterNodesByTags(n,t.tags):n},getInlines:function(t){for(var e=this.getNodes(),i=[],s=0;s<e.length;s++){var n;if(t&&t.all)for(n=e[s];n;)this._isInlineNode(n)&&!this._isInNodesArray(i,n)&&i.push(n),n=n.parentNode;else(n=this.getInline(e[s]))&&!this._isInNodesArray(i,n)&&i.push(n)}return i=t&&t.tags?this._filterNodesByTags(i,t.tags):i,i=t&&t.inside?this._filterInlinesInside(i,t):i},getBlocks:function(t){var e=this.getNodes(),i=this.getBlock();e=0===e.length&&i?[i]:e;for(var s=[],n=0;n<e.length;n++){var o=this.getBlock(e[n]);$R.dom(o).hasClass("non-editable")||o&&!this._isInNodesArray(s,o)&&s.push(o)}return s=t&&t.tags?this._filterNodesByTags(s,t.tags):s,s=t&&t.first?this._filterBlocksFirst(s,t):s},getElements:function(t){var e=this.getNodes({textnodes:!1}),i=this.getBlock();e=0===e.length&&i?[i]:e;for(var s=[],n=0;n<e.length;n++)this._isInNodesArray(s,e[n])||s.push(e[n]);return s=t&&t.tags?this._filterNodesByTags(s,t.tags):s},getNodes:function(t){var e=[],i=this.component.getActive();if(i)e=this._getNodesComponent(i);else if(this.isCollapsed()){var s=this.getCurrent();e=s?[s]:[]}else this.is()&&!i&&(e=this._getRangeSelectedNodes());return e=this._filterServicesNodes(e),e=this._filterEditor(e),e=t&&t.tags?this._filterNodesByTags(e,t.tags):e,e=t&&t.textnodes?this._filterNodesTexts(e,t):e,e=t&&!t.textnodes?this._filterNodesElements(e):e},getText:function(){var t=this.get();return t?this.utils.removeInvisibleChars(t.toString()):""},getHtml:function(t){var e="",i=this.get();if(i){for(var s=document.createElement("div"),n=i.rangeCount,o=0;o<n;++o)s.appendChild(i.getRangeAt(o).cloneContents());e=s.innerHTML,e=(e=!1!==t?this.cleaner.output(e):e).replace(/<p><\/p>$/i,"")}return e},clear:function(){this.component.clearActive(),this.get().removeAllRanges()},collapseToStart:function(){var t=this.get();t&&!t.isCollapsed&&t.collapseToStart()},collapseToEnd:function(){var t=this.get();t&&!t.isCollapsed&&t.collapseToEnd()},saveActiveComponent:function(){var t=this.component.getActive();return!!t&&(this.savedComponent=t,!0)},restoreActiveComponent:function(){return!!this.savedComponent&&(this.component.setActive(this.savedComponent),!0)},save:function(){this._clearSaved();var t=this.getElement();!t||-1===["TD","TH","P","DIV","PRE","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE"].indexOf(t.tagName)||""!==t.innerHTML&&"<br>"!==t.innerHTML?this.saveActiveComponent()||(this.saved=this.offset.get()):this.savedElement=t},restore:function(){(this.saved||this.savedComponent||this.savedElement)&&(this.editor.saveScroll(),this.savedElement?this.caret.setStart(this.savedElement):this.restoreActiveComponent()||this.offset.set(this.saved),this._clearSaved(),this.editor.restoreScroll())},saveMarkers:function(){this._clearSaved(),this.saveActiveComponent()||this.marker.insert()},restoreMarkers:function(){this.editor.saveScroll(),this.restoreActiveComponent()||this.marker.restore(),this._clearSaved(),this.editor.restoreScroll()},_getNextNode:function(t){if(t.hasChildNodes())return t.firstChild;for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null},_getNodesComponent:function(t){var e=this.getCurrent(),i=this.inspector.parse(e);return i.isFigcaption()?[i.getFigcaption()]:[t]},_getRangeSelectedNodes:function(){var t=[],e=this.getRange(),i=e.startContainer,s=e.startContainer,n=e.endContainer,o=this.editor.getElement();if(s===o.get()&&this.isAll())t=this.utils.getChildNodes(o);else if(i==n)t=[i];else{for(;i&&i!=n;)t.push(i=this._getNextNode(i));for(i=e.startContainer;i&&i!=e.commonAncestorContainer;)t.unshift(i),i=i.parentNode}return t},_isInNodesArray:function(t,e){return-1!==t.indexOf(e)},_filterEditor:function(t){for(var e=[],i=0;i<t.length;i++){this.inspector.parse(t[i]).isInEditor()&&e.push(t[i])}return e},_filterServicesNodes:function(t){for(var e=[],i=0;i<t.length;i++){var s=$R.dom(t[i]),n=!1;t[i]&&3===t[i].nodeType&&this.utils.isEmpty(t[i])&&(n=!0),(s.hasClass("redactor-script-tag")||s.hasClass("redactor-component-caret")||s.hasClass("redactor-selection-marker")||s.hasClass("non-editable"))&&(n=!0),n||e.push(t[i])}return e},_filterNodesTexts:function(t,e){for(var i=[],s=0;s<t.length;s++){if(3===t[s].nodeType||e.keepbr&&"BR"===t[s].tagName)this.getInline(t[s])&&e&&!1===e.inline||i.push(t[s])}return i},_filterNodesElements:function(t){for(var e=[],i=0;i<t.length;i++)3!==t[i].nodeType&&e.push(t[i]);return e},_filterNodesByTags:function(t,e,i){for(var s=[],n=0;n<t.length;n++)if(i&&3===t[n].nodeType)s.push(t[n]);else if(3!==t[n].nodeType){var o=t[n].tagName.toLowerCase();-1!==e.indexOf(o.toLowerCase())&&s.push(t[n])}return s},_filterBlocksFirst:function(t){for(var e=[],i=0;i<t.length;i++){var s=$R.dom(t[i]),n=s.parent().get(),o=s.parent().hasClass("redactor-in"),r=n&&("TD"===n.tagName||"TH"===n.tagName);(o||r)&&e.push(t[i])}return e},_filterInlinesInside:function(t){for(var e=[],i=0;i<t.length;i++)window.getSelection().containsNode(t[i],!0)&&e.push(t[i]);return e},_isTextSelected:function(t,e){var i=this.utils.removeInvisibleChars(t.textContent);return e===i||-1!==i.search(e)||-1!==e.search(new RegExp("^"+this.utils.escapeRegExp(i)))||-1!==e.search(new RegExp(this.utils.escapeRegExp(i)+"$"))},_isInlineNode:function(t){var e=this.inspector.parse(t);return this.inspector.isInlineTag(t.tagName)&&e.isInEditor()},_clearSaved:function(){this.saved=!1,this.savedComponent=!1,this.savedElement=!1}}),$R.add("service","element",{init:function(t){this.app=t,this.rootElement=t.rootElement,this.$element={},this.type="inline"},start:function(){this._build(),this._buildType()},isType:function(t){return t===this.type},getType:function(){return this.type},getElement:function(){return this.$element},_build:function(){this.$element=$R.dom(this.rootElement)},_buildType:function(){var t=this.$element.get().tagName;this.type="TEXTAREA"===t?"textarea":this.type,this.type="DIV"===t?"div":this.type,this.type=this.opts.inline?"inline":this.type}}),$R.add("service","editor",{init:function(t){this.app=t,this.scrolltop=!1,this.pasting=!1},start:function(){this._build()},focus:function(){this.isFocus()||this._isContenteditableFocus()||(this.saveScroll(),this.$editor.focus(),this.restoreScroll())},startFocus:function(){this.caret.setStart(this.getFirstNode())},endFocus:function(){this.caret.setEnd(this.getLastNode())},isPasting:function(){return this.pasting},enablePasting:function(){this.pasting=!0},disablePasting:function(){this.pasting=!1},saveScroll:function(){this.scrolltop=this._getScrollTarget().scrollTop()},restoreScroll:function(){!1!==this.scrolltop&&(this._getScrollTarget().scrollTop(this.scrolltop),this.scrolltop=!1)},disableNonEditables:function(){this.$noneditables=this.$editor.find("[contenteditable=false]"),this.$noneditables.attr("contenteditable",!0)},enableNonEditables:function(){this.$noneditables&&setTimeout(function(){this.$noneditables.attr("contenteditable",!1)}.bind(this),1)},getFirstNode:function(){return this.$editor.contents()[0]},getLastNode:function(){var t=this.$editor.contents();return t[t.length-1]},isSourceMode:function(){return this.source.getElement().hasClass("redactor-source-open")},isEditor:function(t){return $R.dom(t).get()===this.$editor.get()},isEmpty:function(t){return this.utils.isEmptyHtml(this.$editor.html(),!1,t)},isFocus:function(){var t=$R.dom(document.activeElement);return 0!==this.$editor.find(".redactor-component-active").length||0!==t.closest(".redactor-in-"+this.uuid).length},setEmpty:function(){this.$editor.html(this.opts.emptyHtml)},getElement:function(){return this.$editor},_build:function(){var t=this.element.getElement(),e=this.element.isType("textarea")?"<div>":t.get();this.$editor=$R.dom(e)},_getScrollTarget:function(){var t=this.$doc;return t=this.opts.toolbarFixedTarget!==document?$R.dom(this.opts.toolbarFixedTarget):this.opts.scrollTarget?$R.dom(this.opts.scrollTarget):t},_isContenteditableFocus:function(){var t=this.selection.getBlock();return 0!==(t?$R.dom(t).closest("[contenteditable=true]").not(".redactor-in"):[]).length}}),$R.add("service","container",{init:function(t){this.app=t},start:function(){this._build()},getElement:function(){return this.$container},_build:function(){var t=this.element.isType("inline")?"<span>":"<div>";this.$container=$R.dom(t)}}),$R.add("service","source",{init:function(t){this.app=t,this.$source={},this.content=""},start:function(){this._build(),this._buildName(),this._buildStartedContent()},getElement:function(){return this.$source},getCode:function(){return this.$source.val()},getName:function(){return this.$source.attr("name")},getStartedContent:function(){return this.content},setCode:function(t){return this.insertion.set(t,!0,!1)},isNameGenerated:function(){return this.name},rebuildStartedContent:function(){this._buildStartedContent()},_build:function(){var t=this.element.getElement(),e=this.element.isType("textarea")?t.get():"<textarea>";this.$source=$R.dom(e)},_buildName:function(){var t=this.element.getElement();this.name=t.attr("name"),this.$source.attr("name",this.name?this.name:"content-"+this.uuid)},_buildStartedContent:function(){var t=this.element.getElement(),e=this.element.isType("textarea")?t.val():t.html();this.content=e.trim()}}),$R.add("service","statusbar",{init:function(t){this.app=t,this.$statusbar={},this.items=[]},start:function(){this.$statusbar=$R.dom("<ul>"),this.$statusbar.attr("dir",this.opts.direction)},add:function(t,e){return this.update(t,e)},update:function(t,e){var i;return void 0!==this.items[t]?i=this.items[t]:(i=$R.dom("<li>"),this.$statusbar.append(i),this.items[t]=i),i.html(e)},get:function(t){return!!this.items[t]&&this.items[t]},remove:function(t){this.items[t]&&(this.items[t].remove(),delete this.items[t])},getItems:function(){return this.items},removeItems:function(){this.items={},this.$statusbar.html("")},getElement:function(){return this.$statusbar}}),$R.add("service","toolbar",{init:function(t){this.app=t,this.buttons=[],this.dropdownOpened=!1,this.buttonsObservers={}},start:function(){this.is()&&(this.opts.activeButtons=this.opts.activeButtonsAdd?this._extendActiveButtons():this.opts.activeButtons,this.create())},stopObservers:function(){this.buttonsObservers={}},create:function(){this.$wrapper=$R.dom("<div>"),this.$toolbar=$R.dom("<div>")},observe:function(){if(this.is()){var t,e;for(var i in this.setButtonsInactive(),this.buttonsObservers)e=this.buttonsObservers[i],t=this.getButton(i),this.app.broadcast("button."+e+".observe",t);var s=this.opts.activeButtons,n=this.selection.getInlinesAllSelected(),o=this.selection.getInline();this.selection.isCollapsed()&&o&&n.push(o);var r=this._inlinesToTags(n);for(var a in s)-1!==r.indexOf(a)&&(t=this.getButton(s[a]))&&t.setActive()}},is:function(){return!(!this.opts.toolbar||this.detector.isMobile()&&this.opts.air)},isAir:function(){return!!this.is()&&this.$toolbar.hasClass("redactor-air")},isFixed:function(){return!!this.is()&&this.$toolbar.hasClass("redactor-toolbar-fixed")},isContextBar:function(){return this.$body.find("#redactor-context-toolbar-"+this.uuid).hasClass("open")},isTarget:function(){return this.opts.toolbarFixedTarget!==document},getElement:function(){return this.$toolbar},getWrapper:function(){return this.$wrapper},getDropdown:function(){return this.dropdownOpened},getTargetElement:function(){return $R.dom(this.opts.toolbarFixedTarget)},getButton:function(t){var e=this._findButton(".re-"+t);return 0!==e.length&&e.dataget("data-button-instance")},getButtons:function(){var t=[];return this._findButtons().each(function(e){var i=$R.dom(e);t.push(i.dataget("data-button-instance"))}),t},getButtonsKeys:function(){var t=[];return this._findButtons().each(function(e){var i=$R.dom(e);t.push(i.attr("data-re-name"))}),t},addButton:function(t,e,i,s,n){i=i||"end";var o=$R.create("toolbar.button",this.app,t,e);return e.observe&&(this.opts.activeButtonsObservers[t]={observe:e.observe,button:o}),this.is()&&("first"===i?this.$toolbar.prepend(o):"after"===i?s.after(o):"before"===i?s.before(o):this.$toolbar.append(o)),o},addButtonFirst:function(t,e){return this.addButton(t,e,"first")},addButtonAfter:function(t,e,i){var s=this.getButton(t);return s?this.addButton(e,i,"after",s):this.addButton(e,i)},addButtonBefore:function(t,e,i){var s=this.getButton(t);return s?this.addButton(e,i,"before",s):this.addButton(e,i)},addButtonObserver:function(t,e){this.buttonsObservers[t]=e},setButtons:function(t){this.buttons=t},setDropdown:function(t){this.dropdownOpened=t},setButtonsInactive:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].setInactive()},setButtonsActive:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].setActive()},disableButtons:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].disable()},enableButtons:function(){for(var t=this.getButtons(),e=0;e<t.length;e++)t[e].enable()},_findButton:function(t){return this.is()?this.$toolbar.find(t):$R.dom()},_findButtons:function(){return this.is()?this.$toolbar.find(".re-button"):$R.dom()},_extendActiveButtons:function(){return $R.extend({},this.opts.activeButtons,this.opts.activeButtonsAdd)},_inlinesToTags:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].tagName.toLowerCase());return e}}),$R.add("class","toolbar.button",{mixins:["dom"],init:function(t,e,i){this.app=t,this.opts=t.opts,this.lang=t.lang,this.$body=t.$body,this.toolbar=t.toolbar,this.detector=t.detector,this.obj=i,this.name=e,this.dropdown=!1,this.tooltip=!1,this._init()},isActive:function(){return this.hasClass("redactor-button-active")},isDisabled:function(){return this.hasClass("redactor-button-disabled")},hasIcon:function(){return this.obj.icon&&!this.opts.buttonsTextLabeled},setDropdown:function(t){this.obj.dropdown=t,this.obj.message=!1,this.dropdown=$R.create("toolbar.dropdown",this.app,this.name,this.obj.dropdown),this.attr("data-dropdown",!0)},setMessage:function(t,e){this.obj.message=t,this.obj.args=e,this.obj.dropdown=!1},setApi:function(t,e){this.obj.api=t,this.obj.args=e,this.obj.dropdown=!1},setTitle:function(t){this.obj.title=this.lang.parse(t),this.obj.tooltip=this.obj.title,this.attr({alt:this.obj.tooltip,"aria-label":this.obj.tooltip}),this.attr("data-re-icon")||this.html(this.obj.title)},setTooltip:function(t){this.obj.tooltip=this.lang.parse(t),this.attr({alt:this.obj.tooltip,"aria-label":this.obj.tooltip})},setIcon:function(t){this.opts.buttonsTextLabeled||(this.obj.icon=!0,this.$icon=$R.dom(t),this.html(""),this.append(this.$icon),this.attr("data-re-icon",!0),this.addClass("re-button-icon"),this.setTooltip(this.obj.title),this._buildTooltip())},setActive:function(){this.addClass("redactor-button-active")},setInactive:function(){this.removeClass("redactor-button-active")},hideTooltip:function(){this.$body.find(".re-button-tooltip").remove()},getDropdown:function(){return this.dropdown},disable:function(){this.addClass("redactor-button-disabled")},enable:function(){this.removeClass("redactor-button-disabled")},toggle:function(t){t&&t.preventDefault(),this.isDisabled()||(this.obj.dropdown?this.dropdown.toggle(t):this.obj.api?this.app.api(this.obj.api,this.obj.args,this.name):this.obj.message&&this.app.broadcast(this.obj.message,this.obj.args,this.name),this.hideTooltip())},_init:function(){this._parseTitle(),this._parseTooltip(),this._build(),this._buildCallback(),this._buildAttributes(),this._buildObserver(),this.hasIcon()?(this._buildIcon(),this._buildTooltip()):this.html(this.obj.title)},_parseTooltip:function(){this.obj.tooltip=this.obj.tooltip?this.lang.parse(this.obj.tooltip):this.obj.title},_parseTitle:function(){this.obj.title=this.lang.parse(this.obj.title)},_build:function(){this.parse("<a>"),this.addClass("re-button re-"+this.name),this.attr("data-re-name",this.name),this.dataset("data-button-instance",this),this.obj.dropdown&&this.setDropdown(this.obj.dropdown)},_buildCallback:function(){this.on("click",this.toggle.bind(this))},_buildAttributes:function(){var t={href:"#",alt:this.obj.tooltip,rel:this.name,role:"button","aria-label":this.obj.tooltip,tabindex:"-1"};this.attr(t)},_buildObserver:function(){void 0!==this.obj.observe&&this.toolbar.addButtonObserver(this.name,this.obj.observe)},_buildIcon:function(){var t=this.obj.icon,e=/(<([^>]+)>)/gi.test(t);this.$icon=e?$R.dom(t):$R.dom("<i>"),e||this.$icon.addClass("re-icon-"+this.name),this.append(this.$icon),this.attr("data-re-icon",!0),this.addClass("re-button-icon")},_buildTooltip:function(){this.detector.isDesktop()&&(this.tooltip=$R.create("toolbar.button.tooltip",this.app,this))}}),$R.add("class","toolbar.button.tooltip",{mixins:["dom"],init:function(t,e){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.$body=t.$body,this.toolbar=t.toolbar,this.$button=e,this.created=!1,this._init()},open:function(){if(!this.$button.hasClass("redactor-button-disabled")&&!this.$button.hasClass("redactor-button-active")){this.created=!0,this.parse("<span>"),this.addClass("re-button-tooltip re-button-tooltip-"+this.uuid),this.$body.append(this),this.html(this.$button.attr("alt"));var t=this.$button.offset(),e=this.$button.height(),i=this.$button.width();this.css({top:t.top+e+4+"px",left:t.left+i/2-this.width()/2+"px",position:"absolute"}),this.show()}},close:function(){this.created&&!this.$button.hasClass("redactor-button-disabled")&&(this.remove(),this.created=!1)},_init:function(){this.$button.on("mouseover",this.open.bind(this)),this.$button.on("mouseout",this.close.bind(this))}}),$R.add("class","toolbar.dropdown",{mixins:["dom"],init:function(t,e,i){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.$win=t.$win,this.$doc=t.$doc,this.$body=t.$body,this.animate=t.animate,this.toolbar=t.toolbar,this.name=e,this.started=!1,this.items="format"===e?$R.extend({},!0,i):i,this.$items=[]},toggle:function(t){this.started||this._build(),this.isOpened()&&this.isActive()?this.close(!1):this.open(t)},isOpened:function(){var t=this.$body.find(".redactor-dropdown-"+this.uuid+".open");return 0!==t.length&&t.attr("data-re-name")===this.name},isActive:function(){return 0!==this.$body.find("#redactor-dropdown-"+this.uuid+"-"+this.name+".open").length},getName:function(){return this.attr("data-re-name")},getItem:function(t){return this.$items[t]},getItemsByClass:function(t){var e=[];for(var i in this.$items)"object"==typeof this.$items[i]&&this.$items[i].hasClass(t)&&e.push(this.$items[i]);return e},open:function(t){this._closeAll(),this.$btn=this.toolbar.getButton(this.name),this.app.broadcast("dropdown.open",t,this,this.$btn),this.toolbar.setDropdown(this),this.show(),this.removeClass("redactor-animate-hide"),this.addClass("open"),this._observe(),this.$btn.hideTooltip(),this.$btn.setActive(),this.$doc.on("keyup.redactor.dropdown-"+this.uuid,this._handleKeyboard.bind(this)),this.$doc.on("click.redactor.dropdown-"+this.uuid,this.close.bind(this)),this.updatePosition(),this.app.broadcast("dropdown.opened",t,this,this.$btn)},close:function(t,e){if(t){var i=$R.dom(t.target);if(this._isButton(t)||i.hasClass("redactor-dropdown-not-close")||i.hasClass("redactor-dropdown-item-disabled"))return void t.preventDefault()}this.app.broadcast("dropdown.close",this,this.$btn),this.toolbar.setDropdown(!1),this.$btn.setInactive(),!1===e?this._close():this.animate.start(this,"fadeOut",this._close.bind(this))},updatePosition:function(){var t=this.toolbar.isFixed(),e=this.$btn.offset();e.top=t?this.$btn.position().top:e.top;var i=this.$btn.height(),s=this.$btn.width(),n=t?"fixed":"absolute",o=t?2+this.opts.toolbarFixedTopOffset:2,r=e.left+0,a=parseFloat(this.css("width")),l=r-(this.$win.width()<r+a?a-s:0);l=l<0?4:l,this.css({position:n,top:e.top+i+o+"px",left:l+"px"})},_build:function(){this.parse("<div>"),this.attr("dir",this.opts.direction),this.attr("id","redactor-dropdown-"+this.uuid+"-"+this.name),this.attr("data-re-name",this.name),this.addClass("redactor-dropdown redactor-dropdown-"+this.uuid+" redactor-dropdown-"+this.name),this.dataset("data-dropdown-instance",this),this.items.dom||"string"==typeof this.items?this._buildDom():this._buildItems(),this.$body.append(this),this.started=!0},_buildDom:function(){this.html("").append($R.dom(this.items))},_buildItems:function(){for(var t in this.items="format"===this.name?this._buildFormattingItems():this.items,this.items){var e=this.items[t];if("observe"===t)this.attr("data-observe",this.items[t]);else{var i=$R.create("toolbar.dropdown.item",this.app,t,e,this);this.$items[t]=i,this.append(i)}}},_buildFormattingItems:function(){for(var t in this.items)-1===this.opts.formatting.indexOf(t)&&delete this.items[t];if(this.opts.formattingHide)for(var t in this.items)-1!==this.opts.formattingHide.indexOf(t)&&delete this.items[t];if(this.opts.formattingAdd)for(var t in this.opts.formattingAdd)this.items[t]=this.opts.formattingAdd[t];return this.items},_handleKeyboard:function(t){27===t.which&&this.close()},_isButton:function(t){return $R.dom(t.target).closest(".re-button").get()===this.$btn.get()},_close:function(){this.$btn.setInactive(),this.$doc.off(".redactor.dropdown-"+this.uuid),this.removeClass("open"),this.addClass("redactor-animate-hide"),this.app.broadcast("dropdown.closed",this,this.$btn)},_closeAll:function(){this.$body.find(".redactor-dropdown-"+this.uuid+".open").each(function(t){$R.dom(t).dataget("data-dropdown-instance")._close()})},_observe:function(){var t=this.attr("data-observe");t&&this.app.broadcast("dropdown."+t+".observe",this)}}),$R.add("class","toolbar.dropdown.item",{mixins:["dom"],init:function(t,e,i,s){this.app=t,this.lang=t.lang,this.dropdown=s,this.name=e,this.obj=i,this._init()},setTitle:function(t){this.$span.html(t)},getTitle:function(){return this.$span.html()},enable:function(){this.removeClass("redactor-dropdown-item-disabled")},disable:function(){this.addClass("redactor-dropdown-item-disabled")},toggle:function(t){t&&t.preventDefault(),this.hasClass("redactor-dropdown-item-disabled")||(this.obj.message?this.app.broadcast(this.obj.message,this.obj.args,this.name):this.obj.api&&this.app.api(this.obj.api,this.obj.args,this.name))},_init:function(){this.parse("<a>"),this.attr("href","#"),this.addClass("redactor-dropdown-item-"+this.name),this.obj.classname&&this.addClass(this.obj.classname),this.attr("data-re-name",this.name),this.on("click",this.toggle.bind(this)),this.$span=$R.dom("<span>"),this.append(this.$span),this.setTitle(this.lang.parse(this.obj.title))}}),$R.add("service","cleaner",{init:function(t){this.app=t,this.opts=t.opts,this.storedComponents=[],this.storedImages=[],this.storedLinks=[],this.deniedTags=["font","html","head","link","title","body","meta","applet"],this.convertRules={},this.unconvertRules={},this.reComments=/<!--[\s\S]*?-->/g,this.reSpacedEmpty=/^(||\s||<br\s?\/?>||&nbsp;)$/i,this.reScriptTag=/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi},addConvertRules:function(t,e){this.convertRules[t]=e},addUnconvertRules:function(t,e){this.unconvertRules[t]=e},input:function(t,e,i){t=(t=(t=this.encodePreCode(t)).replace(/\$/g,"&#36;")).replace(/&amp;/g,"&"),t=$R.create("cleaner.figure",this.app).convert(t,this.convertRules),t=this.storeComponents(t),t=this.replaceTags(t,this.opts.replaceTags),t=this._setSpanAttr(t),t=this._setStyleCache(t),t=this.removeTags(t,this.deniedTags),t=this.opts.removeScript?this._removeScriptTag(t):this._replaceScriptTag(t),t=this.opts.removeComments?this.removeComments(t):t,t=this._isSpacedEmpty(t)?this.opts.emptyHtml:t,t=this.restoreComponents(t),t=this._cleanWrapped(t);var s=this.utils.buildWrapper(t),n=["alt","title","src","class","width","height","srcset","data-image"];return s.find("img").each(function(t){if(t.attributes.length>0)for(var e=t.attributes,i=e.length-1;i>=0;i--)-1===n.indexOf(e[i].name)&&t.removeAttribute(e[i].name)}),t=this.utils.getWrapperHtml(s),t=e?this.paragraphize(t):t},output:function(t,e){return t=(t=this.removeInvisibleSpaces(t)).replace(/&#36;/g,"$"),this._isSpacedEmpty(t)?"":this._isParagraphEmpty(t)?"":(t=this.removeServiceTagsAndAttrs(t,e),t=this.storeComponents(t),t=this.removeSpanWithoutAttributes(t),t=this.removeFirstBlockBreaklineInHtml(t),t=this.opts.removeScript?t:this._unreplaceScriptTag(t),t=this.opts.preClass?this._setPreClass(t):t,t=this.opts.linkNofollow?this._setLinkNofollow(t):t,t=this.opts.removeNewLines?this.cleanNewLines(t):t,t=this.restoreComponents(t),t=$R.create("cleaner.figure",this.app).unconvert(t,this.unconvertRules),t=this.removeEmptyAttributes(t,["style","class","rel","alt","title"]),t=this.cleanSpacesInPre(t),t=""===(t=(t=this.tidy(t)).replace(/&amp;/g,"&")).replace(/\n/g,"")?"":t)},paste:function(t){t=this.storeComponents(t);var e=this.deniedTags.concat(["iframe"]);t=(t=(t=(t=this.removeTags(t,e)).replace(new RegExp("<!doctype([\\s\\S]+?)>","gi"),"")).replace(new RegExp("<style([\\s\\S]+?)</style>","gi"),"")).replace(new RegExp("</p><br /><p","gi"),"</p><p");var i=this._isHtmlMsWord(t);if(t=this._cleanGDocs(t),t=i?this._cleanMsWord(t):t,!this.opts.pasteClean)return t=this.restoreComponents(t);if(this.opts.pastePlainText)return t=this.restoreComponents(t),this.pastePlainText(t);var s=this.opts.pasteBlockTags.concat(this.opts.pasteInlineTags);t=this.removeTagsExcept(t,s),t=this.opts.pasteLinks?t:this.removeTags(t,["a"]),t=this.opts.pasteImages?t:this.removeTags(t,["img"]);var n=this.utils.buildWrapper(t),o=n.find("*"),r=0!==this.opts.pasteKeepStyle.length?","+this.opts.pasteKeepStyle.join(","):"";o.not("[data-redactor-style-cache]"+r).removeAttr("style");var a=0!==this.opts.pasteKeepClass.length?","+this.opts.pasteKeepClass.join(","):"";o.not("[data-redactor-style-cache], span.redactor-component"+a).removeAttr("class");var l=0!==this.opts.pasteKeepAttrs.length?","+this.opts.pasteKeepAttrs.join(","):"";o.not("img, a, span.redactor-component, [data-redactor-style-cache]"+l).each(function(t){for(var e=t.attributes,i=e.length-1;i>=0;i--)"class"!==t.attributes[0].name&&t.removeAttribute(e[i].name)}),this.opts.pasteLinks&&!1!==this.opts.pasteLinkTarget&&n.find("a").attr("target",this.opts.pasteLinkTarget),n.find("[data-redactor-style-cache]").each(function(t){var e=t.getAttribute("data-redactor-style-cache");t.setAttribute("style",e)});var h=["alt","title","src","class","width","height","srcset"];return n.find("img").each(function(t){if(t.attributes.length>0)for(var e=t.attributes,i=e.length-1;i>=0;i--)-1===h.indexOf(e[i].name)&&t.removeAttribute(e[i].name)}),n.find("span").each(function(t){0===t.attributes.length&&$R.dom(t).unwrap()}),n.find(this.opts.inlineTags.join(",")).each(function(t){0===t.attributes.length&&this.utils.isEmptyHtml(t.innerHTML)&&$R.dom(t).unwrap()}.bind(this)),n.find("ul, ol").each(function(t){var e=t.previousSibling;if(e&&"LI"===e.tagName){var i=$R.dom(e);i.find("p").unwrap(),i.append(t)}}),t=(t=(t=(t=(t=this.utils.getWrapperHtml(n)).replace(/<li><p>/gi,"<li>")).replace(/<\/p><\/li>/gi,"</li>")).replace(/<p>&nbsp;<\/p>/gi,"<p></p>")).replace(/<p><br\s?\/?><\/p>/gi,"<p></p>"),i&&(t=(t=t.replace(/<p><\/p>/gi,"")).replace(/<p>\s<\/p>/gi,"")),t=this.restoreComponents(t)},pastePlainText:function(t){return t=this.opts.pasteLinks?this.storeLinks(t):t,t=this.opts.pasteImages?this.storeImages(t):t,t=this.getPlainText(t),t=this._replaceNlToBr(t),t=this.opts.pasteLinks?this.restoreLinks(t):t,t=this.opts.pasteImages?this.restoreImages(t):t},tidy:function(t){return t},paragraphize:function(t){return $R.create("cleaner.paragraphize",this.app).convert(t)},getFlatText:function(t){var e=$R.dom("<div>");return t.nodeType||t.dom?e.append(t):(t=(t=t.toString()).trim(),e.html(t)),void 0===(t=e.get().textContent||e.get().innerText||"")?"":t},getPlainText:function(t){t=(t=(t=(t=(t=(t=t.replace(/<!--[\s\S]*?-->/gi,"")).replace(/<style[\s\S]*?style>/gi,"")).replace(/<p><\/p>/g,"")).replace(/<\/div>|<\/li>|<\/td>/gi,"\n")).replace(/<\/p>/gi,"\n\n")).replace(/<\/H[1-6]>/gi,"\n\n");var e=document.createElement("div");return e.innerHTML=t,(t=e.textContent||e.innerText).trim()},replaceTags:function(t,e){if(e){var i=this,s=Object.keys(e),n=this.utils.buildWrapper(t);n.find(s.join(",")).each(function(t){i.utils.replaceToTag(t,e[t.tagName.toLowerCase()])}),t=this.utils.getWrapperHtml(n)}return t},replaceNbspToSpaces:function(t){return t.replace("&nbsp;"," ")},replaceBlocksToBr:function(t){return t=t.replace(/<\/div>|<\/li>|<\/td>|<\/p>|<\/H[1-6]>/gi,"<br>")},cleanNewLines:function(t){return t.replace(/\r?\n/g,"")},cleanSpacesInPre:function(t){return t.replace("&nbsp;&nbsp;&nbsp;&nbsp;","    ")},removeInvisibleSpaces:function(t){return t=(t=this.utils.removeInvisibleChars(t)).replace(/&#65279;/gi,"")},removeNl:function(t){return t=(t=t.replace(/\n/g," ")).replace(/\s+/g,"s")},removeBrAtEnd:function(t){return t=(t=t.replace(/<br\s?\/?>$/gi," ")).replace(/<br\s?\/?><li/gi,"<li")},removeTags:function(t,e){var i=e?/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi:/(<([^>]+)>)/gi,s=e?function(t,i){return-1===e.indexOf(i.toLowerCase())?t:""}:"";return t.replace(i,s)},removeTagsExcept:function(t,e){if(void 0===e)return t.replace(/(<([^>]+)>)/gi,"");return t.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,i){return-1===e.indexOf(i.toLowerCase())?"":t})},removeComments:function(t){return t.replace(this.reComments,"")},removeServiceTagsAndAttrs:function(t,e){var i=this.utils.buildWrapper(t),s=this;return!1!==e&&i.find(".redactor-selection-marker").each(function(t){var e=$R.dom(t);return""===s.utils.removeInvisibleChars(e.text())?e.remove():e.unwrap()}),i.find("[data-redactor-style-cache]").removeAttr("data-redactor-style-cache"),this.utils.getWrapperHtml(i)},removeSpanWithoutAttributes:function(t){var e=this.utils.buildWrapper(t);return e.find("span").removeAttr("data-redactor-span data-redactor-style-cache").each(function(t){0===t.attributes.length&&$R.dom(t).unwrap()}),this.utils.getWrapperHtml(e)},removeFirstBlockBreaklineInHtml:function(t){return t.replace(new RegExp("</li><br\\s?/?>","gi"),"</li>")},removeEmptyAttributes:function(t,e){for(var i=this.utils.buildWrapper(t),s=0;s<e.length;s++)i.find("["+e[s]+'=""]').removeAttr(e[s]);return this.utils.getWrapperHtml(i)},encodeHtml:function(t){return t=(t=(t=(t=(t=(t=t.replace(/<br\s?\/?>/g,"\n")).replace(/&nbsp;/g," ")).replace(/”/g,'"')).replace(/“/g,'"')).replace(/‘/g,"'")).replace(/’/g,"'"),t=(t=this.encodeEntities(t)).replace(/\$/g,"&#36;"),this.opts.preSpaces&&(t=t.replace(/\t/g,new Array(this.opts.preSpaces+1).join(" "))),t},encodePreCode:function(t){var e=t.match(new RegExp("<code(.*?)>(.*?)<pre(.*?)>(.*?)</pre>(.*?)</code>","gi"));if(null!==e)for(var i=0;i<e.length;i++){var s=e[i].match(new RegExp("<pre(.*?)>([\\w\\W]*?)</pre>","i"));t=t.replace(s[0],this.encodeEntities(s[0]))}var n=this.utils.buildWrapper(t);return n.find("code code").replaceWith(this._encodeOuter.bind(this)),n.find("code pre").replaceWith(this._encodeOuter.bind(this)),n.find("pre pre").replaceWith(this._encodeOuter.bind(this)),n.find("code, pre").each(this._encodePreCodeLine.bind(this)),t=this.utils.getWrapperHtml(n),t=this._decodeMarkers(t)},encodeEntities:function(t){return t=(t=this.decodeEntities(t)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},encodePhpCode:function(t){return t=(t=(t=t.replace("<?php","&lt;?php")).replace("<?","&lt;?")).replace("?>","?&gt;")},decodeEntities:function(t){return String(t).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},storeComponents:function(t){var e=this.utils.getElementsFromHtml(t,"figure","table");return this._storeMatched(t,e,"Components","figure")},restoreComponents:function(t){return this._restoreMatched(t,"Components","figure")},storeLinks:function(t){var e=this.utils.getElementsFromHtml(t,"a");return this._storeMatched(t,e,"Links","a")},storeImages:function(t){var e=this.utils.getElementsFromHtml(t,"img");return this._storeMatched(t,e,"Images","img")},restoreLinks:function(t){return this._restoreMatched(t,"Links","a")},restoreImages:function(t){return this._restoreMatched(t,"Images","img")},_cleanWrapped:function(t){return t=t.replace(new RegExp("<p><figure([\\w\\W]*?)</figure></p>","gi"),"<figure$1</figure>")},_cleanGDocs:function(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2")).replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3")).replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?bold|font-weight:\s?bold;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>")).replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?600|font-weight:\s?600;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>")).replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?700|font-weight:\s?700;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>")).replace(/<span[^>]*font-style:\s?italic[^>]*>([\w\W]*?)<\/span>/gi,"<i>$1</i>")).replace(/<span[^>]*font-weight:\s?bold[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")).replace(/<span[^>]*font-weight:\s?700[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")).replace(/<span[^>]*font-weight:\s?600[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")},_cleanMsWord:function(t){t=(t=(t=(t=(t=t.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/?)s>/gi,"<$1strike>")).replace(/&nbsp;/gi," ")).replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return e.length>0?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join(" "):""});var e=this.utils.buildWrapper(t);e.find("p").each(function(t){var e=$R.dom(t),i=e.attr("style"),s=/mso-list:\w+ \w+([0-9]+)/.exec(i);s&&e.data("_listLevel",parseInt(s[1],10))}),this._parseWordLists(e),e.find("[align]").removeAttr("align"),e.find("[name]").removeAttr("name"),e.find("span").each(function(t){var e=$R.dom(t),i=e.attr("style");/mso-list:Ignore/.exec(i)?e.remove():e.unwrap()}),e.find("[style]").removeAttr("style"),e.find("[class^='Mso']").removeAttr("class"),e.find("a").filter(function(t){return!t.hasAttribute("href")}).unwrap();for(var i="",s=(t=(t=(t=(t=(t=this.utils.getWrapperHtml(e)).replace(/<p[^>]*><\/p>/gi,"")).replace(/<li>·/gi,"<li>")).trim()).replace(/\/(p|ul|ol|h1|h2|h3|h4|h5|h6|blockquote)>\s+<(p|ul|ol|h1|h2|h3|h4|h5|h6|blockquote)/gi,"/$1>\n<$2")).split(/\n/),n=0;n<s.length;n++){var o=""!==s[n]&&-1===s[n].search(/>$/)?" ":"\n";i+=s[n]+o}return i},_parseWordLists:function(t){var e=0,i=null,s=!1,n=null;t.find("p").each(function(t){var o=$R.dom(t),r=o.data("_listLevel");if(null===r&&o.hasClass("MsoListParagraphCxSpMiddle")&&(r=1),null!==r){var a=o.text(),l=/^\s*\w+\./.test(a)?"<ol></ol>":"<ul></ul>";if(o.hasClass("MsoListParagraphCxSpFirst")&&(o.before(l),n=o.prev()),r>e&&0!==e){var h=$R.dom(l);i&&(i.append(h),n=h,s=!0)}o.find("span").first().unwrap(),i=$R.dom("<li>"+o.html().trim()+"</li>"),null===n&&(o.before(l),n=o.prev()),n.append(i),o.remove(),s&&(n=n.parent()),e=r,s=!1}else e=0})},_isSpacedEmpty:function(t){return-1!==t.search(this.reSpacedEmpty)},_isParagraphEmpty:function(t){return-1!==t.search(/^<p><\/p>$/i)},_isHtmlMsWord:function(t){return t.match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i)},_setSpanAttr:function(t){var e=this.utils.buildWrapper(t);return e.find("span").attr("data-redactor-span",!0),this.utils.getWrapperHtml(e)},_setStyleCache:function(t){var e=this.utils.buildWrapper(t);return e.find("[style]").each(function(t){var e=$R.dom(t);e.attr("data-redactor-style-cache",e.attr("style"))}),this.utils.getWrapperHtml(e)},_setPreClass:function(t){var e=this.utils.buildWrapper(t);return e.find("pre").addClass(this.opts.preClass),this.utils.getWrapperHtml(e)},_setLinkNofollow:function(t){var e=this.utils.buildWrapper(t);return e.find("a").attr("rel","nofollow"),this.utils.getWrapperHtml(e)},_replaceScriptTag:function(t){return t.replace(this.reScriptTag,'<script class="redactor-script-tag" $1>$2<\/script>')},_unreplaceScriptTag:function(t){return t.replace(/<script class="redactor-script-tag"(.*?[^>]?)>([\w\W]*?)<\/script>/gi,"<script$1>$2<\/script>")},_replaceNlToBr:function(t){return t.replace(/\n/g,"<br />")},_removeScriptTag:function(t){return t.replace(this.reScriptTag,"")},_storeMatched:function(t,e,i,s){if(this["stored"+i]=[],e)for(var n=0;n<e.length;n++)this["stored"+i][n]=e[n],t=t.replace(e[n],"####"+s+n+"####");return t},_restoreMatched:function(t,e,i){if(this["stored"+e])for(var s=0;s<this["stored"+e].length;s++)t=t.replace("####"+i+s+"####",this["stored"+e][s]);return t},_decodeMarkers:function(t){return t.replace(/&lt;span\sid="selection-marker-(start|end)"\sclass="redactor-selection-marker"&gt;(.*?[^>]?)&lt;\/span&gt;/g,'<span id="selection-marker-$1" class="redactor-selection-marker">​</span>')},_encodeOuter:function(t){return this.encodeEntities(t.outerHTML)},_encodePreCodeLine:function(t){var e=t.firstChild;if("PRE"!=t.tagName||!e||"CODE"!==e.tagName){var i=this.decodeEntities(t.innerHTML);i=i.replace(/&nbsp;/g," ").replace(/<br\s?\/?>/g,"\n"),i=this.opts.preSpaces?i.replace(/\t/g,new Array(this.opts.preSpaces+1).join(" ")):i,t.textContent=i}}}),$R.add("class","cleaner.figure",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.detector=t.detector},convert:function(t,e){var i=this.utils.buildWrapper(t);return i.find("img").each(this._convertImage.bind(this)),i.find("hr").each(this._convertLine.bind(this)),i.find("iframe").each(this._convertIframe.bind(this)),i.find("table").each(this._convertTable.bind(this)),i.find("form").each(this._convertForm.bind(this)),i.find("figure pre").each(this._convertCode.bind(this)),i.find("[data-redactor-type=variable]").addClass("redactor-component"),i.find("figure").not(".redactor-component, .redactor-figure-code").each(this._convertWidget.bind(this)),i.find("figure pre").each(this._setContenteditableCode.bind(this)),i.find(".redactor-component, .non-editable").attr("contenteditable",!1),this.detector.isIe()&&i.find("[data-redactor-type=table]").removeAttr("contenteditable"),i.find("figcaption, td, th").attr("contenteditable",!0),i.find(".redactor-component, figcaption").attr("tabindex","-1"),this._acceptExtraRules(i,e),this.utils.getWrapperHtml(i)},unconvert:function(t,e){var i=this.utils.buildWrapper(t);return i.find("th, td, figcaption, figure, pre, code, .redactor-component").removeAttr("contenteditable tabindex"),i.find("figure").removeClass("redactor-component redactor-component-active redactor-uploaded-figure"),i.find("[data-redactor-type=variable]").removeClass("redactor-component redactor-component-active"),i.find("figure[data-redactor-type=line]").unwrap(),i.find("figure[data-redactor-type=widget]").each(this._unconvertWidget.bind(this)),i.find("figure[data-redactor-type=form]").each(this._unconvertForm.bind(this)),i.find("figure[data-redactor-type=table]").each(this._unconvertTable.bind(this)),i.find("figure[data-redactor-type=image]").removeAttr("rel").each(this._unconvertImages.bind(this)),i.find("img").removeAttr("data-redactor-type").removeClass("redactor-component"),i.find(".non-editable").removeAttr("contenteditable"),i.find("figure").each(this._removeTypes.bind(this)),i.find("span.redactor-component-caret").remove(),this.opts.breakline&&i.find('[data-redactor-tag="br"]').each(function(t){t.lastChild&&"BR"!==t.lastChild.tagName&&t.appendChild(document.createElement("br"))}).unwrap(),this._acceptExtraRules(i,e),t=(t=this.utils.getWrapperHtml(i)).replace(/<br\s?\/?>$/,"")},_convertImage:function(t){var e=$R.dom(t);if(!this._isNonEditable(e)){e.attr("data-image")||e.attr("data-image",this.utils.getRandomId());var i=e.closest("a"),s=e.closest("figure");if(0===s.children().not("a, img, br, figcaption").length){if(0===s.length){var n=0!==i.length?i.closest("p"):e.closest("p");if(!1===this.opts.imageFigure&&0!==n.length)(s=this.utils.replaceToTag(n,"figure")).addClass("redactor-replace-figure");else 0!==n.length&&n.unwrap(),s=0!==i.length?i.wrap("<figure>"):e.wrap("<figure>")}else s.hasClass("redactor-uploaded-figure")?s.removeClass("redactor-uploaded-figure"):s.addClass("redactor-keep-figure");this._setFigure(s,"image")}}},_convertTable:function(t){if(!this._isNonEditable(t)){var e=this._wrapFigure(t);this._setFigure(e,"table")}},_convertLine:function(t){if(!this._isNonEditable(t)){var e=this._wrapFigure(t);this._setFigure(e,"line")}},_convertForm:function(t){if(!this._isNonEditable(t)){var e=this.utils.replaceToTag(t,"figure");this._setFigure(e,"form")}},_convertIframe:function(t){if(!this._isNonEditable(t)&&0===$R.dom(t).closest(".redactor-component").length){var e=t.getAttribute("src"),i=e&&(e.match(this.opts.regex.youtube)||e.match(this.opts.regex.vimeo)),s=this._wrapFigure(t);i&&this._setFigure(s,"video")}},_convertCode:function(t){if(!this._isNonEditable(t)){var e=this._wrapFigure(t);this._setFigure(e,"code")}},_convertWidget:function(t){if(!this._isNonEditable(t)){var e=$R.dom(t);e.addClass("redactor-component"),e.attr("data-redactor-type","widget"),e.attr("data-widget-code",encodeURI(t.innerHTML.trim()))}},_unconvertForm:function(t){this.utils.replaceToTag(t,"form")},_unconvertTable:function(t){$R.dom(t).unwrap()},_unconvertWidget:function(t){var e=$R.dom(t);e.html(decodeURI(e.attr("data-widget-code"))),e.removeAttr("data-widget-code")},_unconvertImages:function(t){var e=$R.dom(t);e.removeClass("redactor-component");var i=0!==e.closest("li").length,s=0!==e.closest("table").length,n=0!==e.find("figcaption").length,o=e.attr("style"),r=!(null===o||""===o),a=""!==e.attr("class");(i||s&&!n&&!r&&!a)&&e.unwrap()},_removeTypes:function(t){var e=$R.dom(t),i=e.attr("data-redactor-type");if(i&&-1!==["image","widget","line","video","code","form","table"].indexOf(i)&&e.removeAttr("data-redactor-type"),e.hasClass("redactor-keep-figure"))e.removeClass("redactor-keep-figure");else if("image"===i&&!1===this.opts.imageFigure){0!==e.find("figcaption").length||(e.hasClass("redactor-replace-figure")?(e.removeClass("redactor-replace-figure"),this.utils.replaceToTag(e,"p")):e.unwrap())}e.removeClass("redactor-replace-figure")},_wrapFigure:function(t){var e=$R.dom(t),i=e.closest("figure");return 0===i.length?e.wrap("<figure>"):i},_setFigure:function(t,e){t.addClass("redactor-component"),t.attr("data-redactor-type",e)},_setContenteditableCode:function(t){if(!this._isNonEditable(t)){var e=$R.dom(t),i=e.children("code").first();(0!==i.length?i:e).attr("contenteditable",!0).attr("tabindex","-1")}},_acceptExtraRules:function(t,e){for(var i in e)"function"==typeof e[i]&&e[i](t)},_isNonEditable:function(t){return 0!==$R.dom(t).closest(".non-editable").length}}),$R.add("class","cleaner.paragraphize",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.element=t.element,this.stored=[],this.remStart="#####replace",this.remEnd="#####",this.paragraphizeTags=["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"]},convert:function(t){var e=this._isConverted(t);return!0===e?this._convert(t):e},_convert:function(t){var e=this.opts.breakline?"sdivtag":this.opts.markup,i=[],s=(t=this._storeTags(t)).match(new RegExp("\x3c!--([\\w\\W]*?)--\x3e","gi"));if(null!==s)for(var n=0;n<s.length;n++)t=t.replace(s[n],"#####xstarthtmlcommentzz"+n+"xendhtmlcommentzz#####"),i.push(s[n]);t=t.trim(),t=this.opts.breakline?(t=(t=(t=(t=(t=t.replace(new RegExp("\\n#####","gi"),"xnonbreakmarkerz#####")).replace(new RegExp("#####\\n\\n","gi"),"#####\nxnonbreakmarkerz")).replace(new RegExp("#####\\n","gi"),"#####xnonbreakmarkerz")).replace(/<br\s?\/?>\n/gi,"<br>")).replace(/\n/g,"<br>")).replace(/xnonbreakmarkerz/gi,"\n"):t.replace(/[\n]+/g,"\n"),t=this._trimEmptyLines(t),t=(t=(t=this.opts.breakline?t:t.replace(/<br\s?\/?>\n/gi,"xbreakmarkerz\n")).replace(/(?:\r\n|\r|\n)/g,"xparagraphmarkerz")).replace(/xparagraphmarkerz/gi,"</"+e+">\n<"+e+">"),t=(t=(t="<"+e+">"+(t=this.opts.breakline?t:t.replace(/xbreakmarkerz/gi,"<br>"))+"</"+e+">").replace(new RegExp("<"+e+">#####","gi"),"#####")).replace(new RegExp("#####</"+e+">","gi"),"#####"),t=this._restoreTags(t);for(n=0;n<i.length;n++)t=t.replace("#####xstarthtmlcommentzz"+n+"xendhtmlcommentzz#####",i[n]);return t=(t=(t=this.opts.breakline?t:t.replace(new RegExp("<"+e+"><br\\s?/?></"+e+">","gi"),"<"+e+"></"+e+">")).replace(new RegExp("<sdivtag>","gi"),'<div data-redactor-tag="br">')).replace(new RegExp("sdivtag","gi"),"div")},_storeTags:function(t){var e=this,i=this.utils.buildWrapper(t);return this.opts.breakline&&i.find("p").each(function(t){var e=$R.dom(t);0===e.closest("figure[data-redactor-type=widget],figure[data-redactor-type=form],.non-editable").length&&(e.append("<br><br>"),e.unwrap())}),i.find(this.paragraphizeTags.join(", ")).each(function(t,i){var s=document.createTextNode("\n"+e.remStart+i+e.remEnd+"\n");e.stored.push(t.outerHTML),t.parentNode.replaceChild(s,t)}),this.utils.getWrapperHtml(i)},_restoreTags:function(t){for(var e=0;e<this.stored.length;e++)this.stored[e]=this.stored[e].replace(/\$/g,"&#36;"),t=t.replace(this.remStart+e+this.remEnd,this.stored[e]);return t},_trimEmptyLines:function(t){for(var e="",i=t.split("\n"),s=0;s<i.length;s++)""!==i[s].trim()&&(e+=i[s]+"\n");return e.replace(/\n$/,"")},_isConverted:function(t){return this._isDisabled(t)?t:!this._isEmptyHtml(t)||this.opts.emptyHtml},_isDisabled:function(){return!1===this.opts.paragraphize||this.element.isType("inline")},_isEmptyHtml:function(t){return""===t||"<p></p>"===t||"<div></div>"===t}}),$R.add("service","detector",{init:function(t){this.app=t,this.userAgent=navigator.userAgent.toLowerCase()},isWebkit:function(){return/webkit/.test(this.userAgent)},isFirefox:function(){return this.userAgent.indexOf("firefox")>-1},isIe:function(t){return document.documentMode||/Edge/.test(navigator.userAgent)?"edge":((e=RegExp("msie"+(isNaN(t)?"":"\\s"+t),"i").test(navigator.userAgent))||(e=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./)),e);var e},isMobile:function(){return/(iPhone|iPod|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|Android)/.test(navigator.userAgent)},isIpad:function(){return/iPad/.test(navigator.userAgent)}}),$R.add("service","offset",{init:function(t){this.app=t},get:function(t,e){var i={start:0,end:0},s=this.utils.getNode(t);if(!s)return!1;var n=this.editor.isEditor(s),o=!!n||this.selection.isIn(s),r=this.selection.getRange();if(n||o){if(this.selection.is()&&o){var a=$R.dom(r.startContainer).hasClass("redactor-component")?r.startOffset:0,l=r.cloneRange();l.selectNodeContents(s),l.setEnd(r.startContainer,r.startOffset);var h=this._getString(r,e);i.start=this._getString(l,e).length-a,i.end=i.start+h.length+a}}else i=!1;return i},set:function(t,e){if(!this._setComponentOffset(e)){this.component.clearActive();var i=this.utils.getNode(e);if(i){var s=this.size(i),n=0,o=document.createRange();t.end=t.end>s?s:t.end,o.setStart(i,0),o.collapse(!0);for(var r=[i],a=!1,l=!1;!l&&(i=r.pop());)if(3==i.nodeType){var h=n+i.length;!a&&!this._isFigcaptionNext(i)&&t.start>=n&&t.start<=h&&(o.setStart(i,t.start-n),a=!0),a&&t.end>=n&&t.end<=h&&(o.setEnd(i,t.end-n),l=!0),n=h}else for(var c=i.childNodes.length;c--;)r.push(i.childNodes[c]);this.selection.setRange(o)}}},size:function(t,e){var i=this.utils.getNode(t);if(i){var s=document.createRange().cloneRange();return s.selectNodeContents(i),this._getString(s,e).length}return 0},_getString:function(t,e){var i=t.toString();return i=this.editor.isEmpty()?i.replace(/\uFEFF/g,""):i,i=e?i.trim():i},_setComponentOffset:function(t){return!!this.component.isNonEditable(t)&&this.component.setActive(t)},_isFigcaptionNext:function(t){var e=t.nextSibling;return""===t.nodeValue.trim()&&e&&"FIGCAPTION"===e.tagName}}),$R.add("service","inspector",{init:function(t){this.app=t},parse:function(t){return $R.create("inspector.parser",this.app,this,t)},isText:function(t){if("string"==typeof t&&!/^\s*<(\w+|!)[^>]*>/.test(t))return!0;var e=$R.dom(t).get();return e&&3===e.nodeType},isInlineTag:function(t,e){var i=this._extendTags(this.opts.inlineTags,e);return this._isTag(t)&&-1!==i.indexOf(t.toLowerCase())},isBlockTag:function(t,e){var i=this._extendTags(this.opts.blockTags,e);return this._isTag(t)&&-1!==i.indexOf(t.toLowerCase())},isTableCellTag:function(t){return-1!==["td","th"].indexOf(t.toLowerCase())},isHeadingTag:function(t){return-1!==["h1","h2","h3","h4","h5","h6"].indexOf(t.toLowerCase())},_isTag:function(t){return void 0!==t&&t},_extendTags:function(t,e){if(t=t.concat(t),e)for(var i=0;i<e.length;i++)t.push(e[i]);return t}}),$R.add("class","inspector.parser",{init:function(t,e,i){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.utils=t.utils,this.editor=t.editor,this.selection=t.selection,this.inspector=e,this.el=i,this.$el=$R.dom(this.el),this.node=this.$el.get(),this.node&&8===this.node.nodeType&&(this.node=!1),this.$component=this.$el.closest(".redactor-component",".redactor-in")},isEditor:function(){return this.node===this.editor.getElement().get()},isInEditor:function(){return 0!==this.$el.parents(".redactor-in-"+this.uuid).length},isComponent:function(){return 0!==this.$component.length},isComponentType:function(t){return this.getComponentType()===t},isComponentActive:function(){return this.isComponent()&&this.$component.hasClass("redactor-component-active")},isComponentEditable:function(){var t=this.getComponentType();return this.isComponent()&&-1!==["code","table"].indexOf(t)},isFigcaption:function(){return this.getFigcaption()},isPre:function(){return this.getPre()},isCode:function(){var t=this.$el.closest("code"),e=t.parent("pre");return 0!==t.length&&0===e.length},isList:function(){return this.getList()},isFirstListItem:function(){return this._getLastOrFirstListItem("first")},isLastListItem:function(){return this._getLastOrFirstListItem("last")},isFirstTableCell:function(){return this._getLastOrFirstTableCell("first")},isLastTableCell:function(){return this._getLastOrFirstTableCell("last")},isTable:function(){return this.isComponentType("table")||this.getTable()},isHeading:function(){return this.getHeading()},isBlockquote:function(){return this.getBlockquote()},isDl:function(){return this.getDl()},isParagraph:function(){return this.getParagraph()},isLink:function(){return this.getLink()},isFile:function(){return this.getFile()},isText:function(){return this.inspector.isText(this.el)},isInline:function(){var t=this.opts.inlineTags;return!!this.isElement()&&-1!==t.indexOf(this.node.tagName.toLowerCase())},isBlock:function(){var t=this.opts.blockTags;return!!this.isElement()&&-1!==t.indexOf(this.node.tagName.toLowerCase())},isElement:function(){return this.node&&this.node.nodeType&&3!==this.node.nodeType},hasParent:function(t){return 0!==this.$el.closest(t.join(",")).length},getNode:function(){return this.node},getTag:function(){return!!this.isElement()&&this.node.tagName.toLowerCase()},getComponent:function(){return!!this.isComponent()&&this.$component.get()},getComponentType:function(){return!!this.isComponent()&&this.$component.attr("data-redactor-type")},getFirstNode:function(){return this.utils.getFirstNode(this.node)},getLastNode:function(){return this.utils.getLastNode(this.node)},getFirstElement:function(){return this.utils.getFirstElement(this.node)},getLastElement:function(){return this.utils.getLastElement(this.node)},getFigcaption:function(){return this._getClosestNode("figcaption")},getPre:function(){return this._getClosestNode("pre")},getCode:function(){return this._getClosestNode("code")},getList:function(){return this._getClosestNode("ul, ol")},getParentList:function(){return this._getClosestUpNode("ul, ol")},getListItem:function(){return this._getClosestNode("li")},getTable:function(){return this.getComponentType("table")?this.$component.find("table").get():this._getClosestNode("table")},getTableCell:function(){var t=this.$el.closest("td, th");return 0!==t.length&&t.get()},getComponentCodeElement:function(){return!!this.isComponentType("code")&&this.$component.find("pre code, pre").last().get()},getImageElement:function(){return!!this.isComponentType("image")&&this.$component.find("img").get()},getParagraph:function(){return this._getClosestNode("p")},getHeading:function(){return this._getClosestNode("h1, h2, h3, h4, h5, h6")},getDl:function(){return this._getClosestNode("dl")},getBlockquote:function(){return this._getClosestNode("blockquote")},getLink:function(){var t=this.isComponent()&&!this.isFigcaption();if(this.isComponentType("table")||!t){var e=this._getClosestElement("a");return!(!e||e.attr("data-file"))&&e.get()}return!1},getFile:function(){var t=this.isComponent();if(this.isComponentType("table")||!t){var e=this._getClosestElement("a");return!(!e||!e.attr("data-file"))&&e.get()}return!1},findFirstNode:function(t){return this.$el.find(t).first().get()},findLastNode:function(t){return this.$el.find(t).last().get()},_getLastOrFirstListItem:function(t){var e=this.getList(),i=this.getTag();if(e&&"li"===i){var s=$R.dom(e).find("li")[t]().get();if(s&&this.node===s)return!0}return!1},_getLastOrFirstTableCell:function(t){var e=this.getTable(),i=this.getTag();if(e&&("td"===i||"th"===i)){var s=$R.dom(e).find("td, th")[t]().get();if(s&&this.node===s)return!0}return!1},_getClosestUpNode:function(t){var e=this.$el.parents(t,".redactor-in").last();return 0!==e.length&&e.get()},_getClosestNode:function(t){var e=this.$el.closest(t,".redactor-in");return 0!==e.length&&e.get()},_getClosestElement:function(t){var e=this.$el.closest(t,".redactor-in");return 0!==e.length&&e}}),$R.add("service","marker",{init:function(t){this.app=t},build:function(t,e){var i=document.createElement("span");return i.id="selection-marker-"+this._getPos(t),i.className="redactor-selection-marker",i.innerHTML=this.opts.markerChar,e?i.outerHTML:i},buildHtml:function(t){return this.build(t,!0)},insert:function(t){this.remove();var e="both"!==t&&("start"===t||this.selection.isCollapsed());this.selection.is()||this.editor.focus();var i=this.selection.getRange();if(i){var s=this.build("start"),n=this.build("end"),o=i.cloneRange();return e||(o.collapse(!1),o.insertNode(n)),o.setStart(i.startContainer,i.startOffset),o.collapse(!0),o.insertNode(s),i.setStartAfter(s),e||i.setEndBefore(n),this.selection.setRange(i),s}},find:function(t,e){var i=this.editor.getElement(),s=(e||i).find("span#selection-marker-"+this._getPos(t));return 0!==s.length&&s.get()},restore:function(){var t=this.find("start"),e=this.find("end"),i=this.selection.getRange();if(i&&this.selection.is()||(this.editor.focus(),i=document.createRange()),t){var s=!!e&&e.previousSibling,n=t.nextSibling;n=(!n||3!==n.nodeType||""!==n.textContent.replace(/[\n\t]/g,""))&&n,e?n&&"selection-marker-end"===n.id?this._restoreInject(i,t):s&&n?(i.selectNodeContents(s),i.collapse(!1),i.setStart(n,0)):s&&!n?(i.selectNodeContents(s),i.collapse(!1),i.setStartAfter(t)):(i.setStartAfter(t),i.setEndBefore(e)):n?(i.selectNodeContents(n),i.collapse(!0)):this._restoreInject(i,t),this.selection.setRange(i),t&&t.parentNode.removeChild(t),e&&e.parentNode.removeChild(e)}},remove:function(){var t=this.find("start"),e=this.find("end");t&&t.parentNode.removeChild(t),e&&e.parentNode.removeChild(e)},_getPos:function(t){return void 0===t?"start":t},_restoreInject:function(t,e){var i=this.utils.createInvisibleChar();$R.dom(e).after(i),t.selectNodeContents(i),t.collapse(!1)}}),$R.add("service","component",{init:function(t){this.app=t,this.activeClass="redactor-component-active"},create:function(t,e){return $R.create(t+".component",this.app,e)},build:function(t){var e,i=$R.dom(t).attr("data-redactor-type");return i&&(e=this.create(i,t)),e||t},remove:function(t,e){var i=$R.dom(t).closest(".redactor-component"),s=i.attr("data-redactor-type"),n=i.parent(),o=this.inspector.parse(n),r=this.utils.findSiblings(i,"prev"),a=this.utils.findSiblings(i,"next");if(!1!==this.app.broadcast(s+".delete",i)){if(i.remove(),this.app.broadcast(s+".deleted",i),this.app.broadcast("contextbar.close"),this.app.broadcast("imageresizer.stop"),!1!==e){var l=o.getTableCell();l&&this.utils.isEmptyHtml(l.innerHTML)?this.caret.setStart(l):a?this.caret.setStart(a):r?this.caret.setEnd(r):this.editor.startFocus()}this.editor.isEmpty()&&(this.editor.setEmpty(),this.editor.startFocus(),this.app.broadcast("empty"))}},isNonEditable:function(t){var e=this.inspector.parse(t);return e.isComponent()&&!e.isComponentEditable()},isActive:function(t){if(t){var e=this.inspector.parse(t);return $R.dom(e.getComponent()).hasClass(this.activeClass)}return 0!==this._find().length},getActive:function(t){var e=this._find();return 0!==e.length&&(t?e:e.get())},setActive:function(t){this.clearActive(),this.editor.focus();var e=this.inspector.parse(t),i=e.getComponent(),s=$R.dom(i);if(!e.isFigcaption()){var n=s.find(".redactor-component-caret");0===n.length&&(n=this._buildCaret(),s.prepend(n)),this.caret.setAtStart(n.get())}s.addClass(this.activeClass)},clearActive:function(){var t=this._find();t.removeClass(this.activeClass),t.find(".redactor-component-caret").remove(),this.app.broadcast("imageresizer.stop")},setOnEvent:function(t,e){this.clearActive();var i=this.inspector.parse(t.target);i.isFigcaption()||i.isComponentEditable()||i.isComponent()&&(this.setActive(t.target),!0!==e&&t.preventDefault())},executeScripts:function(){for(var $editor=this.editor.getElement(),scripts=$editor.find("[data-redactor-type]").find("script").getAll(),i=0;i<scripts.length;i++)if(""!==scripts[i].src){var src=scripts[i].src;this.$doc.find('head script[src="'+src+'"]').remove();var $script=$R.dom("<script>");$script.attr("src",src),$script.attr("async defer"),-1!==src.search("instagram")&&$script.attr("onload","window.instgrm.Embeds.process()");var head=document.getElementsByTagName("head")[0];head&&head.appendChild($script.get())}else eval(scripts[i].innerHTML)},_find:function(){return this.editor.getElement().find("."+this.activeClass)},_buildCaret:function(){var t=$R.dom("<span>");return t.addClass("redactor-component-caret"),t.attr("contenteditable",!0),t}}),$R.add("service","insertion",{init:function(t){this.app=t},set:function(t,e,i){return null===t&&(t=""),t=!1!==e?this.cleaner.input(t):t,t=!1!==e?this.cleaner.paragraphize(t):t,this.editor.getElement().html(t),!1!==i&&this.editor.endFocus(),t},insertNode:function(t,e){this.editor.focus();var i=this.utils.isFragment(t)?t:this.utils.createFragment(t);return this._collapseSelection(),this._insertFragment(i),this._setCaret(e,i),this._sendNodes(i.nodes)},insertBreakLine:function(){return this.insertNode(document.createElement("br"),"after")},insertNewline:function(){return this.insertNode(document.createTextNode("\n"),"after")},insertText:function(t){return this.insertHtml(this.cleaner.getFlatText(t))},insertChar:function(t){return this.insertNode(t,"after")},insertRaw:function(t){return this.insertHtml(t,!1)},insertToEnd:function(t,e){if(t){3===t.nodeType&&-1!==t.nodeValue.search(/^\n/)&&(t=t.previousElementSibling);var i=$R.dom(t);if(i.attr("data-redactor-type")===e){var s=this.opts.breakline?"<br>":"<p>",n=$R.dom(s);i.after(n),this.caret.setStart(n)}}},insertPoint:function(t){var e,i=this.marker.build("start"),s=!1,n=t.clientX,o=t.clientY;if(document.caretPositionFromPoint){var r=document.caretPositionFromPoint(n,o),a=document.getSelection();this.inspector.parse(r.offsetNode).isInEditor()&&((e=a.getRangeAt(0)).setStart(r.offsetNode,r.offset),e.collapse(!0),e.insertNode(i),s=!0)}else document.caretRangeFromPoint&&(e=document.caretRangeFromPoint(n,o),this.inspector.parse(e.startContainer).isInEditor()&&(e.insertNode(i),s=!0));return s},insertToPoint:function(t,e,i,s){if(!(!0===i||this.insertPoint(t))){var n=this.editor.getLastNode();$R.dom(n).after(this.marker.build("start"))}return this.component.clearActive(),this.selection.restoreMarkers(),this.insertHtml(e,s)},insertToOffset:function(t,e){return this.offset.set({start:t,end:t}),this.insertHtml(e)},insertHtml:function(t,e){if(this.opts.input){var i=this.utils.parseHtml(t);if(this.selection.isAll())return this._insertToAllSelected(i);if(!this.selection.is()){var s=$R.dom("<p>");this.editor.getElement().append(s),this.caret.setStart(s)}var n=this.selection.isCollapsed(),o=this.selection.isText(),r=this.selection.getCurrent(),a=this.inspector.parse(r);this._collapseSelection(),i=this._getCleanedInput(i,a,e);var l,h,c=this._isFigure(i.html),d=this._isComponentSpan(i.html),u=this.inspector.isText(i.html);if(this.editor.isEmpty())return this._insertToEmptyEditor(i.html);if(a.isComponent()&&!a.isComponentEditable())return this._insertToWidget(r,a,i.html);if(d)return this.insertNode(i.nodes,"end");if(c&&!o&&!a.isList())return a.isInline()?this._insertToInline(r,i):(l=this.utils.createFragment(i.html),this.utils.splitNode(r,l),this.caret.setEnd(l.last),this._sendNodes(l.nodes));if(a.isCode())return this._insertToCode(i,r,e);if(a.isPre())return this._insertToPre(i,e);if(a.isHeading()||a.isFigcaption())return i.html=!1!==e?this.cleaner.removeTagsExcept(i.html,["a"]):i.html,i.html=!1!==e?this.cleaner.replaceNbspToSpaces(i.html):i.html,l=this.utils.createFragment(i.html),this.insertNode(l,"end");if(u)return!o&&"br"!==this.opts.markup&&this._hasBlocksAndImages(i.nodes)?(i.html=!1!==e?this.cleaner.paragraphize(i.html):i.html,l=this.utils.createFragment(i.html),this.utils.splitNode(r,l),this.caret.setEnd(l.last),this._sendNodes(l.nodes)):(i.html=!1!==e?i.html.replace(/\n/g,"<br>"):i.html,l=this.utils.createFragment(i.html),this.insertNode(l.nodes,"end"));if(!n&&!c)return i.html=!1!==e?this.cleaner.paragraphize(i.html):i.html,l=this.utils.createFragment(i.html),this.insertNode(l,"end");if(a.isInline()&&!this._isPlainHtml(i.html))return this._insertToInline(r,i);if(a.isBlockquote()||a.isDl())return(h=this.opts.inlineTags).concat(["br"]),i.html=!1!==e?this.cleaner.replaceBlocksToBr(i.html):i.html,i.html=!1!==e?this.cleaner.removeTagsExcept(i.html,h):i.html,l=this.utils.createFragment(i.html),this.insertNode(l,"end");if(a.isParagraph())return this._isPlainHtml(i.html)?this.insertNode(i.nodes,"end"):(i.html=!1!==e?this.cleaner.paragraphize(i.html):i.html,l=this.utils.createFragment(i.html),this.utils.splitNode(r,l),this.caret.setEnd(l.last),this._sendNodes(l.nodes));if(a.isList()&&(h=(h=this.opts.inlineTags).concat(["br","li","ul","ol","img"]),i.html=!1!==e?this.cleaner.replaceBlocksToBr(i.html):i.html,i.html=!1!==e?this.cleaner.removeTagsExcept(i.html,h):i.html,i.html=!1!==e?this.cleaner.removeBrAtEnd(i.html):i.html,l=this.utils.createFragment(i.html),i.nodes=l.nodes,this._containsTags(i.html,["ul","ol","li"]))){var p=this.selection.getElement(r);if(p&&"LI"===p.tagName&&this.caret.isStart(p)){i.nodes=$R.dom(l.nodes).unwrap("ul, ol").getAll(),$R.dom(p).before(i.nodes);var f=i.nodes[i.nodes.length-1];return this.caret.setEnd(f),this._sendNodes(i.nodes)}return this._isPlainHtml(i.html)?this.insertNode(l,"end"):(l=this._buildList(i,p,l),this.utils.splitNode(r,l,!0),this.caret.setEnd(l.last),this._sendNodes(l.nodes))}return this.insertNode(i.nodes,"end")}},_insertToAllSelected:function(t){var e=this.set(t.html),i=this.utils.parseHtml(e);return this._sendNodes(i.nodes)},_insertToEmptyEditor:function(t){t=this.cleaner.paragraphize(t);var e=this.utils.createFragment(t),i=this.editor.getElement();return i.html(""),i.append(e.frag),this.caret.setEnd(e.last),this._sendNodes(e.nodes)},_insertToInline:function(t,e){var i=this.utils.createFragment(e.html);return this.utils.splitNode(t,i,!1,!0),this.caret.setEnd(i.last),this._sendNodes(i.nodes)},_insertToCode:function(t,e,i){t.html=!1!==i?this.cleaner.encodeHtml(t.html):t.html,t.html=!1!==i?this.cleaner.removeNl(t.html):t.html;var s=this.utils.createFragment(t.html),n=this.insertNode(s,"end");return this.utils.normalizeTextNodes(e),n},_insertToPre:function(t,e){t.html=!1!==e?this.cleaner.encodeHtml(t.html):t.html;var i=this.utils.createFragment(t.html);return this.insertNode(i,"end")},_insertToWidget:function(t,e,i){i=this._isComponentSpan(i)?i:this.cleaner.paragraphize(i);var s=this.utils.createFragment(i),n=e.getComponent(),o=$R.dom(n);return o.after(s.frag),o.remove(),this.caret.setEnd(s.last),this._sendNodes(s.nodes)},_insertFragment:function(t){var e=this.selection.getRange();if(e){if(this.selection.isCollapsed()){var i=e.startContainer;3!==i.nodeType&&"BR"===i.tagName&&(this.caret.setAfter(i),i.parentNode.removeChild(i))}else e.deleteContents();e.insertNode(t.frag)}},_sendNodes:function(t){for(var e=0;e<t.length;e++){var i=t[e],s=3!==i.nodeType&&"function"==typeof i.getAttribute&&i.getAttribute("data-redactor-type");s&&this.app.broadcast(s+".inserted",this.component.build(i))}return this.detector.isIe()&&this.editor.getElement().find("[data-redactor-type=table]").attr("contenteditable",!0),this.app.broadcast("inserted",t),this.component.executeScripts(),t},_setCaret:function(t,e){var i=this._isLastInline(e);t?(t=i&&"end"===t?"after":t,this.caret["set"+this.utils.ucfirst(t)](e.last)):!1!==t&&i&&this.caret.setAfter(e.last)},_isLastInline:function(t){return!!t.last&&this.inspector.parse(t.last).isInline()},_getCleanedInput:function(t,e,i){var s=e.isCode()||e.isPre();return t.html=t.html.replace(/&nbsp;/g," "),t.html=s||!1===i?t.html:this.cleaner.input(t.html),t=s||!1===i?t:this.utils.parseHtml(t.html)},_getContainer:function(t){return $R.dom(this.utils.createTmpContainer(t))},_buildList:function(t,e,i){var s=t.nodes[0];if(s&&3!==s.nodeType&&"li"===s.tagName){var n=$R.dom(e).get().tagName.toLowerCase(),o=$R.dom("<"+n+" />");return o.append(i.nodes),this.utils.createFragment(o.get().outerHTML)}return i},_containsTags:function(t,e){return 0!==this._getContainer(t).find(e.join(",")).length},_collapseSelection:function(){},_hasFigureOrTable:function(t){return 0!==this._getContainer(t).find("figure, table").length},_hasBlocks:function(t){return 0!==this._getContainer(t).find(this.opts.blockTags.join(",")).length},_hasBlocksAndImages:function(t){return 0!==this._getContainer(t).find(this.opts.blockTags.join(",")+",img").length},_isPlainHtml:function(t){return 0===this._getContainer(t).find(this.opts.blockTags.join(",")+", img").length},_isFigure:function(t){if(this._isHtmlString(t))return 0!==$R.dom(t).closest("figure").length},_isComponentSpan:function(t){if(this._isHtmlString(t))return 0!==$R.dom(t).closest("span.redactor-component").length},_isHtmlString:function(t){return!("string"==typeof t&&!/^\s*<(\w+|!)[^>]*>/.test(t))}}),$R.add("service","block",{mixins:["formatter"],init:function(t){this.app=t},format:function(t){return this.type=t.type?t.type:"set",this.tag="string"==typeof t?t:t.tag,this.tag=this._prepareTag(this.tag),this.tag=this.tag.toLowerCase(),"string"==typeof t?this.args=!1:this.buildArgs(t),this._format()},getBlocks:function(t){return this.selection.getBlocks({tags:t||this._getTags(),first:!0})},getElements:function(t){var e=this.selection.getBlock();return this.selection.isCollapsed()||!e||"TD"!==e.tagName&&"TH"!==e.tagName?$R.dom(this.getBlocks(t)):this._wrapInsideTable("div")},clearFormat:function(t){this.selection.save();var e=this.getElements(t||this._getTags());return e.each(function(t){for(;t.attributes.length>0;)t.removeAttribute(t.attributes[0].name)}),this.selection.restore(),e.getAll()},_format:function(){this.selection.save();var t,e,i=this.getBlocks(),s=this.selection.getBlock(),n=[];if(1===i.length&&"DIV"===i[0].tagName){if(!(t=this._getTextNodesData())||0===t.nodes.length)return n=this._replaceBlocks(i),n=this._sendNodes(n),setTimeout(function(){this.selection.restore()}.bind(this),0),n;e=this._getReplacedTag("set"),l=$R.dom("<"+e+">"),(a=t.last.nextSibling)&&"BR"===a.tagName&&$R.dom(a).remove();for(var o=0;o<t.nodes.length;o++)l.append(t.nodes[o]);return this.utils.splitNode(i[0],[l.get()]),n=this._sendNodes([l.get()]),this.utils.isEmptyHtml(l.html())?this.caret.setStart(l):setTimeout(function(){this.selection.restore()}.bind(this),0),n}if(i.length>0)return n=this._replaceBlocks(i),n=this._sendNodes(n),this.selection.isCollapsed()&&1===i.length&&this.utils.isEmpty(i[0])?this.caret.setStart(n[0]):setTimeout(function(){this.selection.restore()}.bind(this),1),n;if(!this.selection.isCollapsed()&&s&&("TD"===s.tagName||"TH"===s.tagName))return e=this._getReplacedTag("set"),l=this._wrapInsideTable(e),this.selection.setAll(l),this._sendNodes([l.get()]);if(this.selection.isCollapsed()&&s&&("TD"===s.tagName||"TH"===s.tagName)){var r=this._getChildTextNodes(s);e=this._getReplacedTag("set");var a,l=$R.dom("<"+e+">");$R.dom(r.first).before(l);for(o=0;o<r.nodes.length;o++)l.append(r.nodes[o]);return(a=l.get().nextSibling)&&"BR"===a.tagName&&$R.dom(a).remove(),this._sendNodes([l.get()])}return n},_wrapInsideTable:function(t){var e=this._getTextNodesData(),i=$R.dom("<"+t+">");$R.dom(e.first).before(i);for(var s=0;s<e.nodes.length;s++)i.append(e.nodes[s]);var n=i.get().nextSibling;return n&&"BR"===n.tagName&&$R.dom(n).remove(),i},_prepareTag:function(t){return void 0===t?this.opts.markup:t},_sendNodes:function(t){return t.length>0&&(t=this.applyArgs(t,!1),t=this._combinePre(t),t=this._cleanBlocks(t)),t},_getTags:function(){return["div","p","blockquote","pre","h1","h2","h3","h4","h5","h6"]},_replaceBlocks:function(t){for(var e=[],i=this._isToggleFormatType(t)?"toggle":"set",s=this._getReplacedTag(i),n=0;n<t.length;n++){var o=this.utils.replaceToTag(t[n],s);e.push(o.get())}return e},_getReplacedTag:function(t){var e="toggle"===t?this.opts.markup:this.tag;return this.opts.breakline&&"p"===e?"div":e},_getChildTextNodes:function(t){for(var e=t.childNodes,i=e[0],s=[],n=0;n<=e.length;n++){var o=e[n];if(o&&3!==o.nodeType&&this.inspector.isBlockTag(o.tagName))break;s.push(o)}return{nodes:s,first:i}},_getTextNodesData:function(){var t=this.selection.getNodes({textnodes:!0,keepbr:!0});if(0===t.length)return!1;for(var e=t[0],i=t[t.length-1],s=i,n=!1;!n;){var o=this.selection.getInline(s);(s=o?o.nextSibling:s.nextSibling)&&(3===s.nodeType||"BR"!==s.tagName&&!this.inspector.isBlockTag(s.tagName))?t.push(s):n=!0}return{nodes:t,first:e,last:i}},_isToggleFormatType:function(t){for(var e=0,i=t.length,s=0;s<i;s++)t[s]&&this.tag===t[s].tagName.toLowerCase()&&e++;return e===i},_combinePre:function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i].nextElementSibling;if(s&&"PRE"===t[i].tagName&&"PRE"===s.tagName){var n=$R.dom(t[i]),o=$R.dom(s),r=document.createTextNode("\n");n.append(r),n.append(o),o.unwrap("pre")}e.push(t[i])}return e},_cleanBlocks:function(t){for(var e=["h1","h2","h3","h4","h5","h6"],i=this.opts.inlineTags,s=0;s<t.length;s++){var n=t[s].tagName.toLowerCase(),o=$R.dom(t[s]);-1!==e.indexOf(n)?o.find("span").not(".redactor-component, .non-editable, .redactor-selection-marker").unwrap():"pre"===n&&o.find(i.join(",")).not(".redactor-selection-marker").unwrap(),this.opts.breakline&&"div"===n?o.attr("data-redactor-tag","br"):o.removeAttr("data-redactor-tag"),this.utils.normalizeTextNodes(t[s])}return t}}),$R.add("service","inline",{mixins:["formatter"],init:function(t){this.app=t,this.count=0},format:function(t){if(!this._isFormat())return[];this.type=t.type?t.type:"set",this.tag="string"==typeof t?t:t.tag,this.tag=this.tag.toLowerCase(),this.tag=this.arrangeTag(this.tag),"string"==typeof t?this.args=!1:this.buildArgs(t),this.detector.isIe()||this.editor.disableNonEditables();var e=this.selection.isCollapsed()?this.formatCollapsed():this.formatUncollapsed();return this.detector.isIe()||this.editor.enableNonEditables(),e},_isFormat:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t),i=e.isComponent()&&!e.isComponentType("table")&&!e.isFigcaption();return!(!1!==t||!this.selection.isAll())||!(!t||e.isPre()||e.isCode()||i)},arrangeTag:function(t){var e=this.opts.replaceTags;for(var i in e)t===i&&(t=e[i]);return t},formatCollapsed:function(){var t,e,i,s,n=[],o=this.selection.getInlineFirst(),r=this.selection.getInlines({all:!0}),a=$R.dom(o);if(o){var l=this.inspector.parse(o);if(this.utils.isEmptyHtml(o.innerHTML))if(o.tagName.toLowerCase()===this.tag)if(this.hasSameArgs(o)){this.caret.setAfter(o),a.remove();var h=this.selection.getElement();this.utils.normalizeTextNodes(h)}else"span"===this.tag?(n=this.applyArgs([o],!1),this.caret.setStart(o)):n=this.insertInline(n);else l.hasParent([this.tag])?(e=(t=a.closest(this.tag)).get(),this.hasSameArgs(e)?(t.unwrap(),this.caret.setStart(o)):n=this.insertInline(n)):n=this.insertInline(n);else if(o.tagName.toLowerCase()===this.tag)this.hasSameArgs(o)?(s=this.utils.extractHtmlFromCaret(o),i=$R.dom("<"+this.tag+" />"),i=this.utils.cloneAttributes(o,i),a.after(i.append(s)),this.caret.setAfter(o)):n=this.insertInline(n);else if(l.hasParent([this.tag]))if(e=(t=a.closest(this.tag)).get(),this.hasSameArgs(e)){var c,d;s=this.utils.extractHtmlFromCaret(e,e),i=$R.dom("<"+this.tag+" />"),i=this.utils.cloneAttributes(e,i);var u=0;r=r.reverse();for(var p=0;p<r.length;p++)r[p]!==e&&(d=$R.dom("<"+r[p].tagName.toLowerCase()+">"),0===u?c=d:c.append(d),u++);t.after(i.append(s)),t.after(c),this.caret.setStart(d)}else n=this.insertInline(n);else n=this.insertInline(n)}else n=this.insertInline(n);return n},insertInline:function(t){var e=document.createElement(this.tag);return t=this.insertion.insertNode(e,"start"),this.applyArgs(t,!1)},hasSameArgs:function(t){if(0===t.attributes.length&&!1===this.args)return!0;var e=!0;if(this.args){var i=0;for(var s in this.args){var n=$R.dom(t),o=this.args[s],r=this.utils.toParams(o),a=n.attr(s);if(o)if("style"===s){r=r.trim().replace(/;$/,"");for(var l=this.utils.styleToObj(n.attr("style")),h=r.split(";"),c=0,d=0;d<h.length;d++){var u=h[d].split(":"),p=u[0].trim(),f=u[1].trim();if(-1!==p.search(/color/)){var m=n.css(p);!m||m!==f&&this.utils.rgb2hex(m)!==f||c++}else n.css(p)===f&&c++}c===h.length&&Object.keys(l).length===h.length&&i++}else a===r&&i++;else a&&""!==a||i++}e=i===Object.keys(this.args).length}return e},formatUncollapsed:function(){var t=this.selection.getInlines({all:!0,inside:!0});this.detector.isIe()?this.selection.saveMarkers():this.selection.save(),this._convertTags("u"),this._convertTags("del"),this._convertToStrike(t),this.detector.isIe()?this.selection.restoreMarkers():this.selection.restore(),document.execCommand("strikethrough"),this._clearDecoration(),this.selection.save();var e=this._revertToInlines();e=this.applyArgs(e,!1);for(var i=0;i<e.length;i++){var s=e[i],n=s.tagName.toLowerCase(),o=s.attributes.length;n===this.tag&&0===o&&this.args&&($R.dom(s).unwrap(),e.splice(i,1))}return this.selection.restore(),this._clearEmptyStyle(),e=this._normalizeBlocks(e)},_convertTags:function(t){this.tag!==t&&this.editor.getElement().find(t).each(function(e){this.utils.replaceToTag(e,"span").addClass("redactor-convertable-"+t)}.bind(this))},_revertTags:function(t){this.editor.getElement().find("span.redactor-convertable-"+t).each(function(e){var i=this.utils.replaceToTag(e,t);i.removeClass("redactor-convertable-"+t),this.utils.removeEmptyAttr(i,"class")&&i.removeAttr("class")}.bind(this))},_convertToStrike:function(t){for(var e=this.selection.getText().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i=0;i<t.length;i++){var s=this.arrangeTag(t[i].tagName.toLowerCase()),n=t[i],o=$R.dom(n),r=this.hasSameArgs(n);s===this.tag&&("span"===this.tag&&this._isTextSelected(n,e)?o.addClass("redactor-convertable-apply"):r&&"a"!==this.tag?this._replaceToStrike(o):"span"===this.tag?o.addClass("redactor-unconvertable-apply"):r||o.addClass("redactor-convertable-apply"))}},_replaceToStrike:function(t){t.replaceWith(function(){return $R.dom("<strike>").append(t.contents())})},_revertToInlines:function(){var t=[],e=this.editor.getElement();return"u"!==this.tag&&e.find("u").unwrap(),e.find(".redactor-convertable-apply").each(function(e){var i=$R.dom(e);i.find("strike").unwrap(),this._forceRemoveClass(i,"redactor-convertable-apply"),t.push(e)}.bind(this)),e.find("span.redactor-unconvertable-apply").each(function(t){var e=$R.dom(t);this._forceRemoveClass(e,"redactor-unconvertable-apply")}.bind(this)),e.find("strike").each(function(e){var i=this.utils.replaceToTag(e,this.tag);t.push(i.get())}.bind(this)),this._revertTags("u"),this._revertTags("del"),t},_normalizeBlocks:function(t){var e=this.opts.inlineTags,i=this.selection.getBlocks();if(i)for(var s=0;s<i.length;s++){if("PRE"===i[s].tagName)$R.dom(i[s]).find(e.join(",")).not(".redactor-selection-marker").each(function(e){-1!==t.indexOf(e)&&(t=this.utils.removeFromArrayByValue(t,e)),$R.dom(e).unwrap()}.bind(this))}return t},_clearDecoration:function(){this.editor.getElement().find(this.opts.inlineTags.join(",")).each(function(t){if("line-through"===t.style.textDecoration||"line-through"===t.style.textDecorationLine){var e=$R.dom(t);e.css("textDecorationLine",""),e.css("textDecoration",""),e.wrap("<strike>")}})},_clearEmptyStyle:function(){for(var t=this.getInlines(),e=0;e<t.length;e++){this._clearEmptyStyleAttr(t[e]);var i=t[e].childNodes;if(i)for(var s=0;s<i.length;s++)this._clearEmptyStyleAttr(i[s])}},_clearEmptyStyleAttr:function(t){3!==t.nodeType&&this.utils.removeEmptyAttr(t,"style")&&(t.removeAttribute("style"),t.removeAttribute("data-redactor-style-cache"))},_forceRemoveClass:function(t,e){t.removeClass(e),this.utils.removeEmptyAttr(t,"class")&&t.removeAttr("class")},_isTextSelected:function(t,e){var i=this.utils.removeInvisibleChars(t.textContent);return e===i||-1!==e.search(new RegExp("^"+this.utils.escapeRegExp(i)+"$"))},getInlines:function(t){return t?this.selection.getInlines({tags:t,all:!0}):this.selection.getInlines({all:!0})},getElements:function(t){return $R.dom(this.getInlines(t))},clearFormat:function(){this.selection.save();for(var t=this.selection.getInlines({all:!0}),e=0;e<t.length;e++){var i=$R.dom(t[e]);this.selection.getInline(t[e])&&i.unwrap()}this.selection.restore()}}),$R.add("service","autoparser",{init:function(t){this.app=t},observe:function(){var t=this.editor.getElement().find(".redactor-autoparser-object").each(function(t){var e=$R.dom(t);e.removeClass("redactor-autoparser-object"),""===e.attr("class")&&e.removeAttr("class")});t.length>0&&t.each(function(t){var e,i=!1,s=t.tagName;"A"===s?e="link":"IMG"===s?e="image":"IFRAME"===s&&(e="video"),e&&(i=$R.create(e+".component",this.app,t),this.app.broadcast(e+".inserted",i),this.app.broadcast("autoparse",e,i))}.bind(this))},format:function(t,e){this._isKey(e)&&this._format(e===this.keycodes.ENTER)},parse:function(t){var e=["figure","form","pre","iframe","code","a","img"],i=[],s=0;t=this.cleaner.encodePreCode(t);for(var n=0;n<e.length;n++){var o="img"===e[n]?"<"+e[n]+"[^>]*>":"<"+e[n]+"([\\w\\W]*?)</"+e[n]+">",r=t.match(new RegExp(o,"gi"));if(null!==r)for(var a=0;a<r.length;a++)t=t.replace(r[a],"#####replaceparse"+s+"#####"),i.push(r[a]),s++}if(this.opts.autoparseImages&&t.match(this.opts.regex.imageurl)){var l=t.match(this.opts.regex.imageurl);for(n=0;n<l.length;n++)t=t.replace(l[n],'<img class="redactor-autoparser-object" src="'+l[n]+'">')}if(this.opts.autoparseVideo&&(t.match(this.opts.regex.youtube)||t.match(this.opts.regex.vimeo))){var h,c;t.match(this.opts.regex.youtube)?(h="//www.youtube.com/embed/$1",c=this.opts.regex.youtube):t.match(this.opts.regex.vimeo)&&(h="//player.vimeo.com/video/$2",c=this.opts.regex.vimeo);var d=this.component.create("video",'<iframe width="500" height="281" src="'+h+'" frameborder="0" allowfullscreen></iframe>');t=t.replace(c,d.get().outerHTML)}return this.opts.autoparseLinks&&t.match(this.opts.regex.url)&&(t=this._formatLinks(t)),t=this._restoreReplaced(i,t),t=this._restoreReplaced(i,t)},_isKey:function(t){return t===this.keycodes.ENTER||t===this.keycodes.SPACE},_format:function(t){var e=this.selection.getParent(),i=$R.dom(e);if(!(e&&0!==i.closest("figure, pre, code, img, a, iframe").length)&&this.selection.isCollapsed()){var s=this.utils.createInvisibleChar();this.selection.getRange().insertNode(s);var n=this.selection.getCurrent(),o=this.inspector.parse(n),r=$R.dom(n);if(s.parentNode.removeChild(s),n&&3===n.nodeType){var a,l=n.textContent;if(this.opts.autoparseImages&&l.match(this._convertToRegExp(this.opts.regex.imageurl))){var h=o.isList(),c=l.match(this.opts.regex.imageurl),d=h?void 0:"<figure><img></figure>",u=this.component.create("image",d);u.setSrc(c[0]),u.addClass("redactor-autoparser-object"),l=l.replace(c[0],u.get().outerHTML),a="image"}else if(this.opts.autoparseVideo&&(l.match(this._convertToRegExp(this.opts.regex.youtube))||l.match(this._convertToRegExp(this.opts.regex.vimeo)))){var p,f;l.match(this.opts.regex.youtube)?(p="//www.youtube.com/embed/$1",f=this.opts.regex.youtube):l.match(this.opts.regex.vimeo)&&(p="//player.vimeo.com/video/$2",f=this.opts.regex.vimeo);var m=this.component.create("video",'<iframe width="500" height="281" src="'+p+'" frameborder="0" allowfullscreen></iframe>');m.addClass("redactor-autoparser-object"),l=l.replace(f,m.get().outerHTML),a="video"}else this.opts.autoparseLinks&&l.match(this._convertToRegExp(this.opts.regex.url))&&(l=this._formatLinks(l,t),a="link");if(a){t?(this.selection.save(),r.replaceWith(l),this.selection.restore()):r.replaceWith(l);var g=this.editor.getElement().find(".redactor-autoparser-object").removeClass("redactor-autoparser-object");if(g="link"===a?$R.create("link.component",this.app,g):g,"link"===a)t||this.caret.setAfter(g),this.app.broadcast("link.inserted",g);else{this.caret.setAfter(g);var v=g.clone();g.remove(),g=this.insertion.insertHtml(v),g=this.component.build(g)}this.app.broadcast("autoparse",a,g)}}}},_formatLinks:function(t,e){for(var i=t.match(this.opts.regex.url),s={},n=0;n<i.length;n++){e&&-1!==i[n].search(/\.$/)&&(i[n]=i[n].replace(/\.$/,""));var o=i[n],r=o,a=null!==o.match(/(https?|ftp):\/\//i)?"":"http://",l=-1!==["/","&","="].indexOf(o.slice(-1))?"":"\\b",h=!1!==this.opts.pasteLinkTarget?' target="'+this.opts.pasteLinkTarget+'"':"";r=-1===(r=r.length>this.opts.linkSize?r.substring(0,this.opts.linkSize)+"...":r).search("%")?decodeURIComponent(r):r;s["("+o.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+l+")"]='<a href="'+a+o.trim()+'"'+h+' class="redactor-autoparser-object">'+r.trim()+"</a>"}for(var c in s)t=t.replace(new RegExp(c,"g"),s[c]);return t},_restoreReplaced:function(t,e){for(var i=0;i<t.length;i++)e=e.replace("#####replaceparse"+i+"#####",t[i]);return e},_convertToRegExp:function(t){return new RegExp(String(t).replace(/^\//,"").replace(/\/ig$/,"").replace(/\/gi$/,"")+"$","gi")}}),$R.add("service","storage",{init:function(t){this.app=t,this.data=[]},observeImages:function(){this.editor.getElement().find("[data-image]").each(this._addImage.bind(this))},observeFiles:function(){this.editor.getElement().find("[data-file]").each(this._addFile.bind(this))},setStatus:function(t,e){this.data[t].status=e},getChanges:function(){var t=this.editor.getElement();for(var e in this.data){var i=this.data[e],s=t.find("[data-"+i.type+'="'+i.id+'"]');this.setStatus(i.id,0!==s.length)}return this.data},add:function(t,e){var i=$R.dom(e),s=i.attr("data-"+t);this.data[s]={type:t,status:!0,node:i.get(),id:i.attr("data-"+t)}},_addImage:function(t){this.add("image",t)},_addFile:function(t){this.add("file",t)}}),$R.add("service","utils",{init:function(t){this.app=t},isEmpty:function(t){var e=!1;return(t=$R.dom(t).get())&&(e=3===t.nodeType?""===t.textContent.trim().replace(/\n/,""):""===t.innerHTML),e},isEmptyHtml:function(t,e,i){return t=(t=(t=(t=(t=(t=this.removeInvisibleChars(t)).replace(/&nbsp;/gi,"")).replace(/<\/?br\s?\/?>/g,e?"br":"")).replace(/\s/g,"")).replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,"")).replace(/^<div>[^\W\w\D\d]*?<\/div>$/i,""),i&&(t=(t=t.replace(/<ul(.*?[^>])>$/i,"ul")).replace(/<ol(.*?[^>])>$/i,"ol")),""===(t=(t=(t=(t=(t=(t=t.replace(/<hr(.*?[^>])>$/i,"hr")).replace(/<iframe(.*?[^>])>$/i,"iframe")).replace(/<source(.*?[^>])>$/i,"source")).replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")).replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")).trim())},trimSpaces:function(t){return this.removeInvisibleChars(t.trim())},createInvisibleChar:function(){return document.createTextNode(this.opts.markerChar)},searchInvisibleChars:function(t){return t.search(/^\uFEFF$/g)},removeInvisibleChars:function(t){return t.replace(/\uFEFF/g,"")},trimInvisibleChars:function(t){if(this.selection.isCollapsed()){var e=this.selection.getCurrent(),i="left"===t?this.selection.getTextBeforeCaret():this.selection.getTextAfterCaret();if(e&&3===e.nodeType&&0===this.searchInvisibleChars(i))if("left"===t)$R.dom(e).replaceWith(e.textContent.trim());else{var s=this.offset.get();this.offset.set({start:s.start+1,end:s.end+1})}}},buildWrapper:function(t){return $R.dom("<div>").html(t)},getWrapperHtml:function(t){var e=t.html();return t.remove(),e},createTmpContainer:function(t){var e=$R.dom("<div>");return"string"==typeof t?e.html(t):e.append($R.dom(t).clone(!0)),e.get()},createFragment:function(t){for(var e,i,s,n=this.createTmpContainer(t),o=document.createDocumentFragment(),r=[],a=0;e=n.firstChild;){a++;var l=o.appendChild(e);1===a&&(i=l),r.push(l),s=l}return{frag:o,first:i,last:s,nodes:r}},isFragment:function(t){return"object"==typeof t&&t.frag},parseHtml:function(t){var e=this.createTmpContainer(t);return{html:e.innerHTML,nodes:e.childNodes}},splitNode:function(t,e,i,s){var n;e=this.isFragment(e)?e.frag:e,n=s?this.inspector.isInlineTag(t.tagName)?t:this.selection.getInline(t):this.inspector.isBlockTag(t.tagName)?t:this.selection.getBlock(t);var o=$R.dom(n);if(!s&&this.isEmptyHtml(n.innerHTML,!0))return o.after(e),o.remove(),e;var r=o.get().tagName.toLowerCase(),a=this.caret.isEnd(n),l=this.caret.isStart(n);if(!a&&!l){var h=this.extractHtmlFromCaret(s),c=$R.dom("<"+r+" />");c=this.cloneAttributes(n,c),o.after(c.append(h))}if(l)return o.before(e);if(i)return o.append(e);e=o.after(e);var d=o.html();return""===(d=(d=this.removeInvisibleChars(d)).replace(/&nbsp;/gi,""))&&o.remove(),e},extractHtmlFromCaret:function(t,e){var i=this.selection.getRange();if(i&&(e=e||(t?this.selection.getInline():this.selection.getBlock()))){var s=i.cloneRange();return s.selectNodeContents(e),s.setStart(i.endContainer,i.endOffset),s.extractContents()}},createMarkup:function(t){var e=document.createElement(this.opts.markup);this.opts.breakline&&e.setAttribute("data-redactor-tag","br"),$R.dom(t).after(e),this.caret.setStart(e)},createMarkupBefore:function(t){var e=document.createElement(this.opts.markup);this.opts.breakline&&e.setAttribute("data-redactor-tag","br"),$R.dom(t).before(e),this.caret.setEnd(e)},getNode:function(t){var e=$R.dom(t).get(),i=this.editor.getElement().get();return void 0===t?i:e||!1},findSiblings:function(t,e){for(t=$R.dom(t).get(),e="next"===e?"nextSibling":"previousSibling";t=t[e];)if((3!==t.nodeType||""!==t.textContent.trim())&&"BR"!==t.tagName)return t;return!1},getElementsFromHtml:function(t,e,i){var s=document.createElement("div");s.innerHTML=t;var n=s.querySelectorAll(e);return function(t,e){if("number"==typeof this.length&&"function"==typeof t){var i=[];if("object"==typeof this)for(var s=0;s<this.length;s++){if(!(s in this))return;i[s]=t.call(e||this,this[s],s,this)}return i}}.call(n,function(t){var e=t.getAttribute("data-redactor-type");if(!i||!e||e!==i)return t.outerHTML})},getChildNodes:function(t,e,i){var s=(t=t&&t.nodeType&&11===t.nodeType?t:$R.dom(t).get()).childNodes,n=[];if(s)for(var o=0;o<s.length;o++)if(!(!0===i&&3===s[o].nodeType||3===s[o].nodeType&&this.isEmpty(s[o])||(n.push(s[o]),!1===e))){var r=this.getChildNodes(s[o],i);r.length>0&&(n=n.concat(r))}return n},getChildElements:function(t){return this.getChildNodes(t,!0,!0)},getFirstNode:function(t){return this._getFirst(this.getChildNodes(t,!1))},getLastNode:function(t){return this._getLast(this.getChildNodes(t,!1))},getFirstElement:function(t){return this._getFirst(this.getChildNodes(t,!1,!0))},getLastElement:function(t){return this._getLast(this.getChildNodes(t,!1,!0))},replaceToTag:function(t,e){return $R.dom(t).replaceWith(function(t){var i=$R.dom("<"+e+">").append($R.dom(t).contents());if(t.attributes)for(var s=t.attributes,n=0;n<s.length;n++)i.attr(s[n].nodeName,s[n].value);return i})},ucfirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},removeFromArrayByValue:function(t,e){for(var i,s=arguments,n=s.length;n>1&&t.length;)for(e=s[--n];-1!==(i=t.indexOf(e));)t.splice(i,1);return t},removeEmptyAttr:function(t,e){var i=$R.dom(t);return void 0===i.attr(e)||null===i.attr(e)||""===i.attr(e)&&(i.removeAttr(e),!0)},cloneAttributes:function(t,e){t=$R.dom(t).get(),e=$R.dom(e);for(var i=t.attributes,s=i.length;s--;){var n=i[s];e.attr(n.name,n.value)}return e},toParams:function(t){if("object"!=typeof t)return t;var e=Object.keys(t);if(!e.length)return"";for(var i="",s=0;s<e.length;s++){var n=e[s];i+=n+":"+t[n]+";"}return i},styleToObj:function(t){var e={};if(t)for(var i=t.replace(/;$/,"").split(";"),s=0;s<i.length;s++){var n=i[s].split(":");e[n[0].trim()]=n[1].trim()}return e},checkProperty:function(t){for(var e=arguments[1]&&Array.isArray(arguments[1])?arguments[1]:[].slice.call(arguments,1),i=0;i<e.length;i++){if(!t||void 0===t[e[i]])return!1;t=t[e[i]]}return t},extendData:function(t,e){for(var i in e){if("elements"===i)$R.dom(e[i]).each(function(e){var i=$R.dom(e);if("FORM"===e.tagName){var s=i.serialize(!0);for(var n in s)t=this._setData(t,n,s[n])}else{var o=i.attr("name")?i.attr("name"):i.attr("id");t=this._setData(t,o,i.val())}}.bind(this));else t=this._setData(t,i,e[i])}return t},_setData:function(t,e,i){return t instanceof FormData?t.append(e,i):t[e]=i,t},normalizeTextNodes:function(t){(t=$R.dom(t).get())&&t.normalize()},isRgb:function(t){return 0===t.search(/^rgb/i)},rgb2hex:function(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""},hex2long:function(t){return-1!==t.search(/^#/)&&4===t.length&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),t},escapeRegExp:function(t){return t.replace(/[-\/\\^$*~+?.()|[\]{}]/g,"\\$&")},getRandomId:function(){for(var t="",e="abcdefghijklmnopqrstuvwxyz0123456789",i=0;i<12;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},_getFirst:function(t){return 0!==t.length&&t[0]},_getLast:function(t){return 0!==t.length&&t[t.length-1]}}),$R.add("service","progress",{init:function(t){this.app=t,this.$box=null,this.$bar=null},show:function(){this._is()||this._build(),this.$box.show()},hide:function(){this._is()&&this.animate.start(this.$box,"fadeOut",this._destroy.bind(this))},update:function(t){this.show(),this.$bar.css("width",t+"%")},_is:function(){return null!==this.$box},_build:function(){this.$bar=$R.dom("<span />"),this.$box=$R.dom('<div id="redactor-progress" />'),this.$box.append(this.$bar),this.$body.append(this.$box)},_destroy:function(){this._is()&&this.$box.remove(),this.$box=null,this.$bar=null}}),$R.add("module","starter",{init:function(t){this.app=t,this.opts=t.opts,this.plugin=t.plugin,this.module=t.module},onstart:function(){this._startStop("start",this.app,["element","container","source","editor","statusbar","toolbar"]),this._startStop("start",this.module,["element","container","source","editor","statusbar","contextbar","input"])},onstop:function(){this._startStop("stop",this.module,["observer","element","container","source","editor","contextbar"])},onenable:function(){var t=this.opts.plugins;this._startStop("start",this.module,["observer","toolbar"]),this._startStop("start",this.plugin,t)},ondisable:function(){var t=this.opts.plugins;this._startStop("stop",this.module,["observer","toolbar"]),this._startStop("stop",this.plugin,t)},_startStop:function(t,e,i){for(var s=0;s<i.length;s++)void 0!==e[i[s]]&&this.app.callInstanceMethod(e[i[s]],t)}}),$R.add("module","element",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.namespace=t.namespace,this.element=t.element,this.rootOpts=$R.extend({},!0,$R.options,t.rootOpts)},start:function(){this._build(),this._buildModes(),this._buildMarkup()},stop:function(){this.element.getElement().removeData(this.namespace+"-uuid")},_build:function(){this.element.getElement().data(this.namespace+"-uuid",this.uuid)},_buildModes:function(){var t=this.element.getType();"inline"===t&&this._redefineOptions(this.opts.modes.inline),"div"===t&&this._redefineOptions(this.opts.modes.original),"inline"!==t&&(this._isRootOption("styles")&&this.rootOpts.styles&&(this.opts.styles=!0),this._isRootOption("source")&&!this.rootOpts.source&&(this.opts.showSource=!1))},_buildMarkup:function(){"inline"===this.element.getType()?this.opts.emptyHtml="":this.opts.breakline?(this.opts.markup="div",this.opts.emptyHtml='<div data-redactor-tag="br">'+this.opts.markerChar+"</div>"):this.opts.emptyHtml="<"+this.opts.markup+"></"+this.opts.markup+">"},_redefineOptions:function(t){for(var e in t)this.opts[e]=t[e]},_isRootOption:function(){return void 0!==this.rootOpts.styles}}),$R.add("module","editor",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.editor=t.editor,this.source=t.source,this.element=t.element,this.component=t.component,this.container=t.container,this.inspector=t.inspector,this.autoparser=t.autoparser,this.placeholder=!1,this.events=!1},onenable:function(){this.enable()},ondisable:function(){this.disable()},onenablefocus:function(){this._enableFocus()},oncontextmenu:function(t){this.component.setOnEvent(t,!0)},onclick:function(t){this.component.setOnEvent(t)},onkeyup:function(t){this.inspector.parse(t.target).isComponent()||this.component.clearActive()},onenablereadonly:function(){this._enableReadOnly()},ondisablereadonly:function(){this._disableReadOnly()},onautoparseobserve:function(){this.autoparser.observe()},onplaceholder:{build:function(){this._buildPlaceholder()},toggle:function(){this._togglePlacehodler()}},start:function(){this._build(),this._buildEvents(),this._buildOptions(),this._buildAccesibility()},stop:function(){var t=this.editor.getElement(),e=this.container.getElement(),i=["redactor-in","redactor-in-"+this.uuid,"redactor-structure","redactor-placeholder","notranslate",this.opts.stylesClass];t.removeAttr("spellcheck"),t.removeAttr("dir"),t.removeAttr("contenteditable"),t.removeAttr("placeholder"),t.removeAttr("data-gramm_editor"),t.removeClass(i.join(" ")),e.removeClass(["redactor-focus","redactor-blur","redactor-over","redactor-styles-on","redactor-styles-off","redactor-toolbar-on","redactor-text-labeled-on","redactor-source-view"].join(" ")),this._destroyEvents(),0===t.get().classList.length&&t.removeAttr("class")},enable:function(){var t=this.editor.getElement(),e=this.container.getElement();t.addClass("redactor-in redactor-in-"+this.uuid),t.attr({contenteditable:!0}),this.opts.structure&&t.addClass("redactor-structure"),!this.opts.toolbar||this.opts.air||this.opts.toolbarExternal||e.addClass("redactor-toolbar-on"),this._disableBrowsersEditing()},disable:function(){var t=this.editor.getElement(),e=this.container.getElement();t.removeClass("redactor-in redactor-in-"+this.uuid),t.removeClass("redactor-structure"),t.removeAttr("contenteditable"),e.addClass("redactor-toolbar-on")},_build:function(){var t=this.editor.getElement(),e=this.element.getElement(),i=this.container.getElement();i.addClass("redactor-blur"),this.opts.grammarly||t.attr("data-gramm_editor",!1),this.opts.notranslate&&t.addClass("notranslate"),this.opts.styles?(t.addClass(this.opts.stylesClass),i.addClass("redactor-styles-on")):i.addClass("redactor-styles-off"),this.opts.buttonsTextLabeled&&i.addClass("redactor-text-labeled-on"),this.element.isType("textarea")&&e.before(t)},_buildEvents:function(){this.events=$R.create("editor.events",this.app)},_buildOptions:function(){var t=this.editor.getElement();t.attr("dir",this.opts.direction),this.opts.tabindex&&t.attr("tabindex",this.opts.tabindex),this.opts.minHeight&&t.css("min-height",this.opts.minHeight),this.opts.maxHeight&&t.css("max-height",this.opts.maxHeight),this.opts.maxWidth&&t.css({"max-width":this.opts.maxWidth,margin:"auto"})},_buildAccesibility:function(){this.editor.getElement().attr({"aria-labelledby":"redactor-voice-"+this.uuid,role:"presentation"})},_buildPlaceholder:function(){this.placeholder=$R.create("editor.placeholder",this.app)},_enableFocus:function(){this.opts.showSource?this._enableFocusSource():this._enableFocusEditor()},_enableFocusSource:function(){var t=this.source.getElement();this.opts.focus?(t.focus(),t.get().setSelectionRange(0,0)):this.opts.focusEnd&&t.focus()},_enableFocusEditor:function(){this.opts.focus?setTimeout(this.editor.startFocus.bind(this.editor),100):this.opts.focusEnd&&setTimeout(this.editor.endFocus.bind(this.editor),100)},_togglePlacehodler:function(){this.placeholder&&this.placeholder.toggle()},_disableBrowsersEditing:function(){try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1),document.execCommand("AutoUrlDetect",!1,!1);var t=this.editor.getElement().get();t.addEventListener?t.addEventListener("mscontrolselect",function(t){t.preventDefault()}):t.attachEvent("oncontrolselect",function(t){t.returnValue=!1})}catch(t){}},_destroyEvents:function(){this.events&&this.events.destroy()},_enableReadOnly:function(){var t=this.editor.getElement();this._getEditables(t).removeAttr("contenteditable"),t.removeAttr("contenteditable"),t.addClass("redactor-read-only"),this.events&&this.events.destroy()},_disableReadOnly:function(){var t=this.editor.getElement();this._getEditables(t).attr({contenteditable:!0}),t.removeClass("redactor-read-only"),t.attr({contenteditable:!0}),this._buildEvents()},_getEditables:function(t){return t.find("figcaption, td, th")}}),$R.add("class","editor.placeholder",{init:function(t){this.app=t,this.opts=t.opts,this.editor=t.editor,this.element=t.element,this.build()},build:function(){var t=this.element.getElement(),e=this.editor.getElement();if(!1!==this.opts.placeholder||t.attr("placeholder")){var i=!1!==this.opts.placeholder?this.opts.placeholder:t.attr("placeholder");e.attr("placeholder",i),this.toggle()}},toggle:function(){return this.editor.isEmpty(!0)?this.show():this.hide()},show:function(){this.editor.getElement().addClass("redactor-placeholder")},hide:function(){this.editor.getElement().removeClass("redactor-placeholder")}}),$R.add("class","editor.events",{init:function(t){this.app=t,this.opts=t.opts,this.$doc=t.$doc,this.uuid=t.uuid,this.source=t.source,this.editor=t.editor,this.cleaner=t.cleaner,this.container=t.container,this.insertion=t.insertion,this.inspector=t.inspector,this.selection=t.selection,this.component=t.component,this.blurNamespace=".redactor-blur."+this.uuid,this.eventsList=["paste","click","contextmenu","keydown","keyup","mouseup","touchstart","cut","copy","dragenter","dragstart","drop","dragover","dragleave"],this._init()},destroy:function(){this.editor.getElement().off(".redactor-focus"),this.$doc.off("keyup"+this.blurNamespace+" mousedown"+this.blurNamespace),this._loop("off")},focus:function(t){var e=this.container.getElement();this.editor.isPasting()||e.hasClass("redactor-focus")||(e.addClass("redactor-focus"),e.removeClass("redactor-blur"),this.app.broadcast("observe",t),this.app.broadcast("focus",t),this.isFocused=!0,this.isBlured=!1)},blur:function(t){var e=this.container.getElement(),i=$R.dom(t.target),s=[".redactor-in-"+this.uuid,".redactor-toolbar",".redactor-dropdown",".redactor-context-toolbar","#redactor-modal","#redactor-image-resizer"];this.app.broadcast("originalblur",t),this.app.stopBlur||this.app.isStarted()&&!this.editor.isPasting()&&0===i.closest(s.join(",")).length&&(this.isBlured||e.hasClass("redactor-blur")||(e.removeClass("redactor-focus"),e.addClass("redactor-blur"),this.app.broadcast("blur",t),this.isFocused=!1,this.isBlured=!0))},cut:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);this.app.broadcast("state",t),this.component.isNonEditable(e)&&(this._passSelectionToClipboard(t,i,!0),t.preventDefault())},copy:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);this.app.broadcast("state",t),this.component.isNonEditable(e)&&(this._passSelectionToClipboard(t,i,!1),t.preventDefault())},drop:function(t){if((t=t.originalEvent||t).stopPropagation(),this._removeOverClass(),!1!==this.opts.dragUpload){if(this.app.isDragComponentInside()){var e=$R.dom(this.app.getDragComponentInside()),i=e.clone(!0);return this.insertion.insertToPoint(t,i),e.remove(),this.app.setDragComponentInside(!1),this.app.broadcast("state",t),this.app.broadcast("drop",t),this.app.broadcast("image.observe",t),void t.preventDefault()}if(this.app.isDragInside()&&this.opts.input){this.insertion.insertPoint(t);var s=t.dataTransfer.getData("text/html"),n=this.selection.getRange();if(n){var o=this.selection.getBlocks();n.deleteContents();for(var r=0;r<o.length;r++)""===o[r].innerHTML&&$R.dom(o[r]).remove()}return $R.create("input.paste",this.app,t,!0,s,!0),this.app.broadcast("state",t),this.app.broadcast("drop",t),this.app.setDragInside(!1),void t.preventDefault()}this.app.broadcast("state",t),this.app.broadcast("paste",t,t.dataTransfer),this.app.broadcast("drop",t)}else t.preventDefault()},dragenter:function(t){t.preventDefault()},dragstart:function(t){this.app.setDragComponentInside(!1),this.app.setDragInside(!1);var e=this.inspector.parse(t.target);!e.isComponent()||e.isComponentEditable()||e.isFigcaption()?this.selection.is()&&!this.selection.isCollapsed()&&(this.app.setDragInside(!0),this._setDragData(t)):this.app.setDragComponentInside(e.getComponent()),this.app.broadcast("dragstart",t)},dragover:function(t){this.app.broadcast("dragover",t)},dragleave:function(t){this.app.broadcast("dragleave",t)},paste:function(t){this.app.broadcast("paste",t)},contextmenu:function(t){},click:function(t){if(3===t.detail){t.preventDefault();var e=this.selection.getBlock(),i=document.createRange();i.selectNodeContents(e),this.selection.setRange(i)}var s=$R.dom(t.target);if(s.hasClass("redactor-in")){var n=s.offset().top,o=parseFloat(s.css("padding-bottom"));n+s.height()-2*o<t.pageY&&this.app.broadcast("bottomclick",t)}this.app.broadcast("state",t),this.app.broadcast("click",t)},keydown:function(t){if(this.app.broadcast("state",t),!1===this.app.broadcast("keydown",t))return t.preventDefault()},keyup:function(t){this.app.broadcast("keyup",t)},mouseup:function(t){this.app.broadcast("observe",t),this.app.broadcast("state",t)},touchstart:function(t){this.app.broadcast("observe",t),this.app.broadcast("state",t)},_init:function(){this.editor.getElement().on("focus.redactor-focus click.redactor-focus",this.focus.bind(this)),this.$doc.on("keyup"+this.blurNamespace+" mousedown"+this.blurNamespace,this.blur.bind(this)),this._loop("on")},_removeOverClass:function(){this.editor.getElement().removeClass("over")},_loop:function(t){for(var e=this.editor.getElement(),i=0;i<this.eventsList.length;i++){var s=this.eventsList[i]+".redactor-events",n=this.eventsList[i];e[t](s,this[n].bind(this))}},_passAllToClipboard:function(t){var e=t.clipboardData,i=this.source.getCode();e.setData("text/html",i),e.setData("text/plain",i.toString().replace(/\n$/,""))},_passSelectionToClipboard:function(t,e,i){var s=t.clipboardData,n=e.getComponent(),o=$R.dom(n).clone();o.find(".redactor-component-caret").remove(),o.removeClass("redactor-component-active"),o.removeAttr("contenteditable"),o.removeAttr("tabindex");var r=o.get().outerHTML;i&&this.component.remove(n),s.setData("text/html",r),s.setData("text/plain",r.toString().replace(/\n$/,""))},_setDragData:function(t){var e=(t=t.originalEvent||t).dataTransfer;e.effectAllowed="move",e.setData("text/Html",this.selection.getHtml())}}),$R.add("module","container",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.lang=t.lang,this.element=t.element,this.container=t.container},start:function(){this._build(),this._buildAccesibility()},stop:function(){var t=this.element.getElement(),e=this.container.getElement();e.after(t),e.remove(),t.show()},_build:function(){var t=this.element.getElement(),e=this.container.getElement();e.addClass("redactor-box"),e.attr("dir",this.opts.direction),this.element.isType("inline")&&e.addClass("redactor-inline"),t.after(e),e.append(t)},_buildAccesibility:function(){var t=this.container.getElement(),e=$R.dom("<span />");e.addClass("redactor-voice-label"),e.attr({id:"redactor-voice-"+this.uuid,"aria-hidden":!1}),e.html(this.lang.get("accessibility-help-label")),t.prepend(e)}}),$R.add("module","source",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.utils=t.utils,this.element=t.element,this.source=t.source,this.editor=t.editor,this.toolbar=t.toolbar,this.cleaner=t.cleaner,this.component=t.component,this.container=t.container,this.autoparser=t.autoparser,this.selection=t.selection,this.syncedHtml=""},onstartcode:function(){var t=this.source.getStartedContent(),e=this.editor.getElement(),i=this.source.getElement();this.opts.autoparse&&this.opts.autoparseStart&&(t=this.autoparser.parse(t));var s=this.cleaner.input(t,!0,!0),n=this.cleaner.output(s);e.html(s),i.val(n),this.syncedHtml=n,this.app.broadcast("placeholder.build"),this.app.broadcast("autoparseobserve"),this.component.executeScripts()},onstartcodeshow:function(){this.show()},ontrytosync:function(){this.sync()},onhardsync:function(){var t=this.editor.getElement().html();t=this.app.broadcast("syncBefore",t),t=this.cleaner.output(t),this._syncing(t)},start:function(){this._build(),this._buildClasses()},stop:function(){var t=this.element.getElement(),e=this.source.getElement();t.removeClass("redactor-source redactor-source-open"),e.off("input.redactor-source"),e.removeAttr("data-gramm_editor"),0===e.get().classList.length&&e.removeAttr("class"),this.source.isNameGenerated()||t.removeAttr("name"),this.element.isType("textarea")||e.remove()},getCode:function(){return this.source.getCode()},toggle:function(){if(this.opts.source)return this.source.getElement().hasClass("redactor-source-open")?this.hide():this.show()},show:function(){if(this.opts.source){var t=this.editor.getElement(),e=this.source.getElement(),i=this.container.getElement(),s=e.val();this.app.isStarted()&&(s=this.app.broadcast("source.open",s));var n=t.height();if(t.hide(),e.height(n),e.val(s.trim()),e.show(),e.addClass("redactor-source-open"),e.on("input.redactor-source-events",this._onChangedSource.bind(this)),e.on("keydown.redactor-source-events",this._onTabKey.bind(this)),e.on("focus.redactor-source-events",this._onFocus.bind(this)),this.opts.source.hasOwnProperty("codemirror")){var o="object"==typeof this.opts.source.codemirror?this.opts.source.codemirror:{};this.codemirror=CodeMirror.fromTextArea(e.get(),o)}else i.addClass("redactor-source-view");setTimeout(function(){this._disableButtons(),this._setActiveSourceButton()}.bind(this),100),this.app.isStarted()&&this.app.broadcast("source.opened")}},hide:function(){if(this.opts.source){var t=this.editor.getElement(),e=this.source.getElement(),i=this.container.getElement(),s=e.val();this.opts.source.hasOwnProperty("codemirror")&&(s=this.codemirror.getValue(),this.codemirror.toTextArea()),s=this.cleaner.input(s,!0),s=this.utils.isEmptyHtml(s)?this.opts.emptyHtml:s,s=this.app.broadcast("source.close",s),this._enableButtons(),this._setInactiveSourceButton(),e.hide(),e.removeClass("redactor-source-open"),e.off(".redactor-source-events"),t.show(),t.html(s),i.removeClass("redactor-source-view"),setTimeout(function(){this.editor.startFocus(),this.component.executeScripts()}.bind(this),0),this.app.broadcast("source.closed")}},sync:function(){var t=this,e=this.editor.getElement().html();e=this.app.broadcast("syncBefore",e),e=this.cleaner.output(e),this._isSync(e)&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){t._syncing(e)},200))},_build:function(){var t=this.source.getElement(),e=this.element.getElement();t.hide(),this.opts.grammarly||t.attr("data-gramm_editor",!1),this.element.isType("textarea")||e.after(t)},_buildClasses:function(){this.source.getElement().addClass("redactor-source")},_syncing:function(t){t=this.app.broadcast("syncing",t),this.source.getElement().val(t),this.app.broadcast("synced",t),this.app.broadcast("changed",t)},_isSync:function(t){return this.syncedHtml!==t&&(this.syncedHtml=t,!0)},_onChangedSource:function(){var t=this.source.getElement().val();this.app.broadcast("changed",t),this.app.broadcast("source.changed",t)},_onTabKey:function(t){if(9!==t.keyCode)return!0;t.preventDefault();var e=this.source.getElement(),i=e.get(),s=i.selectionStart;e.val(e.val().substring(0,s)+"    "+e.val().substring(i.selectionEnd)),i.selectionStart=i.selectionEnd=s+4},_onFocus:function(){this.app.broadcast("sourcefocus")},_disableButtons:function(){this.toolbar.disableButtons()},_enableButtons:function(){this.toolbar.enableButtons()},_setActiveSourceButton:function(){var t=this.toolbar.getButton("html");t.enable(),t.setActive()},_setInactiveSourceButton:function(){this.toolbar.getButton("html").setInactive()}}),$R.add("module","observer",{init:function(t){this.app=t,this.editor=t.editor,this.observerUnit=!1},start:function(){if(window.MutationObserver){var t=this.editor.getElement().get();this.observerUnit=this._build(t),this.observerUnit.observe(t,{attributes:!0,subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0})}},stop:function(){this.observerUnit&&this.observerUnit.disconnect()},_build:function(t){var e=this;return new MutationObserver(function(i){e._observe(i[i.length-1],t)})},_observe:function(t,e){this.app.isReadOnly()||"attributes"===t.type&&t.target===e||(this.app.broadcast("observe"),this.app.broadcast("trytosync"),this.app.broadcast("placeholder.toggle"))}}),$R.add("module","clicktoedit",{init:function(t){this.app=t,this.opts=t.opts,this.source=t.source,this.editor=t.editor,this.container=t.container,this.selection=t.selection},onstartclicktoedit:function(){this.start()},onenablereadonly:function(){this._isEnabled()||this.stop()},ondisablereadonly:function(){this._isEnabled()||this.start()},onstop:function(){this.stop()},start:function(){this._build()},stop:function(){this.buttonSave&&this.buttonSave.stop(),this.buttonCancel&&this.buttonCancel.stop(),this._destroy(),this.app.broadcast("disable")},enable:function(){this.app.broadcast("clickStart");var t=this.editor.isEmpty();t||this.selection.saveMarkers(),this._setFocus(),this._destroy(),this.app.broadcast("enable"),this.buttonSave.enable(),this.buttonCancel.enable(),t||this.selection.restoreMarkers(),t&&this.editor.focus(),this.container.getElement().addClass("redactor-clicktoedit-enabled"),this.source.rebuildStartedContent(),this.app.broadcast("startcode"),this.app.broadcast("image.observe")},save:function(t){t&&t.preventDefault();var e=this.source.getCode();this.app.broadcast("disable"),this.app.broadcast("clickSave",e),this.app.broadcast("clickStop"),this._build()},cancel:function(t){t&&t.preventDefault();var e=this.saved;this.editor.getElement().html(e),this.saved="",this.app.broadcast("disable"),this.app.broadcast("clickCancel",e),this.app.broadcast("clickStop"),this._build()},_build:function(){this.buttonSave=$R.create("clicktoedit.button","save",this.app,this),this.buttonCancel=$R.create("clicktoedit.button","cancel",this.app,this),this.buttonSave.stop(),this.buttonCancel.stop();var t=this.editor.getElement(),e=this.container.getElement();t.on("click.redactor-click-to-edit mouseup.redactor-click-to-edit",this.enable.bind(this)),e.addClass("redactor-over"),e.removeClass("redactor-clicktoedit-enabled")},_isEnabled:function(){return this.container.getElement().hasClass("redactor-clicktoedit-enabled")},_destroy:function(){var t=this.editor.getElement(),e=this.container.getElement();t.off(".redactor-click-to-edit"),e.removeClass("redactor-over redactor-clicktoedit-enabled")},_setFocus:function(){this.saved=this.source.getCode(),this.buttonSave.start(),this.buttonCancel.start()}}),$R.add("class","clicktoedit.button",{init:function(t,e,i){this.app=e,this.opts=e.opts,this.toolbar=e.toolbar,this.context=i,this.type=t,this.name="save"===t?"clickToSave":"clickToCancel",this.objected=!1,this.enabled=!1,this.namespace=".redactor-click-to-edit",this._build()},enable:function(){if(this.objected){var t=this.opts[this.name];t.api="module.clicktoedit."+this.type,this.toolbar.addButton(this.type,t),this.enabled=!0}},start:function(){this.objected||(this.$button.off(this.namespace),this.$button.show(),this.$button.on("click"+this.namespace,this.context[this.type].bind(this.context)))},stop:function(){!this.objected&&this.enabled&&this.$button.hide()},_build:function(){this.objected="object"==typeof this.opts[this.name],this.objected||(this.$button=$R.dom(this.opts[this.name]),this.enabled=!0)}}),$R.add("module","statusbar",{init:function(t){this.app=t,this.opts=t.opts,this.element=t.element,this.statusbar=t.statusbar,this.container=t.container},start:function(){if(!this.element.isType("inline")){var t=this.statusbar.getElement(),e=this.container.getElement();t.addClass("redactor-statusbar"),e.append(t)}}}),$R.add("module","contextbar",{init:function(t){this.app=t,this.opts=t.opts,this.uuid=t.uuid,this.$win=t.$win,this.$doc=t.$doc,this.$body=t.$body,this.editor=t.editor,this.toolbar=t.toolbar,this.detector=t.detector,this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body},onenablereadonly:function(){this.stop()},ondisablereadonly:function(){this.start()},oncontextbar:{close:function(){this.close()}},start:function(){if(this.opts.toolbarContext){var t=this.editor.getElement();this._build(),t.on("click.redactor-context mouseup.redactor-context",this.open.bind(this)),this.opts.scrollTarget?$R.dom(this.opts.scrollTarget).on("scroll.redactor-context",this.close.bind(this)):!1!==this.opts.maxHeight&&t.on("scroll.redactor-context",this.close.bind(this))}},stop:function(){this.editor.getElement().off(".redactor-context"),this.$doc.off(".redactor-context"),this.$win.off(".redactor-context"),this.$contextbar&&this.$contextbar.remove(),this.opts.scrollTarget&&$R.dom(this.opts.scrollTarget).off(".redactor-context")},is:function(){return this.$contextbar&&this.$contextbar.hasClass("open")},set:function(t,e,i,s){for(var n in this.$contextbar.html(""),this.$el=$R.dom(e),i){var o=$R.create("contextbar.button",this.app,i[n]);""!==o.html()&&this.$contextbar.append(o)}var r=this._buildPosition(t,this.$el,s);this.$contextbar.css(r),this.$contextbar.show(),this.$contextbar.addClass("open"),this.$doc.on("click.redactor-context mouseup.redactor-context",this.close.bind(this)),this.$win.on("resize.redactor-context",this.close.bind(this))},open:function(t){setTimeout(function(){this.app.broadcast("contextbar",t,this)}.bind(this),0)},close:function(t){if(this.$contextbar){if(t){var e=$R.dom(t.target);if(this.$el&&0!==e.closest(this.$el).length)return}this.$contextbar.hide(),this.$contextbar.removeClass("open"),this.$doc.off(".redactor.context")}},_build:function(){this.$contextbar=$R.dom("<div>"),this.$contextbar.attr("id","redactor-context-toolbar-"+this.uuid),this.$contextbar.attr("dir",this.opts.direction),this.$contextbar.addClass("redactor-context-toolbar"),this.$contextbar.hide(),this.$target.append(this.$contextbar)},_buildPosition:function(t,e,i){var s,n,o=this.toolbar.isTarget(),r=o?e.position():e.offset(),a=e.width(),l=e.height(),h=this.$contextbar.width(),c=this.$contextbar.height(),d=o?this.$target.scrollTop()+this.$doc.scrollTop():this.$doc.scrollTop(),u=this.$target.offset(),p=o?u.left:0,f=o?u.top:0;return i?"top"===i?(s=r.top-c,n=r.left+a/2-h/2):"bottom"===i&&(s=r.top+l,n=r.left+a/2-h/2):(s=t.clientY+d-c,n=t.clientX-h/2),n<0&&(n=0),{top:s-f+"px",left:n-p+"px"}}}),$R.add("class","contextbar.button",{mixins:["dom"],init:function(t,e){this.app=t,this.obj=e,this._init()},_init:function(){this.parse("<a>"),"string"!=typeof this.obj.title?(this.attr("target","_blank"),this.attr("href",this.obj.title.attr("href")),this.html(this.obj.html||this.obj.title.attr("href"))):(this.attr("href","#"),this._buildTitle(),this._buildMessage())},_buildTitle:function(){this.html(this.obj.title)},_buildMessage:function(){void 0===this.obj.message&&void 0===this.obj.api||this.on("click",this._toggle.bind(this))},_toggle:function(t){t.preventDefault(),this.obj.message?this.app.broadcast(this.obj.message,this.obj.args):this.obj.api&&this.app.api(this.obj.api,this.obj.args)}}),$R.add("module","toolbar",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.utils=t.utils,this.toolbar=t.toolbar,this.buttons=[],this.toolbarModule=!1},onsource:{open:function(){!this.toolbar.isAir()&&this.toolbar.isFixed()&&this.toolbarModule.resetPosition()},opened:function(){this.toolbar.isAir()&&this.toolbarModule&&this.toolbarModule.createSourceHelper(),setTimeout(function(){$R.dom(".re-button-tooltip-"+this.uuid).remove()}.bind(this),100)},close:function(){this.toolbar.isAir()&&this.toolbarModule&&this.toolbarModule.destroySourceHelper()},closed:function(){this.toolbar.is()&&this.opts.air&&this.toolbarModule.openSelected()}},onobserve:function(){this.toolbar.is()&&this.toolbar.observe()},onfocus:function(){this._setExternalOnFocus()},onsourcefocus:function(){this._setExternalOnFocus()},onempty:function(){this.toolbar.isFixed()&&this.toolbarModule.resetPosition()},onenablereadonly:function(){this.toolbar.isAir()&&this.toolbarModule.close()},start:function(){this.toolbar.is()&&(this._buildButtons(),this._initToolbar(),this._initButtons())},stop:function(){this.toolbarModule&&this.toolbarModule.stop(),$R.dom(".redactor-dropdown-"+this.uuid).remove()},_buildButtons:function(){this.buttons=this.opts.buttons.concat(),this._buildImageButton(),this._buildFileButton(),this._buildSourceButton(),this._buildAdditionalButtons(),this._buildHiddenButtons()},_buildImageButton:function(){this.opts.imageUpload||this.utils.removeFromArrayByValue(this.buttons,"image")},_buildFileButton:function(){this.opts.fileUpload||this.utils.removeFromArrayByValue(this.buttons,"file")},_buildSourceButton:function(){this.opts.source||this.utils.removeFromArrayByValue(this.buttons,"html")},_buildAdditionalButtons:function(){var t,e;if(0!==this.opts.buttonsAdd.length&&(this.opts.buttonsAdd=this._removeExistButtons(this.opts.buttonsAdd),this.buttons=this.buttons.concat(this.opts.buttonsAdd)),0!==this.opts.buttonsAddFirst.length&&(this.opts.buttonsAddFirst=this._removeExistButtons(this.opts.buttonsAddFirst),this.buttons.unshift(this.opts.buttonsAddFirst)),!1!==this.opts.buttonsAddAfter){t=this.buttons.indexOf(this.opts.buttonsAddAfter.after)+1,e=this.opts.buttonsAddAfter.buttons;for(var i=0;i<e.length;i++)this.buttons.splice(t+i,0,e[i])}if(!1!==this.opts.buttonsAddBefore){t=this.buttons.indexOf(this.opts.buttonsAddBefore.before)+1,e=this.opts.buttonsAddBefore.buttons;for(i=0;i<e.length;i++)this.buttons.splice(t-(1-i),0,e[i])}},_buildHiddenButtons:function(){if(0!==this.opts.buttonsHide.length)for(var t=this.opts.buttonsHide,e=0;e<t.length;e++)this.utils.removeFromArrayByValue(this.buttons,t[e])},_removeExistButtons:function(t){for(var e=0;e<t.length;e++)-1!==this.opts.buttons.indexOf(t[e])&&this.utils.removeFromArrayByValue(t,t[e]);return t},_setExternalOnFocus:function(){!this.opts.air&&this.opts.toolbarExternal&&this.toolbarModule.setExternal()},_initToolbar:function(){this.toolbarModule=this.opts.air?$R.create("toolbar.air",this.app):$R.create("toolbar.standard",this.app)},_initButtons:function(){this.toolbar.setButtons(this.buttons);for(var t=0;t<this.buttons.length;t++){var e=this.buttons[t];$R.buttons[e]&&this.toolbar.addButton(e,$R.buttons[e],!1,!1,!0)}}}),$R.add("class","toolbar.air",{init:function(t){this.app=t,this.uuid=t.uuid,this.$doc=t.$doc,this.$win=t.$win,this.utils=t.utils,this.editor=t.editor,this.animate=t.animate,this.toolbar=t.toolbar,this.container=t.container,this.inspector=t.inspector,this.selection=t.selection,this.clicks=0,this._init()},stop:function(){this.toolbar.getWrapper().remove(),this.editor.getElement().off(".redactor-air-trigger-"+this.uuid),this.$doc.off(".redactor-air-"+this.uuid),this.$doc.off(".redactor-air-trigger-"+this.uuid),this.toolbar.stopObservers()},createSourceHelper:function(){this.$airHelper=$R.dom("<span>"),this.$airHelper.addClass("redactor-air-helper"),this.$airHelper.html('<i class="re-icon-html"></i>'),this.$airHelper.on("click",function(t){t.preventDefault(),this.app.api("module.source.hide")}.bind(this)),this.container.getElement().append(this.$airHelper)},destroySourceHelper:function(){this.$airHelper&&this.$airHelper.remove()},openSelected:function(){setTimeout(function(){this._isSelection()&&this._open(!1)}.bind(this),0)},close:function(){this.$doc.off(".redactor-air-"+this.uuid);var t=this.toolbar.getElement();t.removeClass("open"),t.hide()},_init:function(){this.toolbar.create();var t=this.toolbar.getWrapper(),e=this.toolbar.getElement(),i=this.editor.getElement(),s=this.container.getElement();t.addClass("redactor-toolbar-wrapper-air"),e.addClass("redactor-air"),e.hide(),t.append(e),s.prepend(t),this.openSelected(),this.$doc.on("mouseup.redactor-air-trigger-"+this.uuid,this._open.bind(this)),i.on("keyup.redactor-air-trigger-"+this.uuid,this._openCmd.bind(this))},_isSelection:function(){return this.selection.is()&&!this.selection.isCollapsed()},_isOpened:function(){return this.toolbar.getElement().hasClass("open")},_open:function(t){var e=!!t&&t.target,i=!!t&&$R.dom(t.target),s=this.inspector.parse(e),n=s.isComponent()&&!s.isComponentType("table"),o=s.isFigcaption(),r=i&&0!==i.closest(".redactor-modal").length,a=t&&0!==i.closest(".re-button").length;if(!(t&&0!==i.closest(".redactor-dropdown").length||a||r||o||n||this.toolbar.isContextBar())&&this._isSelection()){var l=this.selection.getPosition();setTimeout(function(){this.app.isReadOnly()||this._isSelection()&&this._doOpen(l)}.bind(this),1)}},_openCmd:function(){if(this.selection.isAll()){var t=this.toolbar.getElement(),e=this.selection.getPosition();e.top=e.top<20?0:e.top-t.height(),e.height=0,this._doOpen(e)}},_doOpen:function(t){var e=this.toolbar.getWrapper(),i=this.toolbar.getElement(),s=this.container.getElement().offset(),n=0,o=this.$win.width(),r=i.width();o<t.left+r&&(n=r-this.selection.getPosition().width);e.css({left:t.left-s.left-n+"px",top:t.top-s.top+t.height+this.$doc.scrollTop()+"px"}),this.app.broadcast("airOpen"),i.addClass("open"),i.show(),this.$doc.on("click.redactor-air-"+this.uuid,this._close.bind(this)),this.$doc.on("keydown.redactor-air-"+this.uuid,this._close.bind(this)),this.app.broadcast("airOpened")},_close:function(t){var e=!!t&&$R.dom(t.target),i=t&&0!==e.closest("[data-dropdown], .redactor-dropdown-not-close").length;(!i&&t&&0!==e.closest(".re-button").length||!i&&this._isOpened())&&(this.app.broadcast("airClose"),this.close(),this.app.broadcast("airClosed"))}}),$R.add("class","toolbar.fixed",{init:function(t){this.app=t,this.uuid=t.uuid,this.opts=t.opts,this.$doc=t.$doc,this.$win=t.$win,this.editor=t.editor,this.toolbar=t.toolbar,this.detector=t.detector,this.container=t.container,this._init()},stop:function(){this.$fixedTarget.off(".redactor-toolbar-"+this.uuid),this.$win.off(".redactor-toolbar-"+this.uuid)},reset:function(){var t=this.toolbar.getElement();this.toolbar.getWrapper().css("height",""),t.removeClass("redactor-toolbar-fixed"),t.css({position:"",top:"",left:"",width:""});var e=this.toolbar.getDropdown();e&&e.updatePosition()},_init:function(){this.$fixedTarget=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$win,this._doFixed(),this.toolbar.isTarget()&&(this.$win.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$win.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))),this.$fixedTarget.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$fixedTarget.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))},_doFixed:function(){var t=this.editor.getElement(),e=this.container.getElement(),i=this.toolbar.getElement(),s=this.toolbar.getWrapper();if(!this.editor.isSourceMode()&&0===e.parents().filter(function(t){return"none"===getComputedStyle(t,null).display&&t}).length){var n=t.height()<100,o=this.editor.isEmpty();if(n||o)this.reset();else if(!this.editor.isSourceMode()){var r=i.height(),a=(this.toolbar.isTarget()?e.position():e.offset()).top,l=a+e.height()-60,h=this.$fixedTarget.scrollTop()+this.opts.toolbarFixedTopOffset,c=this.toolbar.isTarget()?this.$fixedTarget.offset().top-this.$win.scrollTop():0;if(this.toolbar.isTarget()&&"fixed"===this.$fixedTarget.css("position")){var d=this.$fixedTarget.hasClass("modal")&&this.$fixedTarget.hasClass("fade")?e.closest(".modal-dialog").position().top:0;c=this.$fixedTarget.scrollTop()-d}if(h>a&&h<l){var u=this.detector.isDesktop()?"fixed":"absolute";c=this.detector.isDesktop()?c:h-a,this.detector.isMobile()&&(this.fixedScrollTimeout&&clearTimeout(this.fixedScrollTimeout),i.hide(),this.fixedScrollTimeout=setTimeout(function(){i.show()},250)),s.height(r),i.addClass("redactor-toolbar-fixed"),e.hasClass("redactor-box-fullscreen")?i.css({position:u,top:"0px",width:e.width()+"px"}):i.css({position:u,top:c+this.opts.toolbarFixedTopOffset+"px",width:e.width()+"px"});var p=this.toolbar.getDropdown();p&&p.updatePosition(),this.app.broadcast("toolbar.fixed")}else this.reset(),this.app.broadcast("toolbar.unfixed")}}}}),$R.add("class","toolbar.standard",{init:function(t){this.app=t,this.opts=t.opts,this.uuid=t.uuid,this.$body=t.$body,this.toolbar=t.toolbar,this.container=t.container,this.isExternalMultiple=!1,this.toolbarFixed=!1,this._init()},stop:function(){this.toolbar.getWrapper().remove(),this.toolbarFixed&&this.toolbarFixed.stop(),this.opts.toolbarExternal&&this._findToolbars(),this.toolbar.stopObservers(),this.$body.find(".re-button-tooltip-"+this.uuid).remove()},setExternal:function(){(this._findToolbars(),this.isExternalMultiple)&&(this.$toolbars.hide(),this.$external.find(".redactor-toolbar-external-"+this.uuid).show())},resetPosition:function(){this.toolbarFixed&&this.toolbarFixed.reset()},_init:function(){(this._build(),this.opts.toolbarExternal)?this._buildExternal():(this._buildFixed(),this.toolbar.getElement().show())},_build:function(){this.toolbar.create();var t=this.toolbar.getWrapper(),e=this.toolbar.getElement();(t.addClass("redactor-toolbar-wrapper"),e.addClass("redactor-toolbar"),e.hide(),t.append(e),this.opts.toolbarExternal)||this.container.getElement().prepend(t)},_buildExternal:function(){(this._initExternal(),this._findToolbars(),this.isExternalMultiple)?this._hideToolbarsExceptFirst():this.toolbar.getElement().show()},_buildFixed:function(){this.opts.toolbarFixed&&(this.toolbarFixed=$R.create("toolbar.fixed",this.app))},_initExternal:function(){var t=this.toolbar.getElement(),e=this.toolbar.getElement();t.addClass("redactor-toolbar-external redactor-toolbar-external-"+this.uuid),this.$external=$R.dom(this.opts.toolbarExternal),this.$external.append(e)},_findToolbars:function(){this.$toolbars=this.$external.find(".redactor-toolbar-external"),this.isExternalMultiple=this.$toolbars.length>1},_hideToolbarsExceptFirst:function(){this.$toolbars.hide(),this.$toolbars.first().show()}}),$R.add("module","line",{init:function(t){this.app=t,this.lang=t.lang,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(i.isComponentType("line")){var s=i.getComponent(),n={remove:{title:this.lang.get("delete"),api:"module.line.remove",args:s}};e.set(t,s,n,"bottom")}},insert:function(){var t=this.component.create("line");this.insertion.insertRaw(t)},remove:function(t){this.component.remove(t)}}),$R.add("class","line.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){var e,i;if(void 0!==t){var s=$R.dom(t),n=s.get();"HR"===n.tagName?i=n:"FIGURE"===n.tagName&&(e=n,i=s.find("hr").get())}this._buildWrapper(e),this._buildElement(i),this._initWrapper()},_buildElement:function(t){t?this.$element=$R.dom(t):(this.$element=$R.dom("<hr>"),this.append(this.$element))},_buildWrapper:function(t){t=t||"<figure>",this.parse(t)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"line",tabindex:"-1",contenteditable:!1})}}),$R.add("module","link",{modals:{link:'<form action="">                 <div class="form-item">                     <label for="modal-link-url">URL <span class="req">*</span></label>                     <input type="text" id="modal-link-url" name="url">                 </div>                 <div class="form-item">                     <label for="modal-link-text">## text ##</label>                     <input type="text" id="modal-link-text" name="text">                 </div>                 <div class="form-item form-item-title">                     <label for="modal-link-title">## title ##</label>                     <input type="text" id="modal-link-title" name="title">                 </div>                 <div class="form-item form-item-target">                     <label class="checkbox">                         <input type="checkbox" name="target"> ## link-in-new-tab ##                     </label>                 </div>             </form>'},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.caret=t.caret,this.utils=t.utils,this.inline=t.inline,this.editor=t.editor,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this.isCurrentLink=!1,this.currentText=!1},onmodal:{link:{open:function(t,e){this._setFormData(e,t)},opened:function(t,e){this._setFormFocus(e)},update:function(t,e){var i=e.getData();this._validateData(e,i)&&this._update(i)},insert:function(t,e){var i=e.getData();this._validateData(e,i)&&this._insert(i)},unlink:function(){this._unlink()}}},onbutton:{link:{observe:function(t){this._observeButton(t)}}},ondropdown:{link:{observe:function(t){this._observeUnlink(t),this._observeEdit(t)}}},oncontextbar:function(t,e){var i=this._getCurrent(),s=this.inspector.parse(i);if(s.isLink()||s.isFile()){var n=s.isFile()?s.getFile():s.getLink(),o=$R.dom(n),r=$R.dom("<a>"),a=o.attr("href");r.text(this._truncateText(a)),r.attr("href",a),r.attr("target","_blank");var l={link:{title:r,html:this._truncateText(a)},edit:{title:this.lang.get("edit"),api:"module.link.open"},unlink:{title:this.lang.get("unlink"),api:"module.link.unlink"}};e.set(t,n,l,"bottom")}},open:function(){this.$link=this._buildCurrent(),this.app.api("module.modal.build",this._getModalData())},insert:function(t){this._insert(t)},update:function(t){this._update(t)},unlink:function(){this._unlink()},_observeButton:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);i.isPre()||i.isCode()?t.disable():t.enable()},_observeUnlink:function(t){var e=t.getItem("unlink");0===this._getLinks().length?e.disable():e.enable()},_observeEdit:function(t){var e=this._getCurrent(),i=t.getItem("link"),s=this.inspector.parse(e),n=s.isLink()||s.isFile()?this.lang.get("link-edit"):this.lang.get("link-insert");i.setTitle(n)},_unlink:function(){this.app.api("module.modal.close");var t=[],e=this._getLinks();this.selection.save();for(var i=0;i<e.length;i++){var s=$R.create("link.component",this.app,e[i]);t.push(this.selection.getElement(e[i])),s.unwrap(),this.app.broadcast("link.deleted",s)}this.selection.restore();for(i=0;i<t.length;i++){var n=t[i]?t[i]:this.editor.getElement();this.utils.normalizeTextNodes(n)}this._resetCurrent()},_update:function(t){this.app.api("module.modal.close");var e=this._getLinks();this._setLinkData(e,t,"updated"),this._resetCurrent()},_insert:function(t){this.app.api("module.modal.close");var e=this._getLinks();this._insertSingle(e,t)||(this._removeInSelection(e),this._insertMultiple(t)),this._resetCurrent()},_removeInSelection:function(t){this.selection.save();for(var e=0;e<t.length;e++){var i=$R.create("link.component",this.app,t[e]),s=i.clone();i.unwrap(),this.app.broadcast("link.deleted",s)}this.selection.restore()},_insertMultiple:function(t){var e=this.selection.getRange();e&&this._isCurrentTextChanged(t)&&this._deleteContents(e);var i=this.inline.format({tag:"a"});this._setLinkData(i,t,"inserted")},_insertSingle:function(t,e){var i=this.selection.getInline();if(1===t.length&&t[0].textContext===this.selection.getText()||i&&"A"===i.tagName){var s=$R.create("link.component",this.app,t[0]);return s.setData(e),this.caret.setAfter(s),this.app.broadcast("link.inserted",s),!0}return!1},_setLinkData:function(t,e,i){e.text=""===e.text.trim()?this._truncateText(e.url):e.text;var s=!this.currentText||this.currentText!==e.text;this.selection.save();for(var n=0;n<t.length;n++){var o=$R.create("link.component",this.app,t[n]),r={};e.text&&s&&(r.text=e.text),e.url&&(r.url=e.url),void 0!==e.title&&(r.title=e.title),void 0!==e.target&&(r.target=e.target),o.setData(r),this.app.broadcast("link."+i,o)}setTimeout(this.selection.restore.bind(this.selection),0)},_deleteContents:function(t){var e=this.selection.getHtml(),i=this.utils.parseHtml(e).nodes[0];if(i&&3!==i.nodeType){var s=i.tagName.toLowerCase(),n=document.createElement(s);this.insertion.insertNode(n,"start")}else t.deleteContents()},_getModalData:function(){var t;return t=this._isLink()?{update:{title:this.lang.get("save")},unlink:{title:this.lang.get("unlink"),type:"danger"},cancel:{title:this.lang.get("cancel")}}:{insert:{title:this.lang.get("insert")},cancel:{title:this.lang.get("cancel")}},{name:"link",title:this._isLink()?this.lang.get("link-edit"):this.lang.get("link-insert"),handle:this._isLink()?"update":"insert",commands:t}},_isLink:function(){return this.currentLink},_isCurrentTextChanged:function(t){return this.currentText&&this.currentText!==t.text},_buildCurrent:function(){var t,e=this._getCurrent(),i=this.inspector.parse(e);if(i.isLink()||i.isFile())this.currentLink=!0,t=i.isFile()?i.getFile():i.getLink(),t=$R.create("link.component",this.app,t);else{this.currentLink=!1,t=$R.create("link.component",this.app);var s={text:this.selection.getText()};t.setData(s)}return t},_getCurrent:function(){return this.selection.getInlinesAllSelected({tags:["a"]})[0]},_getLinks:function(){for(var t=this.selection.getInlines({all:!0,tags:["a"]}),e=[],i=0;i<t.length;i++){var s=this.inspector.parse(t[i]);(s.isLink()||s.isFile())&&e.push(t[i])}return e},_resetCurrent:function(){this.isCurrentLink=!1,this.currentText=!1},_truncateText:function(t){return t&&t.length>this.opts.linkSize?t.substring(0,this.opts.linkSize)+"...":t},_validateData:function(t,e){return""!==e.url.trim()||t.setError("url")},_setFormFocus:function(t){t.getField("url").focus()},_setFormData:function(t,e){var i=this.$link.getData(),s={url:i.url,text:i.text,title:i.title,target:this.opts.linkTarget||i.target};this.opts.linkNewTab||e.find(".form-item-target").hide(),this.opts.linkTitle||e.find(".form-item-title").hide(),t.setData(s),this.currentText=t.getField("text").val()}}),$R.add("class","link.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.opts=t.opts,this.reUrl=/^(?:(?:(?:https?|ftp):)?\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i,e&&void 0!==e.cmnt?e:this._init(e)},setData:function(t){for(var e in t)this._set(e,t[e])},getData:function(){for(var t=["url","text","target","title"],e={},i=0;i<t.length;i++)e[t[i]]=this._get(t[i]);return e},_init:function(t){var e=$R.dom(t);void 0===t?this.parse("<a>"):this.parse(e)},_set:function(t,e){this["_set_"+t](e)},_get:function(t){return this["_get_"+t]()},_get_target:function(){return!!this.attr("target")&&this.attr("target")},_get_url:function(){return this.attr("href")},_get_title:function(){return this.attr("title")},_get_text:function(){return this._getContext().text()},_getContext:function(){return this._findDeepestChild(this).element},_set_target:function(t){!1===t?this.removeAttr("target"):t&&this.attr("target",!0===t?"_blank":t)},_set_text:function(t){this._getContext().html(t)},_set_title:function(t){t&&""!==t?this.attr("title",t):this.removeAttr("title")},_set_url:function(t){this.opts.linkValidation&&(t=this._cleanUrl(t),this._isMailto(t)?t="mailto:"+t.replace("mailto:",""):this._isUrl(t)&&-1===t.search(/^(ftp|https?)/i)&&(t="http://"+t.replace(/(ftp|https?):\/\//i,""))),this.attr("href",t)},_isMailto:function(t){return-1!==t.search("@")&&!1===/(ftp|https?):\/\//i.test(t)},_isUrl:function(t){return this.reUrl.test(t)},_cleanUrl:function(t){return t.trim().replace(/[^\W\w\D\d+&\'@#/%?=~_|!:,.;\(\)]/gi,"")},_findDeepestChild:function(t){var e={depth:0,element:t};return t.children().each(function(i){var s=$R.dom(i);if(i.outerHTML===t.html()){var n=this._findDeepestChild(s);n.depth+1>e.depth&&(e={depth:1+n.depth,element:n.element})}}.bind(this)),e}}),$R.add("module","modal",{init:function(t){this.app=t,this.lang=t.lang,this.$doc=t.$doc,this.$win=t.$win,this.$body=t.$body,this.utils=t.utils,this.editor=t.editor,this.animate=t.animate,this.detector=t.detector,this.selection=t.selection,this.$box=!1,this.$modal=!1,this.selectionMarkers=!1,this.defaults={name:!1,url:!1,title:!1,width:"600px",height:!1,handle:!1,commands:!1}},build:function(t){this._open(t)},close:function(){this._close()},stop:function(){this.$box&&(this.$box.remove(),this.$box=!1,this.$modal=!1,this.$doc.off(".redactor.modal"),this.$win.off(".redactor.modal")),this.$overlay&&this.$overlay.remove()},resize:function(){this.$modal.setWidth(this.p.width),this.$modal.updatePosition()},_isOpened:function(){return this.$modal&&this.$modal.hasClass("open")},_open:function(t){this._buildDefaults(t),this.p.url?this._openUrl():this._openTemplate()},_openUrl:function(){$R.ajax.post({url:this.p.url,success:this._doOpen.bind(this)})},_openTemplate:function(){if(void 0!==$R.modals[this.p.name]){var t=this.lang.parse($R.modals[this.p.name]);this._doOpen(t)}},_doOpen:function(t){this.stop(),this.selection.isCollapsed()?(this.selection.save(),this.selectionMarkers=!1):(this.selection.saveMarkers(),this.selectionMarkers=!0),this.detector.isDesktop()||document.activeElement.blur(),this._createModal(t),this._buildModalBox(),this._buildOverlay(),this._buildModal(),this._buildModalForm(),this._buildModalCommands(),this._broadcast("open"),this.$modal.updatePosition(),this._buildModalTabs(),this.animate.start(this.$box,"fadeIn",this._opened.bind(this)),this.animate.start(this.$overlay,"fadeIn")},_opened:function(){this.$modal.addClass("open"),this.$box.on("mousedown.redactor.modal",this._close.bind(this)),this.$doc.on("keyup.redactor.modal",this._handleEscape.bind(this)),this.$win.on("resize.redactor.modal",this.resize.bind(this)),this.$modal.getBody().find("input[type=text],input[type=url],input[type=email]").on("keydown.redactor.modal",this._handleEnter.bind(this)),window.jQuery&&jQuery(document).off("focusin.modal"),this._broadcast("opened")},_close:function(t){if(this.$box&&this._isOpened()){if(t){if(!this._needToClose(t.target))return;t.stopPropagation(),t.preventDefault()}this.selectionMarkers?this.selection.restoreMarkers():this.selection.restore(),this.selectionMarkers=!1,this._broadcast("close"),this.animate.start(this.$box,"fadeOut",this._closed.bind(this)),this.animate.start(this.$overlay,"fadeOut")}},_closed:function(){this.$modal.removeClass("open"),this.$box.off(".redactor.modal"),this.$doc.off(".redactor.modal"),this.$win.off(".redactor.modal"),this._broadcast("closed")},_createModal:function(t){this.$modal=$R.create("modal.element",this.app,t)},_broadcast:function(t){this.app.broadcast("modal."+t,this.$modal,this.$modalForm),this.app.broadcast("modal."+this.p.name+"."+t,this.$modal,this.$modalForm)},_buildDefaults:function(t){this.p=$R.extend({},this.defaults,t)},_buildModalBox:function(){this.$box=$R.dom("<div>"),this.$box.attr("id","redactor-modal"),this.$box.addClass("redactor-animate-hide"),this.$box.html(""),this.$body.append(this.$box)},_buildOverlay:function(){this.$overlay=$R.dom("#redactor-overlay"),0===this.$overlay.length&&(this.$overlay=$R.dom("<div>"),this.$overlay.attr("id","redactor-overlay"),this.$overlay.addClass("redactor-animate-hide"),this.$body.prepend(this.$overlay))},_buildModal:function(){this.$box.append(this.$modal),this.$modal.setTitle(this.p.title),this.$modal.setHeight(this.p.height),this.$modal.setWidth(this.p.width)},_buildModalCommands:function(){if(this.p.commands){var t=this.p.commands,e=this.$modal.getFooter();for(var i in t){var s=$R.dom("<button>");s.html(t[i].title),s.attr("data-command",i),"cancel"===i&&(s.attr("data-action","close"),s.addClass("redactor-button-unstyled")),void 0!==t[i].type&&"danger"===t[i].type&&s.addClass("redactor-button-danger"),s.on("click",this._handleCommand.bind(this)),e.append(s)}}},_buildModalTabs:function(){var t=this.$modal.getBody(),e=t.find(".redactor-modal-tab"),i=t.find(".redactor-modal-tabs");e.length>1&&((i=0===i.length?$R.dom("<div>"):i.html("")).addClass("redactor-modal-tabs"),e.each(function(t,e){var s=$R.dom(t),n=$R.dom("<a>");n.attr("href","#"),n.attr("rel",e),n.text(s.attr("data-title")),n.on("click",this._showTab.bind(this)),0===e&&n.addClass("active"),i.append(n)}.bind(this)),t.prepend(i))},_buildModalForm:function(){this.$modalForm=$R.create("modal.form",this.app,this.$modal.getForm())},_showTab:function(t){t.preventDefault();var e=$R.dom(t.target),i=e.attr("rel"),s=this.$modal.getBody(),n=s.find(".redactor-modal-tab");n.hide(),n.eq(i).show(),s.find(".redactor-modal-tabs a").removeClass("active"),e.addClass("active")},_needToClose:function(t){var e=$R.dom(t);return!("close"!==e.attr("data-action")&&!this.$modal.isCloseNode(t)&&0!==e.closest(".redactor-modal").length)},_handleCommand:function(t){var e=$R.dom(t.target).closest("button").attr("data-command");"cancel"!==e&&t.preventDefault(),this._broadcast(e)},_handleEnter:function(t){13===t.which&&this.p.handle&&(t.preventDefault(),this._broadcast(this.p.handle))},_handleEscape:function(t){27===t.which&&this._close()}}),$R.add("class","modal.element",{mixins:["dom"],init:function(t,e){this.app=t,this.opts=t.opts,this.$win=t.$win,this._init(e)},getForm:function(){return this.find("form")},getHeader:function(){return this.$modalHeader},getBody:function(){return this.$modalBody},getFooter:function(){return this.$modalFooter},setTitle:function(t){t&&this.$modalHeader.html(t)},setWidth:function(t){t=parseInt(t)>=this.$win.width()?"96%":t,this.css("max-width",t)},setHeight:function(t){!1!==t&&this.$modalBody.css("height",t)},updatePosition:function(){var t=this.width();this.css({left:"50%","margin-left":"-"+t/2+"px"});var e=this.$win.height(),i=this.height(),s=e/2-i/2;i<e&&0!==s&&this.css("margin-top",s+"px")},isCloseNode:function(t){return t===this.$modalClose.get()},_init:function(t){this._build(),this._buildClose(),this._buildHeader(),this._buildBody(),this._buildFooter(),this._buildTemplate(t)},_build:function(){this.parse("<div>"),this.addClass("redactor-modal"),this.attr("dir",this.opts.direction)},_buildClose:function(){this.$modalClose=$R.dom("<span>"),this.$modalClose.addClass("redactor-close"),this.append(this.$modalClose)},_buildHeader:function(){this.$modalHeader=$R.dom("<div>"),this.$modalHeader.addClass("redactor-modal-header"),this.append(this.$modalHeader)},_buildBody:function(){this.$modalBody=$R.dom("<div>"),this.$modalBody.addClass("redactor-modal-body"),this.append(this.$modalBody)},_buildFooter:function(){this.$modalFooter=$R.dom("<div>"),this.$modalFooter.addClass("redactor-modal-footer"),this.append(this.$modalFooter)},_buildTemplate:function(t){this.$modalBody.html(t)}}),$R.add("class","modal.form",{mixins:["dom"],init:function(t,e){this.app=t,this.build(e)},build:function(t){this.parse(t)},getData:function(){var t={};return this.find("[name]").each(function(e){var i=$R.dom(e);t[i.attr("name")]=i.val()}),t},setData:function(t){this.find("[name]").each(function(e){var i=$R.dom(e),s=i.attr("name");t.hasOwnProperty(s)&&(e.type&&"checkbox"===e.type?e.checked=t[s]:i.val(t[s]))})},getField:function(t){return this.find("[name="+t+"]")},setError:function(t){var e=this.getField(t);return e.addClass("error"),e.one(this._getFieldEventName(e.get()),this._clearError),!1},_clearError:function(){return $R.dom(this).removeClass("error")},_getFieldEventName:function(t){return"SELECT"===t.tagName||"checkbox"===t.type||"radio"===t.type?"change":"keyup"}}),$R.add("module","block",{init:function(t){this.app=t,this.block=t.block},format:function(t){var e=this.block.format(t);this.app.broadcast("format","block",e)},clearformat:function(){this.block.clearFormat()},clearstyle:function(){this.block.clearStyle()},clearclass:function(){this.block.clearClass()},clearattr:function(){this.block.clearAttr()},add:function(t,e){this.block.add(t,e)},toggle:function(t,e){this.block.toggle(t,e)},set:function(t,e){this.block.set(t,e)},remove:function(t,e){this.block.remove(t,e)}}),$R.add("module","inline",{init:function(t){this.app=t,this.inline=t.inline},format:function(t){var e=this.inline.format(t);this.app.broadcast("format","inline",e)},clearformat:function(){this.inline.clearFormat()},clearstyle:function(){this.inline.clearStyle()},clearclass:function(){this.inline.clearClass()},clearattr:function(){this.inline.clearAttr()},add:function(t,e){this.inline.add(t,e)},toggle:function(t,e){this.inline.toggle(t,e)},set:function(t,e){this.inline.set(t,e)},remove:function(t,e){this.inline.remove(t,e)}}),$R.add("module","autosave",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.source=t.source},onsynced:function(){this.opts.autosave&&this._send()},_send:function(){var t=this.opts.autosaveName?this.opts.autosaveName:this.source.getName(),e={};e[t]=this.source.getCode(),e=this.utils.extendData(e,this.opts.autosaveData),$R.ajax.post({url:this.opts.autosave,data:e,success:function(i){this._complete(i,t,e)}.bind(this)})},_complete:function(t,e,i){var s=t&&t.error?"autosaveError":"autosave";this.app.broadcast(s,e,i,t)}}),$R.add("module","input",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.editor=t.editor,this.keycodes=t.keycodes,this.element=t.element,this.selection=t.selection,this.insertion=t.insertion,this.inspector=t.inspector,this.autoparser=t.autoparser,this.lastShiftKey=!1},onpaste:function(t,e){if(this.opts.input)return $R.create("input.paste",this.app,t,e)},onkeydown:function(t){if(this.opts.input){var e=t.which;if(!$R.create("input.shortcut",this.app,t).is()){if((t.ctrlKey||t.metaKey)&&!t.altKey&&65===e)return t.preventDefault(),this._selectAll();var i=[this.keycodes.ENTER,this.keycodes.SPACE,this.keycodes.BACKSPACE,this.keycodes.DELETE],s=[this.keycodes.UP,this.keycodes.DOWN,this.keycodes.LEFT,this.keycodes.RIGHT],n=-1!==i.indexOf(e),o=-1!==s.indexOf(e),r=(t.ctrlKey||t.metaKey)&&88===e,a=!t.ctrlKey&&!t.metaKey&&(e>=48&&e<=57||e>=65&&e<=90);if(this.selection.isAll()&&o&&(r||!t.ctrlKey&&!t.metaKey&&!t.altKey&&!t.shiftKey)){if(r)return this.editor.disableNonEditables(),void this.app.broadcast("empty");if(this._isArrowKey(e))return!0;if(n&&t.preventDefault(),this.element.isType("inline"))this.editor.getElement().html(""),this.editor.startFocus();else this.insertion.set(this.opts.emptyHtml);if(n)return;this.app.broadcast("empty")}if(this.opts.autoparse&&this.autoparser.format(t,e),!a||!this.selection.hasNonEditable())return e===this.keycodes.ENTER?$R.create("input.enter",this.app,t,e):t.metaKey&&219===e?(t.preventDefault(),void this.app.api("module.list.outdent")):e===this.keycodes.TAB||t.metaKey&&221===e?$R.create("input.tab",this.app,t,e):e===this.keycodes.SPACE?$R.create("input.space",this.app,t,e,this.lastShiftKey):this._isDeleteKey(e)?$R.create("input.delete",this.app,t,e):this._isArrowKey(e)?$R.create("input.arrow",this.app,t,e):void 0;t.preventDefault()}}},onkeyup:function(t){if(this.opts.input){var e=t.which;if(this.lastShiftKey=t.shiftKey,this.app.broadcast("contextbar.close"),!$R.create("input.shortcode",this.app,t,e).is()){if(e===this.keycodes.BACKSPACE){var i=this.editor.getElement(),s=this.utils.trimSpaces(i.html());if(""===(s=(s=s.replace(/<br\s?\/?>/g,"")).replace(/<div><\/div>/,"")))return t.preventDefault(),this.editor.setEmpty(),void this.editor.startFocus()}this.editor.isEmpty()&&this.app.broadcast("empty")}}},start:function(){this.opts.shortcutsAdd&&(this.opts.shortcuts=$R.extend({},!0,this.opts.shortcuts,this.opts.shortcutsAdd))},_selectAll:function(){var t,e=this.selection.getCurrent(),i=this.inspector.parse(e);return i.isComponentType("table")?(t=i.getTable(),void this.selection.setAll(t)):i.isComponentType("code")?(t=i.getComponentCodeElement(),void this.selection.setAll(t)):void this.selection.setAll()},_isArrowKey:function(t){return-1!==[this.keycodes.UP,this.keycodes.DOWN,this.keycodes.RIGHT,this.keycodes.LEFT].indexOf(t)},_isDeleteKey:function(t){return t===this.keycodes.BACKSPACE||t===this.keycodes.DELETE}}),$R.add("class","input.arrow",{init:function(t,e,i){this.app=t,this.opts=t.opts,this.utils=t.utils,this.caret=t.caret,this.offset=t.offset,this.marker=t.marker,this.editor=t.editor,this.keycodes=t.keycodes,this.component=t.component,this.inspector=t.inspector,this.selection=t.selection,this.key=i,this._init(e)},_init:function(t){if(!this._isRightLeftKey()||!this._isExitVariable(t)){if(this._isRightDownKey()){if(this._isExitOnDownRight(t))return;if(this._selectComponent(t,"End","next"))return}if(this._isLeftUpKey()){if(this._isExitOnUpLeft(t))return;if(this._selectComponent(t,"Start","prev"))return}this.key===this.keycodes.LEFT?this.utils.trimInvisibleChars("left"):this.key===this.keycodes.RIGHT&&this.utils.trimInvisibleChars("right")}},_isRightDownKey:function(){return-1!==[this.keycodes.DOWN,this.keycodes.RIGHT].indexOf(this.key)},_isLeftUpKey:function(){return-1!==[this.keycodes.UP,this.keycodes.LEFT].indexOf(this.key)},_isRightLeftKey:function(){return-1!==[this.keycodes.RIGHT,this.keycodes.LEFT].indexOf(this.key)},_isExitVariable:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e),s=i.getComponent();if(i.isComponentType("variable")&&i.isComponentActive()){t.preventDefault();var n=this.key===this.keycodes.LEFT?"setBefore":"setAfter";this.caret[n](s)}else;},_isExitOnUpLeft:function(t){var e=this.selection.getCurrent(),i=this.selection.getBlock(e),s=this.inspector.parse(e),n=i.previousElementSibling,o=this.caret.isStart(i);if(o&&n&&"TABLE"===n.tagName)return t.preventDefault(),this.caret.setEnd(n),!0;if(s.isFigcaption()){i=s.getFigcaption(),o=this.caret.isStart(i);var r=$R.dom(i).closest(".redactor-component");if(o&&0!==r.length)return t.preventDefault(),this.caret.setEnd(r),!0}else{if(s.isTable()&&o)return t.preventDefault(),this.caret.setEnd(i.previousElementSibling),!0;if(!s.isComponentEditable()&&s.isComponent()&&!s.isComponentType("variable")){var a=s.getComponent();if(!a.previousElementSibling)return t.preventDefault(),this.component.clearActive(),this._exitPrevElement(t,s.getComponent());if(a.previousElementSibling)return t.preventDefault(),this.component.clearActive(),this.caret.setEnd(a.previousElementSibling),!0}}},_isExitOnDownRight:function(t){var e,i,s=this.editor.getElement(),n=this.selection.getCurrent(),o=this.inspector.parse(n),r=this.caret.isEnd();if(o.isTable()){if(i||r)return this._exitNextElement(t,o.getComponent())}else if(o.isFigcaption()){if(e=o.getFigcaption(),(i=this.caret.isEnd(e))||r)return this._exitNextElement(t,o.getComponent())}else if(o.isComponentType("code")){var a=o.getComponent(),l=$R.dom(o.getComponentCodeElement()).closest("pre");i=this.caret.isEnd(e);var h=l&&l.get().nextElementSibling;if(i&&!h)return this._exitNextElement(t,a)}else if(o.isPre()||o.isBlockquote()||o.isDl()){if(r){if(o.isPre())return this._exitNextElement(t,o.getPre());if(o.isBlockquote())return this._exitNextElement(t,o.getBlockquote());if(o.isDl())return this._exitNextElement(t,o.getDl())}}else if(o.isList()){var c=$R.dom(n).parents("ul, ol",s).last();if((i=this.caret.isEnd(c))||r)return this._exitNextElement(t,c.get())}else if(o.isComponent()&&!o.isComponentType("variable")&&"span"!==o.getTag())return this.component.clearActive(),this._exitNextElement(t,o.getComponent())},_exitPrevElement:function(t,e){return t.preventDefault(),e.previousElementSibling?this.caret.setEnd(e.previousElementSibling):this.utils.createMarkupBefore(e),!0},_exitNextElement:function(t,e){return t.preventDefault(),e.nextElementSibling?this.caret.setStart(e.nextElementSibling):this.utils.createMarkup(e),!0},_selectComponent:function(t,e,i){var s=this.selection.getCurrent(),n=this.selection.getBlock(s),o=this.utils.findSiblings(s,i),r=this.utils.findSiblings(n,i);o&&this.caret["is"+e](s)?this._selectComponentItem(t,o,e):r&&this.caret["is"+e](n)&&this._selectComponentItem(t,r,e)},_selectComponentItem:function(t,e,i){if(this.component.isNonEditable(e))return t.preventDefault(),this.caret["set"+i](e),!0}}),$R.add("class","input.delete",{init:function(t,e,i){this.app=t,this.opts=t.opts,this.caret=t.caret,this.utils=t.utils,this.editor=t.editor,this.marker=t.marker,this.keycodes=t.keycodes,this.component=t.component,this.inspector=t.inspector,this.selection=t.selection,this.insertion=t.insertion,this.key=i,this._init(e)},_init:function(t){if(!this._removeActiveComponent(t)&&!this._removeAllSelectedTable(t)){if(this.key===this.keycodes.BACKSPACE){var e=this.editor.getElement();if(this.utils.trimSpaces(e.html())===this.opts.emptyHtml)return void t.preventDefault()}if(this._detectVariableOrNonEditable()||this.selection.hasNonEditable())t.preventDefault();else{if(this.selection.isAll())return t.preventDefault(),void this.insertion.set(this.opts.emptyHtml);this.selection.isCollapsed()&&(this.key===this.keycodes.BACKSPACE?this._traverseBackspace(t):this.key===this.keycodes.DELETE&&this._traverseDelete(t)),this.key===this.keycodes.BACKSPACE&&this.utils.trimInvisibleChars("left"),this._removeUnwantedStyles(),this._removeEmptySpans(),this._removeSpanTagsInHeadings(),this._removeInlineTagsInPre()}}},_detectVariableOrNonEditable:function(){var t,e=this.selection.getBlock(),i=this.caret.isStart(e),s=this.caret.isEnd(e);if(this.key===this.keycodes.BACKSPACE&&i){if(t=e.previousSibling,this._isNonEditable(t))return!0}else if(this.key===this.keycodes.DELETE&&s&&(t=e.nextSibling,this._isNonEditable(t)))return!0;var n=this.selection.getCurrent(),o=this.caret.isStart(n),r=this.caret.isEnd(n),a=""===this.selection.getTextBeforeCaret().trim(),l=""===this.selection.getTextAfterCaret().trim();if(this.key===this.keycodes.BACKSPACE&&o&&!a){if(t=n.previousSibling,this._isVariable(t))return this.caret.setEnd(t),!0;if(this._isNonEditable(t))return!0}else if(this.key===this.keycodes.DELETE&&r&&!l){if(t=n.nextSibling,this._isVariable(t))return this.caret.setStart(t),!0;if(this._isNonEditable(t))return!0}},_isVariable:function(t){return 0!==$R.dom(t).closest('[data-redactor-type="variable"]').length},_isNonEditable:function(t){return 0!==$R.dom(t).closest(".non-editable").length},_getBlock:function(){var t=this.editor.getElement(),e=this.selection.getBlock(),i=this.inspector.parse(e);return e=i.isList()?$R.dom(e).parents("ul, ol",t).last().get():e,e=i.isDl()?i.getDl():e,e=i.isTable()?i.getTable():e},_traverseDelete:function(t){var e,i,s,n=this.selection.getCurrent(),o=this.inspector.parse(n);if(o.isFigcaption()){if(e=o.getFigcaption(),i=this.caret.isEnd(e))return void t.preventDefault()}else if(o.isComponentType("code")&&(e=o.getComponent(),i=this.caret.isEnd(e)))return void t.preventDefault();e=this._getBlock();var r=this.utils.findSiblings(e,"next");if(r){i=this.caret.isEnd(e);var a=this.inspector.parse(r),l="P"===r.tagName||"DIV"===r.tagName;if(i&&a.isComponentEditable())return t.preventDefault(),void this.component.remove(r,!1);if(i&&a.isComponent())return t.preventDefault(),this.caret.setStart(r),void(this.utils.isEmptyHtml(e.innerHTML)&&$R.dom(e).remove());if(i&&a.isList()){var h=$R.dom(e);if(s=$R.dom(r),o.isList())return t.preventDefault(),h.append(s),void s.unwrap();var c=s.children("li").first(),d=c.find("ul, ol");if(0!==d.length)return t.preventDefault(),s.prepend(d),d.unwrap(),h.append(c),void c.unwrap()}else if(i&&!o.isList()&&!o.isTable()&&l&&!this.utils.isEmptyHtml(e.innerHTML)){t.preventDefault();var u=$R.dom(e);return s=$R.dom(r),u.append(s),void s.unwrap()}}},_traverseBackspace:function(t){var e,i,s,n,o=this.selection.getCurrent(),r=this.inspector.parse(o);if(r.isFigcaption()){if(e=r.getFigcaption(),i=this.caret.isStart(e))return void t.preventDefault()}else if(r.isComponentType("code")&&(e=r.getComponent(),(i=this.caret.isStart(e))&&e.previousElementSibling))return t.preventDefault(),this.caret.setEnd(e.previousElementSibling),!0;e=this._getBlock();var a=this.utils.findSiblings(e,"prev");if(a){i=this.caret.isStart(e);var l=this.inspector.parse(a),h="P"===a.tagName||"DIV"===a.tagName;if(i&&l.isComponentEditable())return t.preventDefault(),void this.component.remove(a,!1);if(i&&l.isComponent())return t.preventDefault(),this.caret.setStart(a),void(this.utils.isEmptyHtml(e.innerHTML)&&$R.dom(e).remove());if(i&&r.isList())if(t.preventDefault(),n=$R.dom(e),s=$R.dom(a),l.isList())n.children("li").first().prepend(this.marker.build("start")),s.append(n),n.unwrap(),this.selection.restoreMarkers();else{var c=n.children("li").first(),d=c.get(),u=c.find("ul, ol"),p=this.utils.replaceToTag(d,this.opts.markup);this.opts.breakline&&p.attr("data-redactor-tag","br"),n.before(p),this.caret.setStart(p),0!==u.length&&(n.prepend(u),u.unwrap())}else if(i&&h){t.preventDefault();var f=this.utils.createInvisibleChar(),m=$R.dom(e);return s=$R.dom(a),this.caret.setEnd(s),m.prepend(f),s.append(m.contents()),void m.remove()}}else setTimeout(this._replaceBlock.bind(this),1)},_replaceBlock:function(){var t=this.selection.getBlock(),e=$R.dom(t);if("p"===this.opts.markup&&t&&this._isNeedToReplaceBlock(t)){var i=document.createElement(this.opts.markup);e.replaceWith(i),this.caret.setStart(i)}this.opts.breakline&&t&&"DIV"===t.tagName&&e.attr("data-redactor-tag","br")},_isNeedToReplaceBlock:function(t){return"DIV"===t.tagName&&this.utils.isEmptyHtml(t.innerHTML)},_removeActiveComponent:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e),s=i.getComponent();if(i.isComponent()&&this.component.isActive(s))return t.preventDefault(),this.component.remove(s),!0},_removeAllSelectedTable:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e).getTable();if(i&&this.selection.isAll(i))return t.preventDefault(),this.component.remove(i),!0},_removeUnwantedStyles:function(){var t=this.editor.getElement();setTimeout(function(){t.find("*[style]").not("img, figure, iframe, [data-redactor-style-cache], [data-redactor-span]").removeAttr("style")},0)},_removeEmptySpans:function(){var t=this.editor.getElement();setTimeout(function(){t.find("span").each(function(t){0===t.attributes.length&&$R.dom(t).replaceWith(t.childNodes)})},0)},_removeSpanTagsInHeadings:function(){var t=this.editor.getElement();setTimeout(function(){t.find("h1, h2, h3, h4, h5, h6").each(function(t){var e=$R.dom(t);0===e.closest("figure").length&&e.find("span").not(".redactor-component, .non-editable, .redactor-selection-marker, [data-redactor-style-cache], [data-redactor-span]").unwrap()})},1)},_removeInlineTagsInPre:function(){var t=this.editor.getElement(),e=this.opts.inlineTags;setTimeout(function(){t.find("pre").each(function(t){var i=$R.dom(t);0===i.closest("figure").length&&i.find(e.join(",")).not("code, .redactor-selection-marker").unwrap()})},1)}}),$R.add("class","input.enter",{init:function(t,e){this.app=t,this.opts=t.opts,this.utils=t.utils,this.caret=t.caret,this.editor=t.editor,this.insertion=t.insertion,this.selection=t.selection,this.inspector=t.inspector,this._init(e)},_init:function(t){return this.opts.enterKey?!1===this.app.broadcast("enter",t)?t.preventDefault():this.selection.hasNonEditable()?void t.preventDefault():t.ctrlKey||t.shiftKey?this._insertBreak(t):void(this._isExit(t)||this._traverse(t)):this._disable(t)},_disable:function(t){t.preventDefault();var e=this.selection.getRange();e&&!e.collapsed&&e.deleteContents()},_insertBreak:function(t){t.preventDefault();var e=this.selection.getCurrent(),i=this.inspector.parse(e);i.isComponent()&&!i.isComponentEditable()||i.isCode()||(i.isPre()?this.insertion.insertNewline():this.insertion.insertBreakLine())},_isExit:function(t){var e=this.editor.getElement(),i=this.selection.getBlock(),s=this.inspector.parse(i),n=this.caret.isEnd(i),o=this.selection.getCurrent(),r=o.previousSibling;if(s.isBlockquote()){var a=n&&this._isExitableBlock(i,"P"),l=n&&this._isExitableDblBreak(r);if(a||l)return this._exitFromElement(t,l?r:i,s.getBlockquote())}else if(!s.isComponentType("code")&&s.isPre()){if(n){var h=i.innerHTML;if(null!==(h=this.utils.removeInvisibleChars(h)).match(/(\n\n\n)$/))return $R.dom(r.previousSibling.previousSibling).remove(),this._exitFromElement(t,r,i)}}else if(s.isDl()){if(n&&this._isExitableBlock(i,"DT"))return this._exitFromElement(t,i,s.getDl())}else if(s.isList()){var c=$R.dom(o).parents("ul, ol",e).last();if((n=this.caret.isEnd(c))&&this._isExitableBlock(i,"LI"))return this._exitFromElement(t,i,c)}else if(s.isComponent()&&s.isComponentActive()&&!s.isFigcaption()&&!s.isComponentEditable())return this._exitFromElement(t,!1,s.getComponent())},_isExitableDblBreak:function(t){var e=!!t&&t.nextSibling;if(e){var i=this.utils.removeInvisibleChars(e.textContent);return 3===e.nodeType&&""===i.trim()}},_isExitableBlock:function(t,e){return t&&t.tagName===e&&this.utils.isEmptyHtml(t.innerHTML)},_exitFromElement:function(t,e,i){return t.preventDefault(),e&&$R.dom(e).remove(),this.utils.createMarkup(i),!0},_exitNextElement:function(t,e){return t.preventDefault(),e.nextSibling?this.caret.setStart(e.nextSibling):this.utils.createMarkup(e),!0},_traverse:function(t){var e=this.selection.getCurrent(),i=this.selection.isText(),s=this.selection.getBlock(),n=this.inspector.parse(e),o=!!s&&s.tagName.toLowerCase(),r=$R.dom(e).closest("[data-redactor-type=variable]");if(0!==r.length&&this.caret.setAfter(r),n.isPre())return t.preventDefault(),this.insertion.insertNewline();if(!n.isBlockquote()){if(n.isFigcaption()){s=n.getFigcaption();var a=this.caret.isEnd(s),l=this.caret.isEnd();return a||l?this._exitNextElement(t,n.getComponent()):void t.preventDefault()}return n.isDl()?(t.preventDefault(),this._traverseDl(e)):i||this.opts.breakline&&"div"===o?(t.preventDefault(),this.insertion.insertBreakLine()):void setTimeout(this._replaceBlock.bind(this),1)}return(s=this.selection.getBlock(e))&&"BLOCKQUOTE"===s.tagName?(t.preventDefault(),this.insertion.insertBreakLine()):void 0},_traverseDl:function(t){var e=this.selection.getBlock(t),i=this.inspector.parse(e).getTag(),s=$R.dom(e),n=s.get().nextSibling||!1,o=$R.dom(n),r=n&&o.is("dd"),a=n&&o.is("dt"),l=this.caret.isEnd(e);if("dt"===i&&!r&&l){var h=document.createElement("dd");return s.after(h),void this.caret.setStart(h)}if("dd"===i&&!a&&l){var c=document.createElement("dt");return s.after(c),void this.caret.setStart(c)}return this.insertion.insertBreakLine()},_replaceBlock:function(){var t=this.selection.getBlock(),e=$R.dom(t);if("p"===this.opts.markup&&t&&this._isNeedToReplaceBlock(t)){var i=document.createElement(this.opts.markup);e.replaceWith(i),this.caret.setStart(i)}else if(t)if(this.utils.isEmptyHtml(t.innerHTML))this._clearBlock(e,t);else{var s=this.utils.getFirstNode(t);s&&"BR"===s.tagName&&($R.dom(s).remove(),this.caret.setStart(t))}t&&this._isNeedToCleanBlockStyle(t)&&this.opts.cleanOnEnter&&e.removeAttr("class style"),this.opts.breakline&&t&&"DIV"===t.tagName&&e.attr("data-redactor-tag","br")},_clearBlock:function(t,e){(this.opts.cleanInlineOnEnter||"<br>"===e.innerHTML)&&t.html(""),this.caret.setStart(e)},_isNeedToReplaceBlock:function(t){return"DIV"===t.tagName&&this.utils.isEmptyHtml(t.innerHTML)},_isNeedToCleanBlockStyle:function(t){return"P"===t.tagName&&this.utils.isEmptyHtml(t.innerHTML)}}),$R.add("class","input.paste",{init:function(t,e,i,s,n){this.app=t,this.opts=t.opts,this.editor=t.editor,this.cleaner=t.cleaner,this.container=t.container,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this.autoparser=t.autoparser,this.pasteHtml=s,this.pointInserted=n,this.dataTransfer=i,this._init(e)},_init:function(t){var e,i=this.dataTransfer||t.clipboardData,s=this.selection.getCurrent(),n=this.inspector.parse(s);if(this.dropPasted=this.dataTransfer,this.isRawCode=n.isPre()||n.isCode(),this.editor.enablePasting(),this.editor.saveScroll(),this.dropPasted||this.selection.saveMarkers(),this.isRawCode||!i)return e=this.isRawCode||i||!window.clipboardData?i.getData("text/plain"):window.clipboardData.getData("text"),t.preventDefault(),void this._insert(t,e);if(this.pasteHtml)t.preventDefault(),this._insert(t,this.pasteHtml);else{var o=i.getData("URL"),r=this._isPlainText(i)?i.getData("text/plain"):i.getData("text/html");if(r=o&&""!==o?o:r,null!==i.files&&i.files.length>0&&""===r){for(var a=[],l=0;l<i.files.length;l++){var h=i.files[l]||i.items[l].getAsFile();h&&a.push(h)}if(a.length>0)return t.preventDefault(),void this._insertFiles(t,a)}t.preventDefault(),this._insert(t,r)}},_isPlainText:function(t){var e=t.getData("text/plain"),i=t.getData("text/html");if(!e||!i)return null!==e;var s=document.createElement("div");return s.innerHTML=i,s.textContent===e?!s.querySelector(":not(meta)"):void 0},_restoreSelection:function(){this.editor.restoreScroll(),this.editor.disablePasting(),this.dropPasted||this.selection.restoreMarkers()},_insert:function(t,e){var i=this.app.broadcast("pasteBefore",e);if(e=(e=void 0===i?e:i).trim(),e=(e=this.isRawCode?e:this.cleaner.paste(e)).trim(),e=this.isRawCode?this.cleaner.encodePhpCode(e):e,e=void 0===(i=this.app.broadcast("pasting",e))?e:i,this._restoreSelection(),this.opts.input){var s=[];if(this.isRawCode){var n=document.createTextNode(e);s=this.insertion.insertNode(n,"after"),this.app.broadcast("pasted",s)}else this.opts.autoparse&&this.opts.autoparsePaste&&(e=this.autoparser.parse(e)),s=this.dropPasted?this.insertion.insertToPoint(t,e,this.pointInserted):this.insertion.insertHtml(e),this.app.broadcast("pasted",s),this.app.broadcast("autoparseobserve")}},_insertFiles:function(t,e){this._restoreSelection();var i=-1!==this.opts.imageTypes.indexOf(e[0].type),s=void 0===this.dropPasted;i?this.app.broadcast("dropimage",t,e,s):this.app.broadcast("dropfile",t,e,s)}}),$R.add("class","input.shortcode",{init:function(t,e,i){this.app=t,this.opts=t.opts,this.utils=t.utils,this.marker=t.marker,this.keycodes=t.keycodes,this.selection=t.selection,this.worked=!1,i===this.keycodes.SPACE&&this._init()},is:function(){return this.worked},_init:function(){var t=this.selection.getCurrent();if(t&&3===t.nodeType){var e=this.utils.removeInvisibleChars(t.textContent),i=this.opts.shortcodes;for(var s in i){var n=new RegExp("^"+this.utils.escapeRegExp(s));if(null!==e.match(n)&&void 0!==i[s].format)return this._format(i[s].format,t,n)}}},_format:function(t,e,i){var s=(e=this.marker.insert("start").previousSibling).textContent;s=(s=this.utils.trimSpaces(s)).replace(i,""),e.textContent=s;var n="ul"===t||"ol"===t?"module.list.toggle":"module.block.format";this.app.api(n,t),this.selection.restoreMarkers(),this.worked=!0}}),$R.add("class","input.shortcut",{init:function(t,e){this.app=t,this.opts=t.opts,this.worked=!1,this.hotkeys={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},this.hotkeysShiftNums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},this._init(e)},is:function(){return this.worked},_init:function(t){if(!1!==this.opts.shortcuts)for(var e in this.opts.shortcuts)this._build(t,e,this.opts.shortcuts[e]);else!t.ctrlKey&&!t.metaKey||66!==t.which&&73!==t.which||t.preventDefault()},_build:function(t,e,i){for(var s=e.split(","),n=s.length,o=0;o<n;o++)"string"==typeof s[o]&&this._handler(t,s[o].trim(),i)},_handler:function(t,e,i){e=e.toLowerCase().split(" ");for(var s=this.hotkeys[t.keyCode],n=String.fromCharCode(t.which).toLowerCase(),o="",r={},a=["meta","ctrl","alt","shift"],l=0;l<a.length;l++){var h=a[l];t[h+"Key"]&&s!==h&&(o+=h+"+")}s&&(r[o+s]=!0),n&&(r[o+n]=!0,r[o+this.hotkeysShiftNums[n]]=!0,"shift+"===o&&(r[this.hotkeysShiftNums[n]]=!0));var c=e.length;for(l=0;l<c;l++)if(r[e[l]])return t.preventDefault(),this.worked=!0,void(i.message?(this.app.broadcast(i.message,i.args),this.app.broadcast("buffer.trigger")):i.api&&(this.app.api(i.api,i.args),this.app.broadcast("buffer.trigger")))}}),$R.add("class","input.space",{init:function(t,e,i,s){this.app=t,this.keycodes=t.keycodes,this.insertion=t.insertion,this.selection=t.selection,this.key=i,this.lastShiftKey=s,this._init(e)},_init:function(t){if(!this.selection.hasNonEditable())return this.lastShiftKey||this.key!==this.keycodes.SPACE||!t.ctrlKey&&!t.shiftKey||t.metaKey?void 0:(t.preventDefault(),void this.insertion.insertChar("&nbsp;"));t.preventDefault()}}),$R.add("class","input.tab",{init:function(t,e){this.app=t,this.opts=t.opts,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this._init(e)},_init:function(t){if(this.opts.tabKey){if(!1===this.app.broadcast("tab",t))return t.preventDefault();this._traverse(t)}},_traverse:function(t){var e=this.selection.getCurrent(),i=this.inspector.parse(e);return!i.isComponent()&&t.shiftKey?this._insertHardTab(t,4):i.isList()?(t.preventDefault(),this.app.api("module.list.indent")):i.isPre()||i.isComponentType("code")&&!i.isFigcaption()?this._tabCode(t):!1!==this.opts.tabAsSpaces?this._insertHardTab(t,this.opts.tabAsSpaces):void 0},_insertHardTab:function(t,e){t.preventDefault();var i=document.createTextNode(Array(e+1).join(" "));return this.insertion.insertNode(i,"end")},_tabCode:function(t){t.preventDefault();var e=this.opts.preSpaces?document.createTextNode(Array(this.opts.preSpaces+1).join(" ")):document.createTextNode("\t");return this.insertion.insertNode(e,"end")}}),$R.add("module","upload",{init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.utils=t.utils,this.editor=t.editor,this.progress=t.progress,this.defaults={event:!1,element:!1,name:!1,files:!1,url:!1,data:!1,paramName:!1}},build:function(t){this.p=$R.extend(this.defaults,t),this.$el=$R.dom(this.p.element),"INPUT"===this.$el.get().tagName?this._buildInput():this._buildBox()},send:function(t){this.p=$R.extend(this.defaults,t),this.$uploadbox=this.editor.getElement(),this._send(this.p.event,this.p.files)},complete:function(t,e){this._complete(t,e)},_buildInput:function(){this.box=!1,this.prefix="",this.$uploadbox=$R.dom('<div class="upload-redactor-box" />'),this.$el.hide(),this.$el.after(this.$uploadbox),this.opts.multipleUpload?this.$el.attr("multiple","multiple"):this.$el.removeAttr("multiple"),"file"!==this.p.name&&this.$el.attr("accept","image/*"),this._buildPlaceholder(),this._buildEvents()},_buildBox:function(){this.box=!0,this.prefix="box-",this.$uploadbox=this.$el,this.$uploadbox.attr("ondragstart","return false;"),this.$uploadbox.on("drop.redactor.upload",this._onDropBox.bind(this)),this.$uploadbox.on("dragover.redactor.upload",this._onDragOver.bind(this)),this.$uploadbox.on("dragleave.redactor.upload",this._onDragLeave.bind(this))},_buildPlaceholder:function(){this.$placeholder=$R.dom('<div class="upload-redactor-placeholder" />'),this.$placeholder.html(this.lang.get("upload-label")),this.$uploadbox.append(this.$placeholder)},_buildEvents:function(){this.$el.on("change.redactor.upload",this._onChange.bind(this)),this.$uploadbox.on("click.redactor.upload",this._onClick.bind(this)),this.$uploadbox.on("drop.redactor.upload",this._onDrop.bind(this)),this.$uploadbox.on("dragover.redactor.upload",this._onDragOver.bind(this)),this.$uploadbox.on("dragleave.redactor.upload",this._onDragLeave.bind(this))},_onClick:function(t){t.preventDefault(),this.$el.click()},_onChange:function(t){this._send(t,this.$el.get().files)},_onDrop:function(t){t.preventDefault(),this._clear(),this._setStatusDrop(),this._send(t)},_onDragOver:function(t){return t.preventDefault(),this._setStatusHover(),!1},_onDragLeave:function(t){return t.preventDefault(),this._removeStatusHover(),!1},_onDropBox:function(t){t.preventDefault(),this._clear(),this._setStatusDrop(),this._send(t)},_removeStatusHover:function(){this.$uploadbox.removeClass("upload-redactor-"+this.prefix+"hover")},_setStatusDrop:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"drop")},_setStatusHover:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"hover")},_setStatusError:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"error")},_setStatusSuccess:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"success")},_clear:function(){for(var t=["drop","hover","error","success"],e=0;e<t.length;e++)this.$uploadbox.removeClass("upload-redactor-"+this.prefix+t[e]);this.$uploadbox.removeAttr("ondragstart")},_send:function(t,e){t=t.originalEvent||t,e=e||t.dataTransfer.files;var i=new FormData,s=this._getUploadParam();i=this._buildData(s,e,i),i=this.utils.extendData(i,this.p.data),!1!==this.app.broadcast("upload.start",t,i,e)&&this._sendData(i,e,t)},_sendData:function(t,e,i){if(this.progress.show(),"function"==typeof this.p.url){var s=this.p.url(t,e,i,this);s instanceof Promise||this._complete(s,i)}else $R.ajax.post({url:this.p.url,data:t,before:function(t){return this.app.broadcast("upload.beforeSend",t)}.bind(this),success:function(t){this._complete(t,i)}.bind(this)})},_getUploadParam:function(){return this.p.paramName?this.p.paramName:"file"},_buildData:function(t,e,i){if(1===e.length)i.append(t+"[]",e[0]);else if(e.length>1&&!1!==this.opts.multipleUpload)for(var s=0;s<e.length;s++)i.append(t+"[]",e[s]);return i},_complete:function(t,e){this._clear(),this.progress.hide(),t&&t.error?(this._setStatusError(),this.app.broadcast("upload."+this.p.name+".error",t,e),this.app.broadcast("upload.error",t)):(this._setStatusSuccess(),this.app.broadcast("upload."+this.p.name+".complete",t,e),this.app.broadcast("upload.complete",t),setTimeout(this._clear.bind(this),500))}}),$R.add("class","code.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){var e;if(void 0!==t){var i=$R.dom(t).closest("figure");0!==i.length?this.parse(i):(this.parse("<figure>"),this.append(t)),e=this.find("pre code, pre").last()}else e=$R.dom("<pre>"),this.parse("<figure>"),this.append(e);this._initElement(e),this._initWrapper()},_initElement:function(t){t.attr({tabindex:"-1",contenteditable:!0})},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"code",tabindex:"-1",contenteditable:!1})}}),$R.add("module","form",{init:function(t){this.app=t,this.lang=t.lang,this.component=t.component,this.inspector=t.inspector},onform:{remove:function(t){this._remove(t)}},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(i.isComponentType("form")){var s=i.getComponent(),n={remove:{title:this.lang.get("delete"),api:"module.form.remove",args:s}};e.set(t,s,n,"top")}},_remove:function(t){this.component.remove(t)}}),$R.add("class","form.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.utils=t.utils,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){if(void 0!==t)if(0!==$R.dom(t).closest("form").length){var e=this.utils.replaceToTag(t,"figure");this.parse(e)}else this.parse("<figure>"),this.append(t);else this.parse("<figure>");this._initWrapper()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"form",tabindex:"-1",contenteditable:!1})}}),$R.add("module","image",{modals:{image:'<div class="redactor-modal-tab" data-title="## upload ##"><form action="">                 <input type="file" name="file">             </form></div>',imageedit:'<div class="redactor-modal-group">                 <div id="redactor-modal-image-preview" class="redactor-modal-side"></div>                 <form action="" class="redactor-modal-area">                     <div class="form-item">                         <label for="modal-image-title"> ## title ##</label>                         <input type="text" id="modal-image-title" name="title" />                     </div>                     <div class="form-item form-item-caption">                         <label for="modal-image-caption">## caption ##</label>                         <input type="text" id="modal-image-caption" name="caption" aria-label="## caption ##" />                     </div>                     <div class="form-item form-item-align">                         <label>## image-position ##</label>                         <select name="align" aria-label="## image-position ##">                             <option value="none">## none ##</option>                             <option value="left">## left ##</option>                             <option value="center">## center ##</option>                             <option value="right">## right ##</option>                         </select>                     </div>                     <div class="form-item form-item-link">                         <label for="modal-image-url">## link ##</label>                         <input type="text" id="modal-image-url" name="url" aria-label="## link ##" />                     </div>                     <div class="form-item form-item-link">                         <label class="checkbox"><input type="checkbox" name="target" aria-label="## link-in-new-tab ##"> ## link-in-new-tab ##</label>                     </div>                 </form>             </div>'},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.caret=t.caret,this.utils=t.utils,this.editor=t.editor,this.storage=t.storage,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection,this.justResized=!1},oninsert:function(){this._observeImages()},onstarted:function(){this.storage.observeImages(),this.opts.imageResizable&&(this.resizer=$R.create("image.resize",this.app)),this._observeImages()},ondropimage:function(t,e,i){if(this.opts.imageUpload){var s={url:this.opts.imageUpload,event:!i&&t,files:e,name:"imagedrop",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.send",s)}},onstop:function(){this.resizer&&this.resizer.stop()},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"image")},onimageresizer:{stop:function(){this.resizer&&this.resizer.hide()}},onsource:{open:function(){this.resizer&&this.resizer.hide()},closed:function(){this._observeImages(),this.resizer&&this.resizer.rebuild()}},onupload:{complete:function(){this._observeImages()},image:{complete:function(t){this._insert(t)},error:function(t){this._uploadError(t)}},imageedit:{complete:function(t){this._change(t)},error:function(t){this._uploadError(t)}},imagedrop:{complete:function(t,e){this._insert(t,e)},error:function(t){this._uploadError(t)}},imagereplace:{complete:function(t){this._change(t,!1)},error:function(t){this._uploadError(t)}}},onmodal:{image:{open:function(t,e){this._setUpload(e)}},imageedit:{open:function(t,e){this._setFormData(t,e)},opened:function(t,e){this._setFormFocus(e)},remove:function(){this._remove(this.$image)},save:function(t,e){this._save(t,e)}}},onimage:{observe:function(){this._observeImages()},resized:function(){this.justResized=!0}},oncontextbar:function(t,e){if(this.justResized)this.justResized=!1;else{var i=this.selection.getCurrent(),s=this.inspector.parse(i);if(!s.isFigcaption()&&s.isComponentType("image")){var n=s.getComponent(),o={edit:{title:this.lang.get("edit"),api:"module.image.open"},remove:{title:this.lang.get("delete"),api:"module.image.remove",args:n}};e.set(t,n,o)}}},open:function(){this.$image=this._getCurrent(),this.app.api("module.modal.build",this._getModalData())},insert:function(t){this._insert(t)},remove:function(t){this._remove(t)},_getModalData:function(){return this._isImage()&&this.opts.imageEditable?{name:"imageedit",width:"800px",title:this.lang.get("edit"),handle:"save",commands:{save:{title:this.lang.get("save")},remove:{title:this.lang.get("delete"),type:"danger"},cancel:{title:this.lang.get("cancel")}}}:{name:"image",title:this.lang.get("image")}},_isImage:function(){return this.$image},_getCurrent:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);return!(!e.isComponentType("image")||!e.isComponentActive())&&this.component.create("image",e.getComponent())},_insert:function(t,e){if(this.app.api("module.modal.close"),Array.isArray(t)){for(var i={},s=0;s<t.length;s++)i=$R.extend(i,t[s]);t=i}else"string"==typeof t&&(t={file:{url:t}});if("object"==typeof t){var n=0;for(var o in t)"object"==typeof t[o]&&n++;n>1?this._insertMultiple(t,e):this._insertSingle(t,e)}},_insertSingle:function(t,e){for(var i in t)if("object"==typeof t[i]){var s=this._createImageAndStore(t[i]),n=e?this.insertion.insertToPoint(e,s,!1,!1):this.insertion.insertHtml(s,!1);this._removeSpaceBeforeFigure(n[0]),this.component.setActive(n[0]),this.app.broadcast("image.uploaded",n[0],t)}},_insertMultiple:function(t,e){var i,s=0,n=[];for(var o in t)if("object"==typeof t[o]){s++;var r=this._createImageAndStore(t[o]);if(1===s)n=e?this.insertion.insertToPoint(e,r,!1,!1):this.insertion.insertHtml(r,!1);else $R.dom(n[0]).after(r),n=[r.get()],this.app.broadcast("image.inserted",r);i=n[0],this._removeSpaceBeforeFigure(n[0]),this.app.broadcast("image.uploaded",n[0],t)}this.component.setActive(i)},_createImageAndStore:function(t){var e=this.component.create("image");return e.addClass("redactor-uploaded-figure"),e.setData({src:t.url,id:t.id?t.id:this.utils.getRandomId()}),this.storage.add("image",e.getElement()),e},_removeSpaceBeforeFigure:function(t){if(t){var e=t.previousSibling;e&&(this._removeInvisibleSpace(e),this._removeInvisibleSpace(e.previousSibling))}},_removeInvisibleSpace:function(t){t&&3===t.nodeType&&-1!==this.utils.searchInvisibleChars(t.textContent)&&t.parentNode.removeChild(t)},_save:function(t,e){var i=e.getData(),s={title:i.title};this.opts.imageLink&&(s.link={url:i.url,target:i.target}),this.opts.imageCaption&&(s.caption=i.caption),this.opts.imagePosition&&(s.align=i.align),this.$image.setData(s),this.resizer&&this.resizer.rebuild(),this.app.broadcast("image.changed",this.$image),this.app.api("module.modal.close")},_change:function(t,e){if("string"==typeof t&&(t={file:{url:t}}),"object"==typeof t){var i;for(var s in t)if("object"==typeof t[s]){(i=$R.dom("<img>")).attr("src",t[s].url),this.$image.changeImage(t[s]),this.app.broadcast("image.changed",this.$image,t),this.app.broadcast("image.uploaded",this.$image,t),this.app.broadcast("hardsync");break}!1!==e&&i.on("load",function(){this.$previewBox.html(i)}.bind(this))}},_uploadError:function(t){this.app.broadcast("image.uploadError",t)},_remove:function(t){this.app.api("module.modal.close"),this.component.remove(t)},_observeImages:function(){var t=this;this.editor.getElement().find("img").each(function(e){var i=$R.dom(e);i.off(".drop-to-replace"),i.on("dragover.drop-to-replace dragenter.drop-to-replace",function(t){t.preventDefault()}),i.on("drop.drop-to-replace",function(e){if(!t.app.isDragComponentInside())return t._setReplaceUpload(e,i)})})},_setFormData:function(t,e){this._buildPreview(),this._buildPreviewUpload();var i=this.$image.getData(),s={title:i.title};this.opts.imageCaption?s.caption=i.caption:t.find(".form-item-caption").hide(),this.opts.imagePosition?s.align=i.align:t.find(".form-item-align").hide(),this.opts.imageLink?i.link&&(s.url=i.link.url,i.link.target&&(s.target=!0)):t.find(".form-item-link").hide(),e.setData(s)},_setFormFocus:function(t){t.getField("title").focus()},_setReplaceUpload:function(t,e){if((t=t.originalEvent||t).stopPropagation(),t.preventDefault(),this.opts.imageUpload){this.$image=this.component.create("image",e);var i={url:this.opts.imageUpload,files:t.dataTransfer.files,name:"imagereplace",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.send",i)}},_setUpload:function(t){var e={url:this.opts.imageUpload,element:t.getField("file"),name:"image",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.build",e)},_buildPreview:function(){this.$preview=$R.dom("#redactor-modal-image-preview");var t=this.$image.getData(),e=$R.dom("<img>");e.attr("src",t.src),this.$previewBox=$R.dom("<div>"),this.$previewBox.append(e),this.$preview.html(""),this.$preview.append(this.$previewBox)},_buildPreviewUpload:function(){if(this.opts.imageUpload){var t=$R.dom('<div class="desc">');t.html(this.lang.get("upload-change-label")),this.$preview.append(t);var e={url:this.opts.imageUpload,element:this.$previewBox,name:"imageedit",paramName:this.opts.imageUploadParam};this.app.api("module.upload.build",e)}}}),$R.add("class","image.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.opts=t.opts,this.selection=t.selection,e&&void 0!==e.cmnt?e:this._init(e)},setData:function(t){for(var e in t)this._set(e,t[e])},getData:function(){for(var t=["src","title","caption","align","link","id"],e={},i=0;i<t.length;i++)e[t[i]]=this._get(t[i]);return e},getElement:function(){return this.$element},changeImage:function(t){this.$element.attr("src",t.url)},_init:function(t){var e=$R.dom(t),i=e.closest("figure");void 0===t?(this.$element=$R.dom("<img>"),this.parse("<figure>"),this.append(this.$element)):0===i.length?(this.parse("<figure>"),this.$element=e,this.$element.wrap(this)):(this.parse(i),this.$element=this.find("img")),this._initWrapper()},_set:function(t,e){this["_set_"+t](e)},_get:function(t){return this["_get_"+t]()},_set_src:function(t){this.$element.attr("src",t)},_set_id:function(t){this.$element.attr("data-image",t)},_set_title:function(t){""===(t=t.trim().replace(/(<([^>]+)>)/gi,""))?this.$element.removeAttr("alt"):this.$element.attr("alt",t)},_set_caption:function(t){var e=this.find("figcaption");return 0===e.length&&((e=$R.dom("<figcaption>")).attr("contenteditable","true"),this.append(e)),""===t?e.remove():e.html(t),e},_set_align:function(t){var e="",i="",s="",n=this,o=this.find("img"),r=this.find("figcaption");if("object"==typeof this.opts.imagePosition){var a=this.opts.imagePosition;for(var l in a)n.removeClass(a[l]);var h=void 0!==a[t]&&a[t];h&&n.addClass(h)}else{var c=o.width();switch(t){case"left":e="left",i="0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin+" 0";break;case"right":e="right",i="0 0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin;break;case"center":s="center"}n.css({float:e,width:c+"px",maxWidth:c+"px",margin:i,"text-align":s}),n.attr("rel",n.attr("style")),"none"===t&&(n.css("max-width",""),n.css("width","")),"center"===t?(n.css("max-width",""),n.css("width",""),r.css("text-align","center")):r.css("text-align","")}},_set_link:function(t){var e=this._findLink();if(""!==t.url)return e||(e=$R.dom("<a>"),this.$element.wrap(e)),e.attr("href",t.url),t.target?e.attr("target",!0===t.target?"_blank":t.target):e.removeAttr("target"),e;e&&e.unwrap()},_get_src:function(){return this.$element.attr("src")},_get_id:function(){return this.$element.attr("data-image")},_get_title:function(){var t=this.$element.attr("alt");return t||""},_get_caption:function(){var t=this.find("figcaption");return 0===t.length?"":t.html()},_get_align:function(){var t="";if("object"==typeof this.opts.imagePosition){t="none";var e=this.opts.imagePosition;for(var i in e)if(this.hasClass(e[i])){t=i;break}}else t="center"===this.css("text-align")?"center":this.css("float");return t},_get_link:function(){var t=this._findLink();if(t){var e=!!t.attr("target");return{url:t.attr("href"),target:e}}},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"image",tabindex:"-1",contenteditable:!1})},_findLink:function(){var t=this.find("a").filter(function(t){return 0===$R.dom(t).closest("figcaption").length});return 0!==t.length&&t}}),$R.add("class","image.resize",{init:function(t){this.app=t,this.$doc=t.$doc,this.$win=t.$win,this.$body=t.$body,this.editor=t.editor,this.toolbar=t.toolbar,this.inspector=t.inspector,this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body,this._init()},rebuild:function(){this._setResizerPosition()},hide:function(){this.$target.find("#redactor-image-resizer").remove()},stop:function(){this.editor.getElement().off(".redactor.image-resize"),this.$doc.off(".redactor.image-resize"),this.$win.off("resize.redactor.image-resize"),this.hide()},_init:function(){this.editor.getElement().on("click.redactor.image-resize",this._build.bind(this)),this.$win.on("resize.redactor.image-resize",this._setResizerPosition.bind(this))},_build:function(t){this.$target.find("#redactor-image-resizer").remove();var e=this.inspector.parse(t.target),i=this.editor.getElement();e.isComponentType("image")&&(this.$resizableBox=i,this.$resizableImage=$R.dom(e.getImageElement()),this.$resizer=$R.dom("<span>"),this.$resizer.attr("id","redactor-image-resizer"),this.$target.append(this.$resizer),this._setResizerPosition(),this.$resizer.on("mousedown touchstart",this._set.bind(this)))},_setResizerPosition:function(){if(this.$resizer){var t=this.toolbar.isTarget(),e=this.$target.offset(),i=t?7-e.top+this.$target.scrollTop():7,s=t?7-e.left:7,n=this.$resizableImage.offset(),o=this.$resizableImage.width(),r=this.$resizableImage.height(),a=this.$resizer.width(),l=this.$resizer.height();this.$resizer.css({top:n.top+r-l+i+"px",left:n.left+o-a+s+"px"})}},_set:function(t){t.preventDefault(),this.resizeHandle={x:t.pageX,y:t.pageY,el:this.$resizableImage,$figure:this.$resizableImage.closest("figure"),ratio:this.$resizableImage.width()/this.$resizableImage.height(),h:this.$resizableImage.height()},(t=t.originalEvent||t).targetTouches&&(this.resizeHandle.x=t.targetTouches[0].pageX,this.resizeHandle.y=t.targetTouches[0].pageY),this.app.broadcast("contextbar.close"),this.app.broadcast("image.resize",this.$resizableImage),this._start()},_start:function(){this.$doc.on("mousemove.redactor.image-resize touchmove.redactor.image-resize",this._move.bind(this)),this.$doc.on("mouseup.redactor.image-resize touchend.redactor.image-resize",this._stop.bind(this))},_stop:function(){this.$doc.off(".redactor.image-resize"),this.app.broadcast("image.resized",this.$resizableImage)},_move:function(t){t.preventDefault(),t=t.originalEvent||t;var e=this.resizeHandle.h;t.targetTouches?e+=t.targetTouches[0].pageY-this.resizeHandle.y:e+=t.pageY-this.resizeHandle.y;var i=e*this.resizeHandle.ratio;e<20||i<100||this._getResizableBoxWidth()<=i||(0!==this.resizeHandle.$figure.length&&""!==this.resizeHandle.$figure.css("max-width")&&this.resizeHandle.$figure.css("max-width",i+"px"),this.resizeHandle.el.attr({width:i,height:e}),this.resizeHandle.el.width(i),this.resizeHandle.el.height(e),this._setResizerPosition())},_getResizableBoxWidth:function(){return this.$resizableBox.width()-parseInt(this.$resizableBox.css("padding-left"))-parseInt(this.$resizableBox.css("padding-right"))}}),$R.add("module","file",{modals:{file:'<div class="redactor-modal-tab" data-title="## upload ##"><form action="">                 <div class="form-item form-item-title">                     <label for="modal-file-title"> ## filename ## <span class="desc">(## optional ##)</span></label>                     <input type="text" id="modal-file-title" name="title" />                 </div>                 <input type="file" name="file">             </form></div>'},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.caret=t.caret,this.utils=t.utils,this.storage=t.storage,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection},onstarted:function(){this.storage.observeFiles()},ondropfile:function(t,e,i){if(this.opts.fileUpload){var s={url:this.opts.fileUpload,event:!i&&t,files:e,name:"filedrop",data:this.opts.fileData};this.app.api("module.upload.send",s)}},onmodal:{file:{open:function(t,e){this._setFormData(t,e),this._setUpload(e)},opened:function(t,e){this._setFormFocus(e),this.$form=e}}},onupload:{file:{complete:function(t){this._insert(t)},error:function(t){this._uploadError(t)}},filedrop:{complete:function(t,e){this._insert(t,e)},error:function(t){this._uploadError(t)}}},open:function(){this._open()},insert:function(t){this._insert(t)},remove:function(t){this._remove(t)},_open:function(){this.app.api("module.modal.build",this._getModalData())},_getModalData:function(){return{name:"file",title:this.lang.get("file")}},_insert:function(t,e){if(this.app.api("module.modal.close"),"object"==typeof t){if(Array.isArray(t)){for(var i={},s=0;s<t.length;s++)i=$R.extend(i,t[s]);t=i}Object.keys(t).length>1?this._insertMultiple(t,e):this._insertSingle(t,e),this.$form=!1}},_insertSingle:function(t,e){var i=[];for(var s in t){var n=this._createFileAndStore(t[s]);i=this.opts.fileAttachment?this._insertAsAttachment(n):e?this.insertion.insertToPoint(e,n):this.insertion.insertRaw(n),this.app.broadcast("file.uploaded",i[0],t)}},_insertMultiple:function(t,e){var i,s=0,n=[];for(var o in t){s++;var r=this._createFileAndStore(t[o]);if(this.opts.fileAttachment)n=this._insertAsAttachment(r,t);else if(1===s)n=e?this.insertion.insertToPoint(e,r):this.insertion.insertRaw(r);else $R.dom(n[0]).after(r).after(" "),n=[r.get()],this.app.broadcast("file.inserted",r);i=r,this.app.broadcast("file.uploaded",n[0],t)}this.opts.fileAttachment||this.caret.setAfter(i)},_insertAsAttachment:function(t,e){var i=$R.dom(this.opts.fileAttachment),s=t.wrapAttachment();i.append(s);var n=[s.get()];return this.app.broadcast("file.appended",n[0],e),n},_createFileAndStore:function(t){var e=!!this.$form&&this.$form.getData(),i=t.name?t.name:t.url,s=!this.opts.fileAttachment&&e&&""!==e.title?e.title:this._truncateUrl(i),n=this.component.create("file");return n.attr("href",t.url),n.attr("data-file",t.id?t.id:this.utils.getRandomId()),n.attr("data-name",t.name),n.html(s),this.storage.add("file",n),n},_remove:function(t){this.selection.save();var e=this.component.create("file",t);!1!==this.app.broadcast("file.delete",e)?(e.unwrap(),this.selection.restore(),this.app.broadcast("file.deleted",e)):this.selection.restore()},_truncateUrl:function(t){return-1!==t.search(/^http/)&&t.length>20?t.substring(0,20)+"...":t},_setUpload:function(t){var e={url:this.opts.fileUpload,element:t.getField("file"),name:"file",data:this.opts.fileData,paramName:this.opts.fileUploadParam};this.app.api("module.upload.build",e)},_setFormData:function(t,e){this.opts.fileAttachment?t.find(".form-item-title").hide():e.setData({title:this.selection.getText()})},_setFormFocus:function(t){t.getField("title").focus()},_uploadError:function(t){this.app.broadcast("file.uploadError",t)}}),$R.add("class","file.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.opts=t.opts,e&&void 0!==e.cmnt?e:this._init(e)},wrapAttachment:function(){return this.$wrapper=$R.dom('<span class="redactor-file-item">'),this.$remover=$R.dom('<span class="redactor-file-remover">'),this.$remover.html("&times;"),this.$remover.on("click",this.removeAttachment.bind(this)),this.$wrapper.append(this),this.$wrapper.append(this.$remover),this.$wrapper},removeAttachment:function(t){t.preventDefault(),!1!==this.app.broadcast("file.delete",this,this.$wrapper)&&(this.$wrapper.remove(),this.app.broadcast("file.deleted",this),this.app.broadcast("file.removeAttachment",this))},_init:function(t){if(void 0===t)this.parse("<a>");else{var e=$R.dom(t).closest("a");this.parse(e)}}}),$R.add("module","buffer",{init:function(t){this.app=t,this.opts=t.opts,this.editor=t.editor,this.offset=t.offset,this.keycodes=t.keycodes,this.selection=t.selection,this.state=!1,this.passed=!1,this.keyPressed=!1,this.undoStorage=[],this.redoStorage=[]},onkeydown:function(t){this._listen(t)},onsyncing:function(){this.keyPressed||this.trigger(),this.keyPressed=!1},onbuffer:{trigger:function(){this.trigger()}},onstate:function(t,e,i){t&&(t.ctrlKey||t.metaKey)||t&&(this._isUndo(t)||this._isRedo(t))||(this.passed=!1,this._saveState(e,i))},onenable:function(){this.clear()},clear:function(){this.state=!1,this.undoStorage=[],this.redoStorage=[]},undo:function(){this._getUndo()},redo:function(){this._getRedo()},trigger:function(){this.state&&!1===this.passed&&this._setUndo()},_saveState:function(t,e){var i=this.editor.getElement();this.state={html:t||i.html(),offset:e||this.offset.get()}},_listen:function(t){var e=t.which,i=t.ctrlKey||t.metaKey,s=i||t.shiftKey||t.altKey,n=[this.keycodes.SPACE,this.keycodes.ENTER,this.keycodes.BACKSPACE,this.keycodes.DELETE,this.keycodes.TAB,this.keycodes.LEFT,this.keycodes.RIGHT,this.keycodes.UP,this.keycodes.DOWN];return this._isUndo(t)?(t.preventDefault(),void this.undo()):this._isRedo(t)?(t.preventDefault(),void this.redo()):((i||-1===n.indexOf(e))&&(!i||88!==e&&67!==e)||(s=!0,this.trigger()),s||this._hasUndo()||this.trigger(),void(this.keyPressed=!0))},_isUndo:function(t){var e=t.which;return(t.ctrlKey||t.metaKey)&&90===e&&!t.shiftKey&&!t.altKey},_isRedo:function(t){var e=t.which;return(t.ctrlKey||t.metaKey)&&(90===e&&t.shiftKey||89===e&&!t.shiftKey)&&!t.altKey},_setUndo:function(){var t=this.undoStorage[this.undoStorage.length-1];void 0!==t&&t[0]===this.state.html||(this.undoStorage.push([this.state.html,this.state.offset]),this._removeOverStorage())},_setRedo:function(){var t=this.editor.getElement(),e=this.offset.get(),i=t.html();this.redoStorage.push([i,e]),this.redoStorage=this.redoStorage.slice(0,this.opts.bufferLimit)},_getUndo:function(){if(this._hasUndo()){this.passed=!0;var t=this.editor.getElement(),e=this.undoStorage.pop();this._setRedo(),t.html(e[0]),this.offset.set(e[1]),this.selection.restore(),this.app.broadcast("undo",e[0],e[1])}},_getRedo:function(){if(this._hasRedo()){this.passed=!0;var t=this.editor.getElement(),e=this.redoStorage.pop();this._setUndo(),t.html(e[0]),this.offset.set(e[1]),this.app.broadcast("redo",e[0],e[1])}},_removeOverStorage:function(){this.undoStorage.length>this.opts.bufferLimit&&(this.undoStorage=this.undoStorage.slice(0,this.undoStorage.length-this.opts.bufferLimit))},_hasUndo:function(){return 0!==this.undoStorage.length},_hasRedo:function(){return 0!==this.redoStorage.length}}),$R.add("module","list",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.block=t.block,this.toolbar=t.toolbar,this.inspector=t.inspector,this.selection=t.selection},onbutton:{list:{observe:function(t){this._observeButton(t)}}},ondropdown:{list:{observe:function(t){this._observeDropdown(t)}}},toggle:function(t){var e=this._getBlocks(),i=this.selection.getBlock(),s=$R.dom(i).parents("ul, ol",".redactor-in").last();return 0===e.length&&0!==s.length&&(e=[s.get()]),!i||"TD"!==i.tagName&&"TH"!==i.tagName||(e=this.block.format("div")),this.selection.saveMarkers(),e=0!==e.length&&this._isUnformat(t,e)?this._unformat(t,e):this._format(t,e),this.selection.restoreMarkers(),e},indent:function(){var t=this.selection.isCollapsed(),e=this.selection.getCurrent(),i=this.inspector.parse(e),s=!!i.isList()&&i.getListItem(),n=$R.dom(s),o=n.prevElement(),r=o.get();if(t&&s&&r&&"LI"===r.tagName){this.selection.saveMarkers();var a=(o=$R.dom(r)).children("ul, ol"),l=n.closest("ul, ol");if(0!==a.length)a.append(n);else{var h=l.get().tagName.toLowerCase(),c=$R.dom("<"+h+">");c.append(n),o.append(c)}this.selection.restoreMarkers()}},outdent:function(){var t=this.selection.isCollapsed(),e=this.selection.getCurrent(),i=this.inspector.parse(e),s=!!i.isList()&&i.getListItem(),n=$R.dom(s);if(t&&s){var o,r,a,l=n.parent(),h=l.closest("li",".redactor-in"),c=n.prevElement(),d=n.nextElement(),u=c.get(),p=d.get(),f=!1===u,m=!1!==u&&!1!==p,g=!f&&!1===p;if(this.selection.saveMarkers(),0!==h.length)if(m){o=this._getAllNext(n.get()),a=$R.dom("<"+l.get().tagName.toLowerCase()+">");for(var v=0;v<o.length;v++)a.append(o[v]);h.after(n),n.append(a)}else h.after(n),0===l.children().length?l.remove():f&&n.append(l);else{var b=this._createUnformatContainer(n),_=b.find("ul, ol").first();if(f)l.before(b);else if(g)l.after(b);else if(m){a=$R.dom("<"+l.get().tagName.toLowerCase()+">"),o=this._getAllNext(n.get());for(v=0;v<o.length;v++)a.append(o[v]);l.after(b),b.after(a)}0!==_.length&&((r=b.nextElement().get())&&r.tagName===l.get().tagName?($R.dom(r).prepend(_),_.unwrap()):b.after(_)),n.remove()}this.selection.restoreMarkers()}},_getAllNext:function(t){for(var e=[];t;){if(!(t=$R.dom(t).nextElement().get()))return e;e.push(t)}return e},_isUnformat:function(t,e){for(var i=0,s=0;s<e.length;s++)if(3!==e[s].nodeType){var n=e[s].tagName.toLowerCase();n!==t&&"figure"!==n||i++}return i===e.length},_format:function(t,e){var i=this._uniteBlocks(e,["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6","ul","ol"]),s=[];for(var n in i){for(var o=i[n],r=this._createList(t,i[n]),a=0;a<o.length;a++){var l;if(3===o[a].nodeType||"UL"!==o[a].tagName&&"OL"!==o[a].tagName)l=this._createListItem(o[a]),this.utils.normalizeTextNodes(l),r.append(l);else{var h=$R.dom(o[a]);l=h.contents(),r.append(l),this.utils.isEmpty(h)&&h.remove()}}s.push(r.get())}return s},_uniteBlocks:function(t,e){for(var i=0,s={0:[]},n=!1,o=0;o<t.length;o++){var r=$R.dom(t[o]).closest("th, td");0!==r.length?(r.get()!==n&&(s[++i]=[]),this._isUniteBlock(t[o],e)&&s[i].push(t[o])):this._isUniteBlock(t[o],e)?s[i].push(t[o]):s[++i]=[],n=r.get()}return s},_isUniteBlock:function(t,e){return 3===t.nodeType||-1!==e.indexOf(t.tagName.toLowerCase())},_createList:function(t,e){var i=e[e.length-1],s=$R.dom(i),n=$R.dom("<"+t+">");return s.after(n),n},_createListItem:function(t){var e=$R.dom("<li>");if(3===t.nodeType)e.append(t);else{var i=$R.dom(t);e.append(i.contents()),i.remove()}return e},_unformat:function(t,e){if(1===e.length){var i=$R.dom(e[0]),s=i.find("li"),n=this.selection.getNodes({tags:["li"]}),o=this.selection.getBlock(),r=$R.dom(o).closest("li");if(0===n.length&&0!==r.length&&(n=[r.get()]),n.length===s.length)return this._unformatEntire(e[0]);var a=this._getItemsPosition(s,n);if("Top"===a)return this._unformatAtSide("before",n,i);if("Bottom"===a)return n.reverse(),this._unformatAtSide("after",n,i);if("Middle"===a){var l=$R.dom(n[n.length-1]),h=!1,c=!1,d=$R.dom("<"+i.get().tagName.toLowerCase()+">");s.each(function(t){if(h){var e=$R.dom(t);0!==e.closest(".redactor-split-item").length||!1!==c&&0!==e.closest(c).length||e.addClass("redactor-split-item"),c=e}t===l.get()&&(h=!0)}),s.filter(".redactor-split-item").each(function(t){$R.dom(t).removeClass("redactor-split-item"),d.append(t)}),i.after(d),n.reverse();for(var u=0;u<n.length;u++){var p=$R.dom(n[u]),f=this._createUnformatContainer(p);i.after(f),f.find("ul, ol").remove(),p.remove()}return}}else for(u=0;u<e.length;u++)3!==e[u].nodeType&&e[u].tagName.toLowerCase()===t&&this._unformatEntire(e[u])},_unformatEntire:function(t){var e=$R.dom(t);e.find("li").each(function(t){var i=$R.dom(t),s=this._createUnformatContainer(i);i.remove(),e.before(s)}.bind(this)),e.remove()},_unformatAtSide:function(t,e,i){for(var s=0;s<e.length;s++){var n=$R.dom(e[s]),o=this._createUnformatContainer(n);i[t](o);var r=o.find("ul, ol").first();n.append(r),r.each(function(t){var i=$R.dom(t),n=i.closest("li");n.get()===e[s]&&(i.unwrap(),n.addClass("r-unwrapped"))}),this.utils.isEmptyHtml(n.html())&&n.remove()}i.find(".r-unwrapped").each(function(t){var e=$R.dom(t);""===e.html().trim()?e.remove():e.removeClass("r-unwrapped")})},_getItemsPosition:function(t,e){var i="Middle",s=e[0],n=e[e.length-1],o=t.first().get(),r=t.last().get();return o===s&&r!==n?i="Top":o!==s&&r===n&&(i="Bottom"),i},_createUnformatContainer:function(t){var e=$R.dom("<"+this.opts.markup+">");return this.opts.breakline&&e.attr("data-redactor-tag","br"),e.append(t.contents()),e},_getBlocks:function(){return this.selection.getBlocks({first:!0})},_observeButton:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t),i=e.isPre()||e.isCode()||e.isFigcaption();this._observeButtonsList(i,["lists","ul","ol","outdent","indent"]);var s=this.toolbar.getButton("outdent"),n=this.toolbar.getButton("indent");this._observeIndent(n,s)},_observeDropdown:function(t){var e=t.getItem("outdent"),i=t.getItem("indent");this._observeIndent(i,e)},_observeIndent:function(t,e){var i=this.selection.isCollapsed(),s=this.selection.getCurrent(),n=this.inspector.parse(s),o=!!n.isList()&&n.getListItem(),r=$R.dom(o).prevElement().get(),a=i&&o&&r&&"LI"===r.tagName;e&&(o&&i?e.enable():e.disable()),t&&(o&&a?t.enable():t.disable())},_observeButtonsList:function(t,e){for(var i=0;i<e.length;i++){var s=this.toolbar.getButton(e[i]);s&&(t?s.disable():s.enable())}}}),$R.add("class","video.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},_init:function(t){if(void 0!==t){var e=$R.dom(t).closest("figure");0!==e.length?this.parse(e):(this.parse("<figure>"),this.append(t))}else this.parse("<figure>");this._initWrapper()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"video",tabindex:"-1",contenteditable:!1})}}),$R.add("class","widget.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},getData:function(){return{html:this._getHtml()}},_init:function(t){if(void 0!==t){var e=$R.dom(t).closest("figure");0!==e.length?this.parse(e):(this.parse("<figure>"),this.html(t))}else this.parse("<figure>");this._initWrapper()},_getHtml:function(){var t=$R.dom("<div>");return t.html(this.html()),t.find(".redactor-component-caret").remove(),t.html()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"widget",tabindex:"-1",contenteditable:!1})}}),window.Redactor=window.$R=$R,window.addEventListener("load",function(){$R("[data-redactor]")})}();
=======
/*
	Redactor 10.2.2
	Updated: July 15, 2015

	http://imperavi.com/redactor/

	Copyright (c) 2009-2015, Imperavi LLC.
	License: http://imperavi.com/redactor/license/

	Usage: $('#content').redactor();
*/
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('(C($){\'mI m0\';if(!g7.5w.aH){g7.5w.aH=C(eW){E fn=q;F C(){F fn.9E(eW)}}}E 2G=0;$.fn.I=C(44){E 2K=[];E eI=9F.5w.ct.6e(fA,1);if(1s 44===\'6Z\'){q.1B(C(){E 6u=$.1f(q,\'I\');E 1C;if(44.3N(/\\./)!=\'-1\'){1C=44.4o(\'.\');if(1s 6u[1C[0]]!=\'1y\'){1C=6u[1C[0]][1C[1]]}}N{1C=6u[44]}if(1s 6u!==\'1y\'&&$.5k(1C)){E 9L=1C.9E(6u,eI);if(9L!==1y&&9L!==6u){2K.2N(9L)}}N{$.6U(\'lX lL bx "\'+44+\'" 2B 47\')}})}N{q.1B(C(){$.1f(q,\'I\',{});$.1f(q,\'I\',47(q,44))})}if(2K.12===0)F q;N if(2K.12===1)F 2K[0];N F 2K};C 47(el,44){F 2a 47.5w.3Q(el,44)}$.47=47;$.47.l2=\'10.2.2\';$.47.d4=[\'3b\',\'3r\',\'R\',\'25\',\'2o\',\'1t\',\'1V\',\'1x\',\'1e\',\'1X\',\'1n\',\'22\',\'2n\',\'M\',\'3y\',\'28\',\'1Y\',\'1D\',\'2s\',\'1H\',\'3K\',\'V\',\'2z\',\'2e\',\'1a\',\'1R\',\'2V\',\'5C\',\'3f\',\'5E\',\'J\',\'6m\',\'2H\',\'1I\',\'1A\',\'1v\',\'L\'];$.47.G={1H:\'en\',d7:\'l1\',8r:O,2n:O,fP:O,3f:O,6r:1q,6S:O,aG:O,aI:O,1M:O,5Q:1q,2V:1q,fh:O,al:1q,jJ:1q,hj:1q,hL:O,3r:O,d5:O,9m:60,d6:O,9O:O,j4:1q,5c:\'8s\',hR:O,cs:50,dq:1q,hE:1q,hH:1q,8x:\'lE\',dp:1q,75:4e,k1:\'22\',lh:O,fB:1q,76:4e,k2:\'22\',fF:1q,7V:O,a2:1q,c1:1q,bX:1q,93:1q,6v:4,9Y:O,fp:1q,9p:O,1A:1q,iS:1q,6y:1l,6z:0,bf:O,iO:O,4E:1q,4i:[\'B\',\'3a\',\'4n\',\'4m\',\'5Y\',\'5m\',\'5z\',\'7p\',\'3y\',\'M\',\'22\',\'V\',\'3b\',\'b3\'],cw:[],cv:[],3a:[\'p\',\'29\',\'2F\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\'],dT:O,2H:1q,4c:[\'3V\',\'1o\'],4z:O,ej:[\'3W\',\'1i\',\'2F\',\'64\',\'3p\',\'ol\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\',\'dl\',\'29\',\'7Y\',\'du\',\'49\',\'87\',\'c8\',\'eE\',\'eS\',\'41\',\'1o\',\'3V\',\'4R\',\'7z\',\'3D\',\'2v\',\'1t\',\'42\',\'iA\',\'fx\',\'lf\',\'hr\',\'iT\',\'lj\',\'l7\',\'pJ\',\'6K\',\'pD\',\'pw\',\'pC\',\'p\'],6G:O,5B:[[\'7c\',\'4h\'],[\'b\',\'5i\']],5A:[[\'3R-7I:\\\\s?4n\',"5i"],[\'3R-1o:\\\\s?4m\',"em"],[\'1g-7a:\\\\s?5x\',"u"],[\'1g-7a:\\\\s?3K-eP\',\'4h\']],5y:O,1K:O,4T:O,6L:[\'1j\'],4f:[\'p\'],b5:[\'5Y\',\'4m\',\'4n\',\'5x\',\'5m\',\'5z\',\'pL\',\'pU\',\'pT\',\'9d\'],cg:{b:\'4n\',5i:\'4n\',i:\'4m\',em:\'4m\',4h:\'5Y\',7c:\'5Y\',3p:\'5m\',ol:\'5z\',u:\'5x\'},6m:{\'48+6E+m, 5h+6E+m\':{1C:\'28.dm\'},\'48+b, 5h+b\':{1C:\'28.30\',6p:[\'4n\']},\'48+i, 5h+i\':{1C:\'28.30\',6p:[\'4m\']},\'48+h, 5h+h\':{1C:\'28.30\',6p:[\'hv\']},\'48+l, 5h+l\':{1C:\'28.30\',6p:[\'hq\']},\'48+k, 5h+k\':{1C:\'V.2O\'},\'48+6E+7\':{1C:\'2e.3m\',6p:[\'5z\']},\'48+6E+8\':{1C:\'2e.3m\',6p:[\'5m\']}},js:O,25:[],9k:[],5S:\'<p>&#9T;</p>\',6o:\'&#9T;\',kb:[\'M/jG\',\'M/pW\',\'M/jN\'],ad:20,cW:[\'a\',\'1L\',\'b\',\'5i\',\'7l\',\'7Q\',\'i\',\'em\',\'u\',\'9f\',\'7c\',\'4h\',\'8S\',\'3p\',\'ol\',\'li\'],4N:[\'5i\',\'b\',\'u\',\'em\',\'i\',\'1e\',\'4h\',\'pX\',\'aN\',\'aS\',\'7Q\',\'7l\',\'6A\',\'E\',\'8S\',\'9f\'],8F:[\'P\',\'dK\',\'di\',\'cS\',\'cR\',\'cI\',\'cH\',\'pM\',\'pc\',\'pd\',\'89\',\'6F\',\'aK\',\'pe\',\'hM\',\'p8\',\'p2\',\'ph\',\'nA\',\'nB\',\'oH\'],8q:[\'8o\',\'8D\',\'8N\',\'5v\'],cA:O,1R:{79:[]},kn:{en:{B:\'oG\',6Y:\'6B gx\',M:\'6B hO\',3W:\'dz\',V:\'cO\',ba:\'6B V\',ca:\'jh V\',6P:\'oD\',3a:\'oW\',j2:\'ox 1g\',ci:\'oe\',1e:\'gS\',jb:\'9H 1\',jH:\'9H 2\',jI:\'9H 3\',jM:\'9H 4\',jD:\'9H 5\',4n:\'ou\',4m:\'qO\',om:\'oo j9\',ok:\'op j9\',5m:\'ov jK\',5z:\'os jK\',7p:\'ob\',3y:\'oy\',it:\'oE\',1Y:\'6B\',3o:\'oF\',hK:\'8w\',nk:\'6B dz\',nj:\'9r dV np\',ng:\'9r dV n3\',nb:\'9r co hU\',nU:\'9r co hS\',nZ:\'8w co\',nV:\'8w dV\',nI:\'8w dz\',nH:\'qj\',q2:\'q6\',qa:\'9r hl\',qt:\'8w hl\',1J:\'qM\',cC:\'qL\',5p:\'qK\',2c:\'hU\',4s:\'hS\',5u:\'gn\',qy:\'hO qB cO\',1g:\'pj\',bY:\'pi\',pn:\'cD\',po:\'gx p4 gS or pR/pK cO\',22:\'6B pI\',1v:\'pH\',lo:\'ld\',gc:\'lH\',lI:\'lA gc\',kY:\'jo 22 jm\',jt:\'gz 1g hB eZ 2c\',jx:\'gn 1g\',jB:\'gz 1g hB eZ 4s\',jA:\'m9 1g\',b3:\'6B m5 mc\',5Y:\'mC\',gV:\'ly\',aL:\'lv V in 2a 5I\',5x:\'lC\',3b:\'lu\',6k:\'lc (nE)\',7L:\'jh\',kD:\'jo 22 jm or \'}},2z:{4v:{72:/5o?:\\/\\/(?:[0-9A-Z-]+\\.)?(?:lx\\.be\\/|72\\.a5\\S*[^\\w\\-\\s])([\\w\\-]{11})(?=[^\\w\\-]|$)(?![?=&+%\\w.\\-]*(?:[\'"][^<>]*>|<\\/a>))[?=&+%\\w.-]*/ig,71:/5o?:\\/\\/(7n\\.)?71.a5\\/(\\d+)($|\\/)/,M:/((5o?|7n)[^\\s]+\\.)(lK?g|jG|jN)(\\?[^\\s-]+)?/ig,2i:/(5o?:\\/\\/(?:7n\\.|(?!7n))[^\\s\\.]+\\.[^\\s]{2,}|7n\\.[^\\s]+\\.[^\\s]{2,})/ig,}},8n:O};47.fn=$.47.5w={3j:{84:8,8Q:46,l0:38,dW:40,70:13,a7:32,b2:27,dx:9,fK:17,fL:91,fU:16,fM:18,eB:39,lD:37,g0:91},3Q:C(el,44){q.$2j=$(el);q.2G=2G++;q.7B=O;q.$5e=O;q.jz(44);q.jy();q.3a={};$.mB(q.G.8q,q.G.8F);q.gm=2a 2l(\'^(\'+q.G.8q.3c(\'|\')+\')$\',\'i\');q.1I.ja();if(q.G.4c!==O){E 2d=[\'B\',\'e0\',\'V\',\'31\',\'5h\',\'mE\'];2B(E i=0;i<2d.12;i++){q.G.4c.2N(2d[i])}}q.1H.2R();$.7E(q.G.6m,q.G.js);q.1X.2u(\'2b\');q.2b=1q;q.2o.ki()},jz:C(44){q.G=$.7E({},$.7E(1q,{},$.47.G),q.$2j.1f(),44)},dg:C(41){F g8.mw(41).bW(C(ai){F 1s 41[ai]==\'C\'})},jy:C(){E 2p=$.47.d4.12;2B(E i=0;i<2p;i++){q.iq($.47.d4[i])}},iq:C(6D){if(1s q[6D]==\'1y\')F;q[6D]=q[6D]();E 5X=q.dg(q[6D]);E 2p=5X.12;2B(E z=0;z<2p;z++){q[6D][5X[z]]=q[6D][5X[z]].aH(q)}},3b:C(){F{2c:C(){q.3b.1U(\'\')},4s:C(){q.3b.1U(\'4s\')},5u:C(){q.3b.1U(\'5u\')},9d:C(){q.3b.1U(\'9d\')},1U:C(1m){if(!q.L.1P(\'2E\'))q.$T.2n();q.25.1U();q.J.3o();q.3b.1Z=q.J.3X();q.3b.1m=1m;if(q.3b.ix()){q.3b.im()}N{q.3b.iy()}q.J.3d();q.1e.1S()},im:C(){E 4M=q.J.5Z(\'1i\');$(4M).1c(\'1f-8b\',\'I\').1O(\'1g-5g\',q.3b.1m)},iy:C(){$.1B(q.3b.1Z,$.1d(C(i,el){E $el=q.L.bh(el);if(!$el)F;if(q.3b.il($el)){q.3b.i6($el)}N{q.3b.ib($el)}},q))},ix:C(){F(q.G.1M&&q.3b.1Z[0]===O)},il:C($el){F(q.3b.1m===\'\'&&1s($el.1f(\'8b\'))!==\'1y\')},i6:C($el){$el.2t($el.B())},ib:C($el){$el.1O(\'1g-5g\',q.3b.1m);q.L.5r($el,\'1o\')}}},3r:C(){F{B:O,9Q:C(){if(!q.G.3r)F;q.3r.1w=(q.G.d5)?q.G.d5:q.$2v.1c(\'1w\');if(q.G.d6)F;q.9m=m3(q.3r.2R,q.G.9m*m1)},h7:C(){if(!q.G.d6)F;q.3r.2R()},2R:C(){q.3r.4E=q.1e.1b();if(q.3r.B===q.3r.4E)F;E 1f={};1f[\'1w\']=q.3r.1w;1f[q.3r.1w]=q.3r.4E;1f=q.3r.6V(1f);E ih=$.lU({2i:q.G.3r,1m:\'lM\',1f:1f});ih.lT(q.3r.iR)},6V:C(1f){if(q.G.9O===O||1s q.G.9O!==\'41\'){F 1f}$.1B(q.G.9O,$.1d(C(k,v){if(v!==4e&&v.4y().4Q(\'#\')===0)v=$(v).2K();1f[k]=v},q));F 1f},iR:C(1f){E 2P;52{2P=$.jY(1f)}51(e){2P=1f}E iY=(1s 2P.6U==\'1y\')?\'3r\':\'mg\';q.1X.2u(iY,q.3r.1w,2P);q.3r.B=q.3r.4E},ml:C(){gu(q.9m)}}},R:C(){F{3a:C(1w){q.R.b1=O;E 1m,1E;if(1s q.3a[1w].1f!=\'1y\')1m=\'1f\';N if(1s q.3a[1w].1c!=\'1y\')1m=\'1c\';N if(1s q.3a[1w][\'1G\']!=\'1y\')1m=\'1G\';if(1s q.3a[1w].8M!=\'1y\'){q.R.b1=1q}if(1m)1E=q.3a[1w][1m];q.R.30(q.3a[1w].Y,1m,1E)},30:C(Y,1m,1E){if(Y==\'ci\')Y=\'29\';E iF=[\'p\',\'2F\',\'29\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\'];if($.3t(Y,iF)==-1)F;q.R.8I=(Y==\'2F\'||Y.3N(/h[1-6]/i)!=-1);if(!q.L.1P(\'2E\'))q.$T.2n();E B=$.3k(q.$T.B());q.R.3z=q.L.3z(B);if(q.L.1P(\'4b\')&&!q.2n.dO()){if(q.R.3z){E $3I;if(!q.G.1M){$3I=q.$T.3O().3I();q.1V.3P($3I)}}}q.R.1Z=q.J.3X();q.R.7w=q.R.1Z.12;q.R.1m=1m;q.R.1E=1E;q.25.1U();q.J.3o();q.R.1U(Y);q.J.3d();q.1e.1S();q.1R.2R()},1U:C(Y){q.J.1b();q.R.69=q.14.iL.1p;if(q.14.53){q.R.iE(Y)}N{q.R.iB(Y)}},iE:C(Y){if(q.G.1M&&q.R.3z&&Y!=\'p\'){E Q=1l.3w(Y);q.$T.B(Q);q.1V.3P(Q);F}E R=q.R.1Z[0];if(R===O)F;if(R.1p==\'5v\'){if(Y!=\'29\')F;q.R.aF();F}E 9P=(q.R.69==\'6F\'||q.R.69==\'dn\');if(9P&&!q.G.1M){1l.3Z(\'9S\',O,\'<\'+Y+\'>\');R=q.J.4a();q.R.3m($(R))}N if(R.1p.3e()!=Y){if(q.G.1M&&Y==\'p\'){$(R).1F(\'<br>\');q.L.6i(R)}N{E $1W=q.L.4I(R,Y);q.R.3m($1W);if(Y!=\'p\'&&Y!=\'29\')$1W.1h(\'1L\').1u();if(q.R.8I)q.L.4Z($1W);if(Y==\'p\'||q.R.d2)$1W.1h(\'p\').26().3Y();q.R.d0($1W)}}N if(Y==\'29\'&&R.1p.3e()==Y){if(q.G.1M){$(R).1F(\'<br>\');q.L.6i(R)}N{E $el=q.L.4I(R,\'p\');q.R.3m($el)}}N if(R.1p.3e()==Y){q.R.3m($(R))}if(1s q.R.1m==\'1y\'&&1s q.R.1E==\'1y\'){$(R).1K(\'1G\').1K(\'1o\')}},iB:C(Y){E R=q.R.1Z[0];E 9P=(q.R.69==\'6F\'||q.R.69==\'dn\');if(R!==O&&q.R.7w===1){if(R.1p.3e()==Y&&Y==\'29\'){if(q.G.1M){$(R).1F(\'<br>\');q.L.6i(R)}N{E $el=q.L.4I(R,\'p\');q.R.3m($el)}}N if(R.1p==\'5v\'){if(Y!=\'29\')F;q.R.aF()}N if(q.R.69==\'aK\'){q.R.kS(Y)}N if(q.G.1M&&((9P)||(q.14.iL!=R))){q.R.aE(Y)}N{if(q.G.1M&&Y==\'p\'){$(R).6t(\'<br>\').1F(\'<br>\');q.L.6i(R)}N if(R.1p===\'6F\'){q.R.aE(Y)}N{E $1W=q.L.4I(R,Y);q.R.3m($1W);if(q.R.8I)q.L.4Z($1W);if(Y==\'p\'||q.R.d2)$1W.1h(\'p\').26().3Y()}}}N{if(q.G.1M||Y!=\'p\'){if(Y==\'29\'){E d3=0;2B(E i=0;i<q.R.7w;i++){if(q.R.1Z[i].1p==\'aK\')d3++}if(d3==q.R.7w){$.1B(q.R.1Z,$.1d(C(i,s){E $1W=O;if(q.G.1M){$(s).6t(\'<br>\').1F(\'<br>\');$1W=q.L.6i(s)}N{$1W=q.L.4I(s,\'p\')}if($1W&&1s q.R.1m==\'1y\'&&1s q.R.1E==\'1y\'){$1W.1K(\'1G\').1K(\'1o\')}},q));F}}q.R.aE(Y)}N{E 8B=0;E 5G=O;if(q.R.1m==\'1G\'){5G=\'3m\';8B=$(q.R.1Z).bW(\'.\'+q.R.1E).12;if(q.R.7w==8B)5G=\'3m\';N if(q.R.7w>8B)5G=\'1U\';N if(8B===0)5G=\'1U\'}E 9y=[\'3p\',\'ol\',\'li\',\'2Y\',\'5P\',\'dl\',\'dt\',\'dd\'];$.1B(q.R.1Z,$.1d(C(i,s){if($.3t(s.1p.3e(),9y)!=-1)F;E $1W=q.L.4I(s,Y);if(5G){if(5G==\'3m\')q.R.3m($1W);N if(5G==\'1u\')q.R.1u($1W);N if(5G==\'1U\')q.R.kt($1W)}N q.R.3m($1W);if(Y!=\'p\'&&Y!=\'29\')$1W.1h(\'1L\').1u();if(q.R.8I)q.L.4Z($1W);if(Y==\'p\'||q.R.d2)$1W.1h(\'p\').26().3Y();if(1s q.R.1m==\'1y\'&&1s q.R.1E==\'1y\'){$1W.1K(\'1G\').1K(\'1o\')}},q))}}},kt:C($el){if(q.R.b1){$el.1K(\'1G\').1K(\'1o\')}if(q.R.1m==\'1G\'){$el.2f(q.R.1E);F}N if(q.R.1m==\'1c\'||q.R.1m==\'1f\'){$el.1c(q.R.1E.1w,q.R.1E.1E);F}},3m:C($el){if(q.R.b1){$el.1K(\'1G\').1K(\'1o\')}if(q.R.1m==\'1G\'){$el.7O(q.R.1E);F}N if(q.R.1m==\'1c\'||q.R.1m==\'1f\'){if($el.1c(q.R.1E.1w)==q.R.1E.1E){$el.1K(q.R.1E.1w)}N{$el.1c(q.R.1E.1w,q.R.1E.1E)}F}N{$el.1K(\'1o 1G\');F}},1u:C($el){$el.2S(q.R.1E)},aF:C(){E R=$(q.R.1Z[0]).2q(\'3p, ol\',q.$T[0]);$(R).1h(\'3p, ol\').26().3Y();$(R).1h(\'li\').1F($(\'<br>\')).26().3Y();E $el=q.L.4I(R,\'29\');q.R.3m($el)},kS:C(Y){1l.3Z(\'7p\');1l.3Z(\'9S\',O,Y);q.1x.4r();q.$T.1h(\'p:kh\').1u();E 1W=q.J.4a();if(Y!=\'p\'){$(1W).1h(\'1L\').1u()}if(!q.G.1M){q.R.3m($(1W))}q.$T.1h(\'3p, ol, 6O, 29, p\').1B($.1d(q.L.4f,q));if(q.G.1M&&Y==\'p\'){q.L.6i(1W)}},aE:C(Y){if(q.R.69==\'8D\'||q.R.69==\'8N\'){if(Y==\'29\'){q.R.aF()}N{F}}E 1W=q.J.5Z(Y);if(1W===O)F;E $1W=$(1W);q.R.d0($1W);E $jR=$1W.1h(q.G.8q.3c(\',\')+\', 2Y, 3W, e7, ee, e3, 5P, 6O\');$jR.26().3Y();if(Y!=\'p\'&&Y!=\'29\')$1W.1h(\'1L\').1u();$.1B(q.R.1Z,$.1d(q.L.4f,q));$1W.1F(q.J.6Q(2));if(!q.G.1M){q.R.3m($1W)}q.$T.1h(\'3p, ol, 6O, 29, p\').1B($.1d(q.L.4f,q));$1W.1h(\'29:kh\').1u();if(q.R.8I){q.L.4Z($1W)}if(q.G.1M&&Y==\'p\'){q.L.6i($1W)}if(q.G.1M){E $1N=$1W.1N().1N();if($1N.9B()!=0&&$1N[0].1p===\'58\'){$1N.1u()}}},d0:C($1W){if($1W.2q(\'3W\',q.$T[0]).12===0)F;if($1W.2q(\'6O\',q.$T[0]).12===0)$1W.5Z(\'<6O>\');if($1W.2q(\'2Y\',q.$T[0]).12===0&&$1W.2q(\'5P\').12===0){$1W.5Z(\'<2Y>\')}},gv:C(1w,1E){E 1Z=q.J.3X();$(1Z).1K(\'1f-\'+1w);q.1e.1S()},mZ:C(1w,1E){E 1Z=q.J.3X();$(1Z).1c(\'1f-\'+1w,1E);q.1e.1S()},mY:C(1w,1E){E 1Z=q.J.3X();$.1B(1Z,C(){if($(q).1c(\'1f-\'+1w)){$(q).1K(\'1f-\'+1w)}N{$(q).1c(\'1f-\'+1w,1E)}})},1K:C(1c,1E){E 1Z=q.J.3X();$(1Z).1K(1c);q.1e.1S()},mX:C(1c,1E){E 1Z=q.J.3X();$(1Z).1c(1c,1E);q.1e.1S()},mW:C(1c,1E){E 1Z=q.J.3X();$.1B(1Z,C(){if($(q).1c(1w)){$(q).1K(1w)}N{$(q).1c(1w,1E)}})},2S:C(3E){E 1Z=q.J.3X();$(1Z).2S(3E);q.L.5r(1Z,\'1G\');q.1e.1S()},8g:C(3E){E 1Z=q.J.3X();$(1Z).2f(3E);q.1e.1S()},7O:C(3E){E 1Z=q.J.3X();$(1Z).7O(3E);q.1e.1S()}}},25:C(){F{1U:C(1m){if(1s 1m==\'1y\'||1m==\'9l\'){q.25.kV()}N{q.25.kM()}},kV:C(){q.J.3o();q.G.25.2N(q.$T.B());q.J.3d()},kM:C(){q.J.3o();q.G.9k.2N(q.$T.B());q.J.3d()},kd:C(){q.$T.B(q.G.25.kW())},kj:C(){q.$T.B(q.G.9k.kW())},cQ:C(){q.G.25.2N(q.$T.B())},9l:C(){if(q.G.25.12===0)F;q.25.1U(\'a9\');q.25.kd();q.J.3d();3A($.1d(q.1R.2R,q),50)},a9:C(){if(q.G.9k.12===0)F;q.25.1U(\'9l\');q.25.kj();q.J.3d();3A($.1d(q.1R.2R,q),50)}}},2o:C(){F{ki:C(){q.2o.jW();q.2o.kz();q.2o.kK();q.2o.kF();q.2o.k5()},aa:C(){F(q.$2j[0].1p===\'mu\')},jW:C(){q.$2Q=$(\'<1i 1G="I-2Q" 9c="mq" />\')},k7:C(){q.$2v=$(\'<2v />\').1c(\'1w\',q.2o.ku())},ku:C(){F((1s(1w)==\'1y\'))?\'d1-\'+q.2G:q.$2j.1c(\'id\')},kz:C(){E 1C=(q.2o.aa())?\'2K\':\'B\';q.d1=$.3k(q.$2j[1C]())},kF:C(){q.$T.1c({\'5d\':1q,\'kU\':q.G.d7})},kK:C(){E 1C=(q.2o.aa())?\'kk\':\'ke\';q.2o[1C]()},kk:C(){q.$T=$(\'<1i />\');q.$2v=q.$2j;q.$2Q.jX(q.$2j).1F(q.$T).1F(q.$2j);q.$T.2f(\'I-T\');q.$2j.3v()},ke:C(){q.$T=q.$2j;q.2o.k7();q.$2Q.jX(q.$T).1F(q.$T).1F(q.$2v);q.$T.2f(\'I-T\');q.$2v.3v()},k5:C(){q.1e.1U(q.d1);q.2o.kO();q.2o.kH();if(q.G.6r)F;3A($.1d(q.1e.dJ,q),bt)},kH:C(){q.2o.eD();q.2o.ex();q.2o.fD();q.2o.fR();if(q.G.1A){q.G.1A=q.1A.3Q();q.1A.2o()}q.1a.iW();q.2o.8r();3A($.1d(q.1R.2R,q),4);q.1X.2u(\'3Q\')},kO:C(){$(q.$2v).1c(\'kU\',q.G.d7);if(q.G.1M)q.$T.2f(\'I-1M\');if(q.G.6S)q.$T.1c(\'6S\',q.G.6S);if(q.G.aG)q.$T.1O(\'aG\',q.G.aG);if(q.G.aI)q.$T.1O(\'aI\',q.G.aI)},fg:C(e){e.2w();if(!q.G.fB||!q.G.fF)F;E 5R=e.bG.5R;q.1v.kQ(5R[0],e)},ft:C(e){q.1e.1S();3A(q.1x.4r,1);q.1X.2u(\'57\',e)},fD:C(){q.$T.on(\'57.I\',$.1d(C(e){e=e.7T||e;if(3l.b6===1y||!e.bG)F 1q;if(e.bG.5R.12===0){F q.2o.ft(e)}N{q.2o.fg(e)}3A(q.1x.4r,1);q.1X.2u(\'57\',e)},q));q.$T.on(\'2y.I\',$.1d(C(e){E 8e=q.1X.7g();E 1m=(8e==\'2y\'||8e==\'4W\')?O:\'2y\';q.1X.9K(1m);q.L.8U();q.1X.2u(\'2y\',e)},q));q.$T.on(\'5C.I\',$.1d(q.5C.3Q,q));q.$T.on(\'l4.I\',$.1d(q.1e.1S,q));q.$T.on(\'1D.I\',$.1d(q.1D.3Q,q));q.$T.on(\'2s.I\',$.1d(q.2s.3Q,q));if($.5k(q.G.fo)){q.$2v.on(\'1D.I-2v\',$.1d(q.G.fo,q))}if($.5k(q.G.fZ)){q.$2v.on(\'2s.I-2v\',$.1d(q.G.fZ,q))}if($.5k(q.G.fW)){q.$T.on(\'2n.I\',$.1d(q.G.fW,q))}$(1l).on(\'6R.I.\'+q.2G,$.1d(C(e){q.8h=e.1Q},q));q.$T.on(\'fI.I\',$.1d(C(e){if(q.2b)F;if(q.7B)F;if(!q.2o.fO())F;q.L.8U();if($.5k(q.G.mr))q.1X.2u(\'fI\',e)},q))},fO:C(){if(q.8h===1q)F 1q;E $el=$(q.8h);F(!$el.3i(\'I-1A, I-1n\')&&!$el.is(\'#I-1a\')&&$el.dL(\'.I-1A, .I-1n, #I-1a\').12===0)},fR:C(){if(q.2z.aD()){q.2z.30()}q.3f.9Q();if(q.G.2n)3A(q.2n.2W,88);if(q.G.fP)3A(q.2n.3P,88)},8r:C(){if(!q.G.8r)F;$.1B(q.G.8r,$.1d(C(i,s){E 1C=(1s df!==\'1y\'&&1s df[s]!==\'1y\')?df:47.fn;if(!$.5k(1C[s])){F}q[s]=1C[s]();E 5X=q.dg(q[s]);E 2p=5X.12;2B(E z=0;z<2p;z++){q[s][5X[z]]=q[s][5X[z]].aH(q)}if($.5k(q[s].3Q)){q[s].3Q()}},q))},eD:C(){if(!q.L.1P(\'4b\'))F;52{1l.3Z(\'lZ\',O,O);1l.3Z(\'lN\',O,O)}51(e){}},ex:C(){if(!q.L.1P(\'2E\'))F;1l.3Z("lS",O,O)}}},1t:C(){F{2o:C(2g,2X){E $1t=$(\'<a 2k="#" 1G="3J-8R 3J-\'+2g+\'" 3T="\'+2g+\'" />\').1c({\'9c\':\'1t\',\'4K-2L\':2X.1J,\'6S\':\'-1\'});if(2X.1C||2X.4A||2X.1n){q.1t.eu($1t,2g,2X)}if(2X.1n){$1t.2f(\'I-1A-V-1n\').1c(\'4K-eY\',1q);E $1n=$(\'<1i 1G="I-1n I-1n-\'+q.2G+\' I-1n-2Q-\'+2g+\'" 1o="6N: 5p;">\');$1t.1f(\'1n\',$1n);q.1n.2o(2g,$1n,2X.1n)}if(q.L.7b()){q.1t.et($1t,2g,2X.1J)}F $1t},eu:C($1t,2g,2X){$1t.on(\'5H 2y\',$.1d(C(e){if($1t.3i(\'I-1t-7o\'))F O;E 1m=\'1C\';E 2A=2X.1C;if(2X.4A){1m=\'4A\';2A=2X.4A}N if(2X.1n){1m=\'1n\';2A=O}q.1t.ac(e,2g,1m,2A)},q))},et:C($1t,1w,1J){E $3q=$(\'<1j>\').2f(\'I-1A-3q I-1A-3q-\'+q.2G+\' I-1A-3q-\'+1w).3v().B(1J);$3q.aU(\'31\');$1t.on(\'ay\',C(){if($(q).3i(\'I-1t-7o\'))F;E 3s=$1t.2I();$3q.2O();$3q.1O({2U:(3s.2U+$1t.6c())+\'px\',2c:(3s.2c+$1t.7P()/2-$3q.7P()/2)+\'px\'})});$1t.on(\'az\',C(){$3q.3v()})},ac:C(e,2g,1m,2A){q.1t.mj=q.1V.ar();e.2w();if(q.L.1P(\'2E\'))e.8l=O;if(1m==\'4A\')q.28.30(2A);N if(1m==\'1n\')q.1n.2O(e,2g);N q.1t.ep(e,2A,2g)},ep:C(e,2A,2g){E 1C;q.8h=1q;if($.5k(2A))2A.6e(q,2g);N if(2A.3N(/\\./)!=\'-1\'){1C=2A.4o(\'.\');if(1s q[1C[0]]==\'1y\')F;q[1C[0]][1C[1]](2g)}N q[2A](2g);q.1R.4i(e,2g)},1b:C(1k){F q.$1A.1h(\'a.3J-\'+1k)},9q:C(1k){q.1t.1b(1k).2f(\'I-8A\')},ge:C(1k){q.1t.1b(1k).2S(\'I-8A\')},cj:C(1k){if(1s 1k===\'1y\'){q.$1A.1h(\'a.3J-8R\').2S(\'I-8A\')}N{q.$1A.1h(\'a.3J-8R\').6h(\'.3J-\'+1k).2S(\'I-8A\')}},gf:C(){q.$1A.1h(\'a.3J-8R\').6h(\'a.3J-B, a.3J-fe\').2S(\'I-1t-7o\')},gT:C(){q.$1A.1h(\'a.3J-8R\').6h(\'a.3J-B, a.3J-fe\').2f(\'I-1t-7o\')},mm:C(1k,av){q.1t.1b(1k).2f(\'3J-\'+av)},mf:C(1k,av){q.1t.1b(1k).2S(\'3J-\'+av)},m7:C(1k,1w){E $1t=q.1t.1b(1k);$1t.2S(\'I-21-M\').2f(\'fa-I-21\');$1t.B(\'<i 1G="fa \'+1w+\'"></i>\')},cB:C($21,2A){if($21=="25")F;E 1m=(2A==\'1n\')?\'1n\':\'1C\';E 1k=$21.1c(\'3T\');$21.on(\'5H 2y\',$.1d(C(e){if($21.3i(\'I-1t-7o\'))F O;q.1t.ac(e,1k,1m,2A)},q))},cc:C($21,1n){$21.2f(\'I-1A-V-1n\').1c(\'4K-eY\',1q);E 1k=$21.1c(\'3T\');q.1t.cB($21,\'1n\');E $1n=$(\'<1i 1G="I-1n I-1n-\'+q.2G+\' I-1n-2Q-\'+1k+\'" 1o="6N: 5p;">\');$21.1f(\'1n\',$1n);if(1n)q.1n.2o(1k,$1n,1n);F $1n},cQ:C(1k,1J){if(!q.G.1A)F;if(q.1t.9v(1k))F"25";E 21=q.1t.2o(1k,{1J:1J});21.2f(\'I-21-M\');q.$1A.1F($(\'<li>\').1F(21));F 21},ma:C(1k,1J){if(!q.G.1A)F;if(q.1t.9v(1k))F"25";E 21=q.1t.2o(1k,{1J:1J});21.2f(\'I-21-M\');q.$1A.6t($(\'<li>\').1F(21));F 21},mt:C(fb,1k,1J){if(!q.G.1A)F;if(q.1t.9v(1k))F"25";E 21=q.1t.2o(1k,{1J:1J});21.2f(\'I-21-M\');E $21=q.1t.1b(fb);if($21.12!==0)$21.1r().3F($(\'<li>\').1F(21));N q.$1A.1F($(\'<li>\').1F(21));F 21},mb:C(f0,1k,1J){if(!q.G.1A)F;if(q.1t.9v(1k))F"25";E 21=q.1t.2o(1k,{1J:1J});21.2f(\'I-21-M\');E $21=q.1t.1b(f0);if($21.12!==0)$21.1r().a6($(\'<li>\').1F(21));N q.$1A.1F($(\'<li>\').1F(21));F 21},1u:C(1k){q.1t.1b(1k).1u()},9v:C(1k){F(1k=="9l"||1k=="a9")&&!q.L.7b()}}},1V:C(){F{2W:C(Q){if(!q.L.6X(Q)){E 3g=q.L.bH();$(Q).6t(3g);q.1V.3P(3g)}N{q.1V.1U(Q,0,Q,0)}},3P:C(Q){Q=Q[0]||Q;if(Q.eR.a8==1){F q.1V.54(Q.eR)}q.1V.1U(Q,1,Q,1)},1U:C(4P,eL,77,hs){4P=4P[0]||4P;77=77[0]||77;if(q.L.7J(4P.1p)&&4P.3x===\'\'){4P.3x=q.G.6o}if(4P.1p==\'58\'&&q.G.1M===O){E 1r=$(q.G.5S)[0];$(4P).2t(1r);4P=1r;77=4P}q.J.1b();52{q.14.2W(4P,eL);q.14.3P(77,hs)}51(e){}q.J.4l()},54:C(Q){52{E Y=$(Q)[0].1p;if(Y!=\'58\'&&!q.L.6X(Q)){E 3g=q.L.bH();$(Q).3F(3g);q.1V.3P(3g)}N{if(Y!=\'58\'&&q.L.1P(\'2E\')){q.1V.2W($(Q).1N())}N{q.1V.d9(Q,\'3F\')}}}51(e){E 3g=q.L.bH();$(Q).3F(3g);q.1V.3P(3g)}},bT:C(Q){if(q.L.6X(Q)){q.1V.3P($(Q).4G())}N{q.1V.d9(Q,\'a6\')}},d9:C(Q,1m){if(!q.L.1P(\'2E\'))q.$T.2n();Q=Q[0]||Q;q.J.1b();if(1m==\'3F\'){52{q.14.9I(Q);q.14.mn(Q)}51(e){}}N{52{q.14.mk(Q);q.14.ks(Q)}51(e){}}q.14.43(O);q.J.4l()},b4:C(Q){Q=Q[0]||Q;q.J.1b();E at=q.14.7S();at.9j(Q);at.3P(q.14.bQ,q.14.bO);F $.3k(at.4y()).12},ar:C(){E 2I=0;E 2T=3l.4D();if(2T.7A>0){E 14=3l.4D().6l(0);E aJ=14.7S();aJ.9j(q.$T[0]);aJ.3P(14.bQ,14.bO);2I=aJ.4y().12}F 2I},eh:C(2b,2h){if(1s 2h==\'1y\')2h=2b;if(!q.2n.dO())q.2n.2W();E 2T=q.J.1b();E Q,2I=0;E hn=1l.mh(q.$T[0],mi.lR,4e,4e);56(Q==hn.lQ()){2I+=Q.5O.12;if(2I>2b){q.14.2W(Q,Q.5O.12+2b-2I);2b=lP}if(2I>=2h){q.14.3P(Q,Q.5O.12+2h-2I);6n}}q.14.43(O);q.J.4l()},lO:C(2b,2h){q.1V.eh(2b,2h)},m2:C(){F q.1V.ar()}}},1x:C(){F{gH:C(B){B=B.K(/<3V(.*?[^>]?)>([\\w\\W]*?)<\\/3V>/gi,\'<2F 1G="I-3V-Y" 1o="6N: 5p;" $1>$2</2F>\');B=B.K(/\\$/g,\'&#36;\');B=B.K(/<a 2k="(.*?[^>]?)®(.*?[^>]?)">/gi,\'<a 2k="$1&lW$2">\');if(q.G.5Q)B=q.1x.5Q(B);if(q.G.1M)B=q.1x.8C(B);B=q.1x.cT(B);E $1i=$(\'<1i>\');$1i.B(B);E da=$1i.1h(\'3R[1o]\');if(da.12!==0){da.2t(C(){E $el=$(q);E $1j=$(\'<1j>\').1c(\'1o\',$el.1c(\'1o\'));F $1j.1F($el.26())});B=$1i.B()}$1i.1u();B=B.K(/<3R(.*?[^<])>/gi,\'\');B=B.K(/<\\/3R>/gi,\'\');B=q.1I.2R(B);if(q.G.2V)B=q.2V.2R(B);B=q.1x.7R(B);B=q.1x.cU(B);B=B.K(/&9o;/g,\'&\');F B},9R:C(B){B=B.K(/\\6g/g,\'\');B=B.K(/&#9T;/gi,\'\');if(q.G.hj){B=B.K(/&5s;/gi,\' \')}if(B.3N(/^<p>(||\\s||<br\\s?\\/?>||&5s;)<\\/p>$/i)!=-1){F\'\'}B=B.K(/<2F 1G="I-3V-Y" 1o="6N: 5p;"(.*?[^>]?)>([\\w\\W]*?)<\\/2F>/gi,\'<3V$1>$2</3V>\');B=q.1x.gG(B);E hZ={\'\\mo\':\'&mp;\',\'\\mQ\':\'&mR;\',\'\\mK\':\'&mL;\',\'\\mM\':\'&n0;\',\'\\mU\':\'&mV;\'};$.1B(hZ,C(i,s){B=B.K(2a 2l(i,\'g\'),s)});if(q.L.1P(\'4b\')){B=B.K(/<br\\s?\\/?>$/gi,\'\')}B=B.K(2a 2l(\'<br\\\\s?/?></li>\',\'gi\'),\'</li>\');B=B.K(2a 2l(\'</li><br\\\\s?/?>\',\'gi\'),\'</li>\');B=B.K(/<(.*?)3T="\\s*?"(.*?[^>]?)>/gi,\'<$1$2">\');B=B.K(/<(.*?)1o="\\s*?"(.*?[^>]?)>/gi,\'<$1$2">\');B=B.K(/="">/gi,\'>\');B=B.K(/""">/gi,\'">\');B=B.K(/"">/gi,\'">\');B=B.K(/<1i(.*?[^>]) 1f-8b="I"(.*?[^>])>/gi,\'<1i$1$2>\');B=B.K(/<(.*?) 1f-3H="I"(.*?[^>])>/gi,\'<$1$2>\');E $1i=$("<1i/>").B($.dQ(B,1l,1q));$1i.1h("1j").1K("3T");$1i.1h(\'2F .I-7s-3g\').1B(C(){$(q).26().3Y()});B=$1i.B();B=B.K(/<1L(.*?[^>])3T="(.*?[^>])"(.*?[^>])>/gi,\'<1L$1$3>\');B=B.K(/<1j 1G="I-7s-3g">(.*?)<\\/1j>/gi,\'$1\');B=B.K(/ 1f-3o-2i="(.*?[^>])"/gi,\'\');B=B.K(/<1j(.*?)id="I-M-2Q"(.*?[^>])>([\\w\\W]*?)<1L(.*?)><\\/1j>/gi,\'$3<1L$4>\');B=B.K(/<1j(.*?)id="I-M-8f"(.*?[^>])>(.*?)<\\/1j>/gi,\'\');B=B.K(/<1j(.*?)id="I-M-5l"(.*?[^>])>(.*?)<\\/1j>/gi,\'\');B=B.K(/<3R(.*?[^<])>/gi,\'\');B=B.K(/<\\/3R>/gi,\'\');B=q.1I.2R(B);if(q.G.hR){B=B.K(/<a(.*?)3T="hG"(.*?[^>])>/gi,\'<a$1$2>\');B=B.K(/<a(.*?[^>])>/gi,\'<a$1 3T="hG">\')}B=B.K(/\\mv-I-(Y|1G|1o)="(.*?[^>])"/gi,\'\');B=B.K(2a 2l(\'<(.*?) 1f-3H="I"(.*?[^>])>\',\'gi\'),\'<$1$2>\');B=B.K(2a 2l(\'<(.*?) 1f-3H="I">\',\'gi\'),\'<$1>\');B=B.K(/&9o;/g,\'&\');F B},8y:C(B,8i){B=$.3k(B);B=B.K(/\\$/g,\'&#36;\');B=B.K(/<1j 1G="s[0-9]">/gi,\'<1j>\');B=B.K(/<1j 1G="hN-mx-3g">&5s;<\\/1j>/gi,\' \');B=B.K(/<1j 1G="hN-5I-1j"[^>]*>\\t<\\/1j>/gi,\'\\t\');B=B.K(/<1j[^>]*>(\\s|&5s;)<\\/1j>/gi,\' \');if(q.G.hL){F q.1x.aj(B)}if(!q.L.9w()&&1s 8i==\'1y\'){if(q.L.4S([\'hM\',\'A\'])){F q.1x.aj(B,O)}if(q.L.4S(\'8o\')){B=B.K(/”/g,\'"\');B=B.K(/“/g,\'"\');B=B.K(/‘/g,\'\\\'\');B=B.K(/’/g,\'\\\'\');F q.1x.gK(B)}if(q.L.4S([\'aK\',\'dK\',\'di\',\'cS\',\'cR\',\'cI\',\'cH\'])){B=q.1x.gL(B);if(!q.L.1P(\'2E\')){E R=q.J.4a();if(R&&R.1p==\'P\'){B=B.K(/<1L(.*?)>/gi,\'<p><1L$1></p>\')}}F B}if(q.L.4S([\'6F\'])){B=q.1x.b0(B,\'2Y\');if(q.G.1M)B=q.1x.8C(B);B=q.1x.gF(B);F B}if(q.L.4S([\'5v\'])){F q.1x.b0(B,\'li\')}}B=q.1x.gP(B,8i);if(!q.1x.9D){if(q.G.1M)B=q.1x.8C(B);if(q.G.5Q)B=q.1x.5Q(B);B=q.1x.cT(B)}B=q.1x.ha(B);B=q.1x.gb(B);B=q.1x.b0(B,\'gB\');if(!q.1x.9D&&q.G.2V){B=q.2V.2R(B)}B=q.1x.gO(B);B=q.1x.gZ(B);B=q.1x.h0(B);B=q.1x.cU(B);F B},ha:C(B){B=B.K(/<!--[\\s\\S]*?-->/gi,\'\');B=B.K(/<1o[^>]*>[\\s\\S]*?<\\/1o>/gi,\'\');B=B.K(/<o\\:p[^>]*>[\\s\\S]*?<\\/o\\:p>/gi,\'\');if(B.1T(/1G="?gd|1o="[^"]*\\gr-|1o=\'[^\'\']*\\gr-|w:ms/i)){B=B.K(/<!--[\\s\\S]+?-->/gi,\'\');B=B.K(/<(!|3V[^>]*>.*?<\\/3V(?=[>\\s])|\\/?(\\?my(:\\w+)?|1L|5h|V|1o|\\w:\\w+)(?=[\\s\\/>]))[^>]*>/gi,\'\');B=B.K(/<(\\/?)s>/gi,"<$mz>");B=B.K(/ /gi,\' \');B=B.K(/<1j\\s+1o\\s*=\\s*"\\s*aY-mF\\s*:\\s*mG\\s*;?\\s*"\\s*>([\\s\\9Z]*)<\\/1j>/gi,C(5f,aW){F(aW.12>0)?aW.K(/./," ").ct(8d.mH(aW.12/2)).4o("").3c("\\9Z"):\'\'});B=q.1x.gQ(B);B=B.K(/<1L(.*?)v:mA=(.*?)>/gi,\'\');B=B.K(/4t="22\\:\\/\\/(.*?)"/,\'4t=""\');E $1i=$("<1i/>").B(B);E 5T=O;E 8V=1;E cY=[];$1i.1h("p[1o]").1B(C(){E 3M=$(q).1c(\'1o\').1T(/aY\\-2e\\:l([0-9]+)\\n1([0-9]+)/);if(3M){E 5V=5L(3M[1]);E 5W=5L(3M[2]);E cX=$(q).B().1T(/^[\\w]+\\./)?"ol":"3p";E $li=$("<li/>").B($(q).B());$li.B($li.B().K(/^([\\w\\.]+)</,\'<\'));$li.1h("1j:3I").1u();if(5W==1&&$.3t(5V,cY)==-1){E $2e=$("<"+cX+"/>").1c({"1f-7h":5W,"1f-2e":5V}).B($li);$(q).2t($2e);5T=5V;cY.2N(5V)}N{if(5W>8V){E $aV=$1i.1h(\'[1f-7h="\'+8V+\'"][1f-2e="\'+5T+\'"]\');E $5T=$aV;2B(E i=8V;i<5W;i++){$2e=$("<"+cX+"/>");$2e.aU($5T.1h("li").2Z());$5T=$2e}$5T.1c({"1f-7h":5W,"1f-2e":5V}).B($li)}N{E $aV=$1i.1h(\'[1f-7h="\'+5W+\'"][1f-2e="\'+5V+\'"]\').2Z();$aV.1F($li)}8V=5W;5T=5V;$(q).1u()}}});$1i.1h(\'[1f-7h][1f-2e]\').1K(\'1f-7h 1f-2e\');B=$1i.B();B=B.K(/·/g,\'\');B=B.K(/<p 1G="gd(.*?)"/gi,\'<p\');B=B.K(/ 1G=\\"(aY[^\\"]*)\\"/gi,"");B=B.K(/ 1G=(aY\\w+)/gi,"");B=B.K(/<o:p(.*?)>([\\w\\W]*?)<\\/o:p>/gi,\'$2\');B=B.K(/\\n/g,\' \');B=B.K(/<p>\\n?<li>/gi,\'<li>\')}F B},gb:C(B){B=B.K(/<b\\l6="g9-4E-2r(.*?)">([\\w\\W]*?)<\\/b>/gi,"$2");B=B.K(/<b(.*?)id="l5-g9-l9(.*?)">([\\w\\W]*?)<\\/b>/gi,"$3");B=B.K(/<1j[^>]*(3R-1o: 4m; 3R-7I: 4n|3R-7I: 4n; 3R-1o: 4m)[^>]*>/gi,\'<1j 1o="3R-7I: 4n;"><1j 1o="3R-1o: 4m;">\');B=B.K(/<1j[^>]*3R-1o: 4m[^>]*>/gi,\'<1j 1o="3R-1o: 4m;">\');B=B.K(/<1j[^>]*3R-7I: 4n[^>]*>/gi,\'<1j 1o="3R-7I: 4n;">\');B=B.K(/<1j[^>]*1g-7a: 5x[^>]*>/gi,\'<1j 1o="1g-7a: 5x;">\');B=B.K(/<1L>/gi,\'\');B=B.K(/\\n{3,}/gi,\'\\n\');B=B.K(/<3R(.*?)>([\\w\\W]*?)<\\/3R>/gi,\'$2\');B=B.K(/<p><p>/gi,\'<p>\');B=B.K(/<\\/p><\\/p>/gi,\'</p>\');B=B.K(/<li>(\\s*|\\t*|\\n*)<p>/gi,\'<li>\');B=B.K(/<\\/p>(\\s*|\\t*|\\n*)<\\/li>/gi,\'</li>\');B=B.K(/<\\/p>\\s<p/gi,\'<\\/p><p\');B=B.K(/<1L 4t="7q-lz-2i\\:\\/\\/(.*?)"(.*?)>/gi,\'\');B=B.K(/<p>•([\\w\\W]*?)<\\/p>/gi,\'<li>$1</li>\');if(q.L.1P(\'4b\')){B=B.K(/<br\\s?\\/?>$/gi,\'\')}F B},b0:C(B,1m){E 2d=[\'1j\',\'a\',\'2F\',\'29\',\'9f\',\'em\',\'5i\',\'1e\',\'aS\',\'6A\',\'du\',\'8S\',\'E\',\'aN\',\'cL\',\'7Q\',\'7l\',\'b\',\'i\',\'u\',\'4h\',\'ol\',\'3p\',\'li\',\'dl\',\'dt\',\'dd\',\'p\',\'br\',\'6Y\',\'8Y\',\'4R\',\'7i\',\'8J\',\'41\',\'1L\',\'3W\',\'2Y\',\'5P\',\'6O\',\'ee\',\'e3\',\'e7\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\'];E cK=O;E cN=[[\'a\',\'*\'],[\'1L\',[\'4t\',\'80\']],[\'1j\',[\'1G\',\'3T\',\'1f-3H\']],[\'4R\',\'*\'],[\'6Y\',\'*\'],[\'8Y\',\'*\'],[\'7i\',\'*\'],[\'41\',\'*\'],[\'8J\',\'*\'],[\'4E\',\'*\']];if(1m==\'gB\'){cK=[\'p\',\'1j\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\'];cN=[[\'3W\',\'1G\'],[\'2Y\',[\'lw\',\'la\']],[\'a\',\'*\'],[\'1L\',[\'4t\',\'80\',\'1f-I-8m-M\']],[\'1j\',[\'1G\',\'3T\',\'1f-3H\']],[\'4R\',\'*\'],[\'6Y\',\'*\'],[\'8Y\',\'*\'],[\'7i\',\'*\'],[\'41\',\'*\'],[\'8J\',\'*\'],[\'4E\',\'*\']]}N if(1m==\'2Y\'){2d=[\'3p\',\'ol\',\'li\',\'1j\',\'a\',\'9f\',\'em\',\'5i\',\'1e\',\'aS\',\'6A\',\'8S\',\'E\',\'aN\',\'cL\',\'7Q\',\'7l\',\'b\',\'i\',\'u\',\'4h\',\'ol\',\'3p\',\'li\',\'dl\',\'dt\',\'dd\',\'br\',\'4R\',\'6Y\',\'8Y\',\'7i\',\'8J\',\'41\',\'1L\',\'h1\',\'h2\',\'h3\',\'h4\',\'h5\',\'h6\']}N if(1m==\'li\'){2d=[\'3p\',\'ol\',\'li\',\'1j\',\'a\',\'9f\',\'em\',\'5i\',\'1e\',\'aS\',\'6A\',\'8S\',\'E\',\'aN\',\'cL\',\'7Q\',\'7l\',\'b\',\'i\',\'u\',\'4h\',\'br\',\'4R\',\'6Y\',\'8Y\',\'7i\',\'8J\',\'41\',\'1L\']}E 44={4c:(q.G.4c)?q.G.4c:O,4z:(q.G.4z)?q.G.4z:2d,6G:1q,lg:1q,1K:(q.G.1K)?q.G.1K:O,4T:(q.G.4T)?q.G.4T:cN,4f:cK};F q.1I.2R(B,44)},h0:C(B){B=B.K(/<(p|h[1-6])>(|\\s|\\n|\\t|<br\\s?\\/?>)<\\/(p|h[1-6])>/gi,\'\');if(!q.G.1M)B=B.K(/<br>$/i,\'\');F B},gZ:C(B){B=B.K(/<1j>(.*?)<\\/1j>/gi,\'$1\');B=B.K(/<1j[^>]*>\\s|&5s;<\\/1j>/gi,\' \');F B},gQ:C(B){if(!q.L.1P(\'2E\'))F B;E 5q=$.3k(B);if(5q.3N(/^<a(.*?)>(.*?)<\\/a>$/i)===0){B=B.K(/^<a(.*?)>(.*?)<\\/a>$/i,"$2")}F B},gP:C(B,8i){q.1x.9D=O;if(!q.L.9w()&&1s 8i==\'1y\'){E 1Z=q.G.8q.3c(\'|\').K(\'P|\',\'\').K(\'89|\',\'\');E gD=B.1T(2a 2l(\'</(\'+1Z+\')>\',\'gi\'));E aQ=B.1T(/<\\/(p|1i)>/gi);if(!gD&&(aQ===4e||(aQ&&aQ.12<=1))){E gI=B.1T(/<br\\s?\\/?>/gi);if(!gI){q.1x.9D=1q;B=B.K(/<\\/?(p|1i)(.*?)>/gi,\'\')}}}F B},lq:C(3D,5J){5J=(((5J||\'\')+\'\').3e().1T(/<[a-z][a-7t-9]*>/g)||[]).3c(\'\');E 2d=/<\\/?([a-z][a-7t-9]*)\\b[^>]*>/gi;F 3D.K(2d,C($0,$1){F 5J.4Q(\'<\'+$1.3e()+\'>\')>-1?$0:\'\'})},lr:C(B){B=q.1x.gJ(B);B=q.1x.gN(B);B=q.1x.gM(B);F B},gJ:C(B){E 2F=B.1T(/<2F(.*?)>([\\w\\W]*?)<\\/2F>/gi);if(2F!==4e){$.1B(2F,$.1d(C(i,s){E 2C=s.1T(/<2F(.*?)>([\\w\\W]*?)<\\/2F>/i);2C[2]=2C[2].K(/<br\\s?\\/?>/g,\'\\n\');2C[2]=2C[2].K(/&5s;/g,\' \');if(q.G.6v){2C[2]=2C[2].K(/\\t/g,9F(q.G.6v+1).3c(\' \'))}2C[2]=q.1x.as(2C[2]);2C[2]=2C[2].K(/\\$/g,\'&#36;\');B=B.K(s,\'<2F\'+2C[1]+\'>\'+2C[2]+\'</2F>\')},q))}F B},gN:C(B){E 1e=B.1T(/<1e(.*?)>([\\w\\W]*?)<\\/1e>/gi);if(1e!==4e){$.1B(1e,$.1d(C(i,s){E 2C=s.1T(/<1e(.*?)>([\\w\\W]*?)<\\/1e>/i);2C[2]=2C[2].K(/&5s;/g,\' \');2C[2]=q.1x.as(2C[2]);2C[2]=2C[2].K(/\\$/g,\'&#36;\');B=B.K(s,\'<1e\'+2C[1]+\'>\'+2C[2]+\'</1e>\')},q))}F B},gM:C(B){B=B.K(/&lt;1j id=&5N;J-2r-([0-9])&5N; 1G=&5N;I-J-2r&5N; 1f-3H=&5N;I&5N;&gt;​&lt;\\/1j&gt;/g,\'<1j id="J-2r-$1" 1G="I-J-2r" 1f-3H="I">​</1j>\');F B},cG:C(B){B=B.K(/<br\\s?\\/?>|<\\/H[1-6]>|<\\/p>|<\\/1i>|<\\/li>|<\\/2Y>/gi,\'\\n\');E 5q=1l.3w(\'1i\');5q.3x=B;B=5q.ll||5q.lm;F $.3k(B)},aj:C(B,2V){B=q.1x.cG(B);B=B.K(/\\n/g,\'<br />\');if(q.G.2V&&1s 2V==\'1y\'&&!q.L.1P(\'4b\')){B=q.2V.2R(B)}F B},gK:C(B){B=B.K(/<1L(.*?) 1o="(.*?)"(.*?[^>])>/gi,\'<1L$1$3>\');B=B.K(/<1L(.*?)>/gi,\'&lt;1L$1&gt;\');B=q.1x.cG(B);if(q.G.6v){B=B.K(/\\t/g,9F(q.G.6v+1).3c(\' \'))}B=q.1x.as(B);F B},gL:C(B){B=B.K(/<1L(.*?)>/gi,\'[1L$1]\');B=B.K(/<([pY]*?)>/gi,\'\');B=B.K(/\\[1L(.*?)\\]/gi,\'<1L$1>\');F B},pG:C(B){B=B.K(/<a(.*?)2k="(.*?)"(.*?)>([\\w\\W]*?)<\\/a>/gi,\'[a 2k="$2"]$4[/a]\');B=B.K(/<1L(.*?)>/gi,\'[1L$1]\');B=B.K(/<(.*?)>/gi,\'\');B=B.K(/\\[a 2k="(.*?)"\\]([\\w\\W]*?)\\[\\/a\\]/gi,\'<a 2k="$1">$2</a>\');B=B.K(/\\[1L(.*?)\\]/gi,\'<1L$1>\');F B},as:C(5f){5f=6f(5f).K(/&9o;/g,\'&\').K(/&lt;/g,\'<\').K(/&gt;/g,\'>\').K(/&5N;/g,\'"\');F 5f.K(/&/g,\'&9o;\').K(/</g,\'&lt;\').K(/>/g,\'&gt;\').K(/"/g,\'&5N;\')},gO:C(B){if(q.L.1P(\'2E\'))F B;E 1i=1l.3w(\'1i\');1i.3x=B;q.1x.cV($(1i));B=1i.3x;$(1i).1u();F B},4r:C(){if(q.L.1P(\'2E\'))F;q.1x.cV(q.$T);E cP=q.$T.1h(\'h1, h2, h3, h4, h5, h6\');cP.1h(\'1j\').1K(\'1o\');cP.1h(q.G.cW.3c(\', \')).1K(\'1o\');q.1e.1S()},cV:C($T){$T.1h(q.G.cW.3c(\', \')).1K(\'1o\');$T.1h(\'1j\').6h(\'[1f-3H="I"]\').1K(\'1o\');$T.1h(\'1j[1f-3H="I"], 1L[1f-3H="I"]\').1B(C(i,s){E $s=$(s);$s.1c(\'1o\',$s.1c(\'3T\'))})},pz:C(){},7R:C(B){if(q.L.1P(\'2E\'))F B;B=B.K(2a 2l(\'<1L(.*?[^>])>\',\'gi\'),\'<1L$1 1f-3H="I">\');B=B.K(2a 2l(\'<1j(.*?[^>])>\',\'gi\'),\'<1j$1 1f-3H="I">\');E 3M=B.1T(2a 2l(\'<(1j|1L)(.*?)1o="(.*?)"(.*?[^>])>\',\'gi\'));if(3M){E 2p=3M.12;2B(E i=0;i<2p;i++){52{E gE=3M[i].K(/1o="(.*?)"/i,\'1o="$1" 3T="$1"\');B=B.K(3M[i],gE)}51(e){}}}F B},cU:C(B){E $1i=$(\'<1i />\').B(B);E 2d=q.G.4N;2d.2N(\'1j\');$1i.1h(2d.3c(\',\')).1B(C(){E $el=$(q);E Y=q.1p.3e();$el.1c(\'1f-I-Y\',Y);if(Y==\'1j\'){if($el.1c(\'1o\'))$el.1c(\'1f-I-1o\',$el.1c(\'1o\'));N if($el.1c(\'1G\'))$el.1c(\'1f-I-1G\',$el.1c(\'1G\'))}});B=$1i.B();$1i.1u();F B},ap:C(){q.$T.1h(\'li\').1B(C(i,s){E $1N=$(s).1N();if($1N.12!==0&&($1N[0].1p==\'8D\'||$1N[0].1p==\'8N\')){$(s).1F($1N)}})},dH:C(B){B=B.K(/\\n/g,\'\');B=B.K(/[\\t]*/g,\'\');B=B.K(/\\n\\s*\\n/g,"\\n");B=B.K(/^[\\s\\n]*/g,\' \');B=B.K(/[\\s\\n]*$/g,\' \');B=B.K(/>\\s{2,}</g,\'> <\');B=B.K(/\\n\\n/g,"\\n");B=B.K(/\\6g/g,\'\');F B},5Q:C(B){if(q.G.1M){B=B.K(/<1i><br\\s?\\/?><\\/1i>/gi,\'<br />\');B=B.K(/<1i(.*?)>([\\w\\W]*?)<\\/1i>/gi,\'$2<br />\')}N{B=B.K(/<1i(.*?)>([\\w\\W]*?)<\\/1i>/gi,\'<p$1>$2</p>\')}B=B.K(/<1i(.*?[^>])>/gi,\'\');B=B.K(/<\\/1i>/gi,\'\');F B},gF:C(B){B=B.K(/<1i\\s(.*?)>/gi,\'<p>\');B=B.K(/<1i><br\\s?\\/?><\\/1i>/gi,\'<br /><br />\');B=B.K(/<1i>([\\w\\W]*?)<\\/1i>/gi,\'$1<br /><br />\');F B},8C:C(B){B=B.K(/<p\\s(.*?)>/gi,\'<p>\');B=B.K(/<p><br\\s?\\/?><\\/p>/gi,\'<br />\');B=B.K(/<p>([\\w\\W]*?)<\\/p>/gi,\'$1<br /><br />\');B=B.K(/(<br\\s?\\/?>){1,}\\n?<\\/29>/gi,\'</29>\');F B},cT:C(B){F B.K(/<64(.*?)>([\\w\\W]*?)<\\/64>/gi,\'<49$1 3T="I-64-Y">$2</49>\')},gG:C(B){F B.K(/<49(.*?) 3T="I-64-Y"(.*?)>([\\w\\W]*?)<\\/49>/gi,\'<64$1$2>$3</64>\')}}},1e:C(){F{1U:C(B){B=$.3k(B.4y());B=q.1x.gH(B);if(q.L.1P(\'2E\')){B=B.K(/<1j(.*?)id="J-2r-(1|2)"(.*?)><\\/1j>;/gi,\'\')}q.$T.B(B);q.1e.1S();if(B!==\'\')q.3f.1u();3A($.1d(q.25.cQ,q),15);if(q.2b===O)q.1R.2R()},1b:C(){E 1e=q.$2v.2K();if(q.G.5Q)1e=q.1x.5Q(1e);if(q.G.1M)1e=q.1x.8C(1e);1e=q.2H.1b(1e);F 1e},1S:C(){3A($.1d(q.1e.gY,q),10)},gY:C(){E B=q.$T.B();if(q.1e.dh&&q.1e.dh==B){F}q.1e.dh=B;B=q.1X.2u(\'pV\',B);B=q.1x.9R(B);q.$2v.2K(B);q.1X.2u(\'1S\',B);if(q.2b===O){q.1X.2u(\'kR\',B)}q.2b=O;if(q.3r.B==O){q.3r.B=q.1e.1b()}if(q.G.8n){q.$2v.1N(\'.3C\').1B(C(i,el){el.3C.gX(B)})}q.3r.h7();q.3r.9Q()},3m:C(){if(q.G.6r){q.1e.dJ()}N{q.1e.gU()}},dJ:C(){q.J.3o();q.1e.2I=q.1V.ar();E 6b=$(3l).3U();E 2J=q.$T.7P(),3n=q.$T.6c();q.$T.3v();E B=q.$2v.2K();q.gk=q.1x.dH(B);B=q.2H.1b(B);E 2b=0,2h=0;E $6W=$("<1i/>").1F($.dQ(q.1x.9R(q.$T.B()),1l,1q));E $a4=$6W.1h("1j.I-J-2r");if($a4.12>0){E a3=q.2H.1b($6W.B()).K(/&9o;/g,\'&\');if($a4.12==1){2b=q.L.bF(a3,$6W.1h("#J-2r-1").6j("7v"));2h=2b}N if($a4.12==2){2b=q.L.bF(a3,$6W.1h("#J-2r-1").6j("7v"));2h=q.L.bF(a3,$6W.1h("#J-2r-2").6j("7v"))-$6W.1h("#J-2r-1").6j("7v").4y().12}}q.J.8p();q.$2v.2K(B);if(q.G.8n){q.$2v.1N(\'.3C\').1B(C(i,el){$(el).2O();el.3C.gX(B);el.3C.pO(\'88%\',3n);el.3C.pP();if(2b==2h){el.3C.pQ(el.3C.7d(2b).3K,el.3C.7d(2h).ch)}N{el.3C.pv({3K:el.3C.7d(2b).3K,ch:el.3C.7d(2b).ch},{3K:el.3C.7d(2h).3K,ch:el.3C.7d(2h).ch})}el.3C.2n()})}N{q.$2v.3n(3n).2O().2n();q.$2v.on(\'1D.I-2v-gl\',q.1e.ga);$(3l).3U(6b);if(q.$2v[0].gR){q.$2v[0].gR(2b,2h)}q.$2v[0].3U=0}q.G.6r=O;q.1t.gT();q.1t.9q(\'B\');q.1X.2u(\'4E\',B)},gU:C(){E B;if(q.G.6r)F;E 2b=0,2h=0;if(q.G.8n){E J;q.$2v.1N(\'.3C\').1B(C(i,el){J=el.3C.pu();2b=el.3C.gC(J[0].gV);2h=el.3C.gC(J[0].e0);B=el.3C.pb()})}N{2b=q.$2v.1b(0).dE;2h=q.$2v.1b(0).dF;B=q.$2v.3v().2K()}if(2b>2h&&2h>0){E gh=2h;E gg=2b;2b=gh;2h=gg}2b=q.1e.dG(B,2b);2h=q.1e.dG(B,2h);B=B.4x(0,2b)+q.J.5a(1)+B.4x(2b);if(2h>2b){E dI=q.J.5a(1).4y().12;B=B.4x(0,2h+dI)+q.J.5a(2)+B.4x(2h+dI)}if(q.gk!==q.1x.dH(B)){q.1e.1U(B)}if(q.G.8n){q.$2v.1N(\'.3C\').3v()}q.$T.2O();if(!q.L.3z(B)){q.3f.1u()}q.J.3d();q.$2v.3h(\'1D.I-2v-gl\');q.1t.gf();q.1t.ge(\'B\');q.1R.2R();q.G.6r=1q;q.1X.2u(\'6r\',B)},ga:C(e){if(e.3j!==9)F 1q;E $el=q.$2v;E 2b=$el.1b(0).dE;$el.2K($el.2K().aB(0,2b)+"\\t"+$el.2K().aB($el.1b(0).dF));$el.1b(0).dE=$el.1b(0).dF=2b+1;F O},dG:C(B,2I){E dM=B.12;E c=0;if(B[2I]==\'>\'){c++}N{2B(E i=2I;i<=dM;i++){c++;if(B[i]==\'>\'){6n}N if(B[i]==\'<\'||i==dM){c=0;6n}}}F 2I+c}}},1X:C(){F{p5:C(){F $.7E({},q)},p7:C(){F q.$T},p6:C(){F q.$2Q},pf:C(){F q.$2j},pg:C(){F q.$2v},pq:C(){F(q.$1A)?q.$1A:O},9K:C(1w){q.1X.8e=1w},7g:C(){F q.1X.8e},2u:C(1m,e,1f){E 9V=1m+\'pp\';E gy=\'I\';E 2A=q.G[9V];if(q.$2v){E 8l=O;E 9t=$.pr(q.$2v[0],\'9t\');if(1s 9t!=\'1y\'&&1s 9t[9V]!=\'1y\'){$.1B(9t[9V],$.1d(C(1k,1E){if(1E[\'pt\']==gy){E 1f=(1s 1f==\'1y\')?[e]:[e,1f];8l=(1s 1f==\'1y\')?1E.7N.6e(q,e):1E.7N.6e(q,e,1f)}},q))}if(8l)F 8l}if($.5k(2A)){F(1s 1f==\'1y\')?2A.6e(q,e):2A.6e(q,e,1f)}N{F(1s 1f==\'1y\')?e:1f}},gA:C(){q.G.jL=1q;q.1X.2u(\'gA\');q.$2j.3h(\'.I\').gv(\'I\');q.$T.3h(\'.I\');$(1l).3h(\'6R.I.\'+q.2G);$(1l).3h(\'2y.I-M-83.\'+q.2G);$(1l).3h(\'2y.I-M-4J-3v.\'+q.2G);$(1l).3h(\'5H.I.\'+q.2G+\' 2y.I.\'+q.2G);$("31").3h(\'6b.I.\'+q.2G);$(q.G.6y).3h(\'6b.I.\'+q.2G);q.$T.2S(\'I-T I-1M I-3f\');q.$T.1K(\'5d\');E B=q.1e.1b();if(q.G.1A){q.$1A.1h(\'a\').1B(C(){E $el=$(q);if($el.1f(\'1n\')){$el.1f(\'1n\').1u();$el.1f(\'1n\',{})}})}if(q.2o.aa()){q.$2Q.3F(q.$2j);q.$2Q.1u();q.$2j.2K(B).2O()}N{q.$2Q.3F(q.$T);q.$2Q.1u();q.$2j.B(B).2O()}if(q.$5e)q.$5e.1u();if(q.$4F)q.$4F.1u();if(q.$74)q.$74.1u();$(\'.I-1A-3q-\'+q.2G).1u();gu(q.9m)}}},1n:C(){F{2o:C(1w,$1n,dU){if(1w==\'3a\'&&q.G.dT){$.1B(q.G.dT,$.1d(C(i,s){E 1w=s.Y,1C;if(1s s[\'1G\']!=\'1y\'){1w=1w+\'-\'+s[\'1G\']}s.1m=(q.L.7J(s.Y))?\'R\':\'28\';if(1s s.1C!=="1y"){1C=s.1C}N{1C=(s.1m==\'28\')?\'28.3a\':\'R.3a\'}if(q.G.1M&&s.1m==\'R\'&&s.Y==\'p\')F;q.3a[1w]={Y:s.Y,1o:s.1o,\'1G\':s[\'1G\'],1c:s.1c,1f:s.1f,8M:s.8M};dU[1w]={1C:1C,1J:s.1J}},q))}$.1B(dU,$.1d(C(2g,2X){E $2x=$(\'<a 2k="#" 1G="I-1n-\'+2g+\'" 9c="1t">\'+2X.1J+\'</a>\');if(1w==\'3a\')$2x.2f(\'I-3a-\'+2g);$2x.on(\'2y\',$.1d(C(e){e.2w();E 1m=\'1C\';E 2A=2X.1C;if(2X.4A){1m=\'4A\';2A=2X.4A}N if(2X.1n){1m=\'1n\';2A=2X.1n}if($(e.1Q).3i(\'I-1n-V-c9\'))F;q.1t.ac(e,2g,1m,2A);q.1n.7C()},q));q.1R.cc($2x,2g,2X);$1n.1F($2x)},q))},2O:C(e,1k){if(!q.G.6r){e.2w();F O}E $1t=q.1t.1b(1k);E $1n=$1t.1f(\'1n\').aU(1l.31);if(q.G.cA){$1n.2f("I-1n-jP")}if($1t.3i(\'7y\')){q.1n.7C()}N{q.1n.7C();q.1R.79();q.1X.2u(\'pm\',{1n:$1n,1k:1k,1t:$1t});q.1t.9q(1k);$1t.2f(\'7y\');E 7x=$1t.2I();E dS=$1n.2J();if((7x.2c+dS)>$(1l).2J()){7x.2c=8d.pl(0,7x.2c-dS)}E 2c=7x.2c+\'px\';if(q.$1A.3i(\'1A-82-2Q\')){E 2U=q.$1A.6c()+q.G.6z;E 4g=\'82\';if(q.G.6y!==1l){2U=(q.$1A.6c()+q.$1A.2I().2U)+q.G.6z;4g=\'8u\'}$1n.1O({4g:4g,2c:2c,2U:2U+\'px\'}).2O()}N{E 2U=($1t.6c()+7x.2U)+\'px\';$1n.1O({4g:\'8u\',2c:2c,2U:2U}).2O()}q.1X.2u(\'qP\',{1n:$1n,1k:1k,1t:$1t});q.$1n=$1n}$(1l).dR(\'2y.I-1n\',$.1d(q.1n.3v,q));q.$T.dR(\'2y.I-1n\',$.1d(q.1n.3v,q));$(1l).dR(\'2s.I-1n\',$.1d(q.1n.9a,q));$1n.on(\'ay.I-1n\',$.1d(q.L.d8,q)).on(\'az.I-1n\',$.1d(q.L.bJ,q));e.fw()},9a:C(e){if(e.7U!=q.3j.b2)F;q.1n.7C();q.$T.2n()},7C:C(){q.$1A.1h(\'a.7y\').2S(\'I-8A\').2S(\'7y\');q.L.bJ();$(\'.I-1n-\'+q.2G).3v();$(\'.I-1n-V-h9\').2S(\'I-1n-V-h9\');if(q.$1n){q.$1n.3h(\'.I-1n\');q.1X.2u(\'qC\',q.$1n);q.$1n=O}},3v:C(e){E $1n=$(e.1Q);if(!$1n.3i(\'7y\')&&!$1n.3i(\'I-1n-V-c9\')){$1n.2S(\'7y\');$1n.3h(\'ay az\');q.1n.7C()}}}},22:C(){F{2O:C(){q.1a.2R(\'22\',q.1H.1b(\'22\'),hP);q.1v.3Q(\'#I-1a-22-1v\',q.G.76,q.22.1Y);q.J.3o();q.J.1b();E 1g=q.2T.4y();$(\'#I-6k\').2K(1g);q.1a.2O()},1Y:C(2P,4Y,e){if(1s 2P.6U!=\'1y\'){q.1a.4j();q.J.3d();q.1X.2u(\'qG\',2P);F}E V;if(1s 2P==\'6Z\'){V=2P}N{E 1g=$(\'#I-6k\').2K();if(1s 1g==\'1y\'||1g===\'\')1g=2P.6k;V=\'<a 2k="\'+2P.9b+\'" id="9b-2r">\'+1g+\'</a>\'}if(4Y){q.J.8p();E 2r=q.J.6Q();q.1Y.dA(e,2r)}N{q.1a.4j()}q.J.3d();q.25.1U();q.1Y.fc(V);if(1s 2P==\'6Z\')F;E 8t=$(q.$T.1h(\'a#9b-2r\'));if(8t.12!==0){8t.1K(\'id\').1K(\'1o\')}N 8t=O;q.1X.2u(\'76\',8t,2P)}}},2n:C(){F{2W:C(){q.$T.2n();E 3I=q.$T.3O().3I();if(3I.12===0)F;if(3I[0].12===0||3I[0].1p==\'58\'||3I[0].a8==3){F}if(3I[0].1p==\'8D\'||3I[0].1p==\'8N\'){E 4w=3I.1h(\'li\').3I();if(!q.L.6X(4w)&&4w.1g()===\'\'){q.1V.2W(4w);F}}if(q.G.1M&&!q.L.7J(3I[0].1p)){q.J.1b();q.14.2W(q.$T[0],0);q.14.3P(q.$T[0],0);q.J.4l();F}q.1V.2W(3I)},3P:C(){E 2Z=q.$T.3O().2Z();q.$T.2n();if(2Z.9B()===0)F;if(q.L.3z(q.$T.B())){q.J.1b();q.14.43(1q);q.14.9I(2Z[0]);q.14.3P(2Z[0],0);q.J.4l()}N{q.J.1b();q.14.9j(2Z[0]);q.14.43(O);q.J.4l()}},dO:C(){E 8v=1l.4D().8v;if(8v===4e)F O;if(q.G.1M&&$(8v.e4).3i(\'I-1M\'))F 1q;N if(!q.L.4p(8v.e4))F O;F q.$T.is(\':2n\')}}},M:C(){F{2O:C(){q.1a.2R(\'M\',q.1H.1b(\'M\'),hP);q.1v.3Q(\'#I-1a-M-4d\',q.G.75,q.M.1Y);q.J.3o();q.1a.2O()},hc:C($M){E $V=$M.2q(\'a\',q.$T[0]);q.1a.2R(\'iX\',q.1H.1b(\'7L\'),qv);q.1a.cy();q.M.hJ=q.1a.io(q.1H.1b(\'hK\'));q.M.hF=q.1a.cz(q.1H.1b(\'3o\'));q.M.hJ.on(\'2y\',$.1d(C(){q.M.1u($M)},q));q.M.hF.on(\'2y\',$.1d(C(){q.M.i0($M)},q));$(\'.I-V-3q\').1u();$(\'#I-M-1J\').2K($M.1c(\'80\'));if(!q.G.hE)$(\'.I-M-V-42\').3v();N{E $dP=$(\'#I-M-V\');$dP.1c(\'2k\',$M.1c(\'4t\'));if($V.12!==0){$dP.2K($V.1c(\'2k\'));if($V.1c(\'1Q\')==\'7K\')$(\'#I-M-V-7Z\').6j(\'a0\',1q)}}if(!q.G.hH)$(\'.I-M-4g-42\').3v();N{E hI=($M.1O(\'6N\')==\'R\'&&$M.1O(\'7f\')==\'5p\')?\'5u\':$M.1O(\'7f\');$(\'#I-M-5g\').2K(hI)}q.1a.2O();$(\'#I-M-1J\').2n()},i1:C($M){E hQ=$(\'#I-M-5g\').2K();E ag=\'\';E dD=\'\';E 8P=\'\';eJ(hQ){9G\'2c\':ag=\'2c\';8P=\'0 \'+q.G.8x+\' \'+q.G.8x+\' 0\';6n;9G\'4s\':ag=\'4s\';8P=\'0 0 \'+q.G.8x+\' \'+q.G.8x;6n;9G\'5u\':dD=\'R\';8P=\'bj\';6n}$M.1O({\'7f\':ag,6N:dD,4B:8P});$M.1c(\'3T\',$M.1c(\'1o\'))},i0:C($M){q.M.7W();q.25.1U();E $V=$M.2q(\'a\',q.$T[0]);E 1J=$(\'#I-M-1J\').2K().K(/(<([^>]+)>)/ig,"");$M.1c(\'80\',1J);q.M.i1($M);E V=$.3k($(\'#I-M-V\').2K());E V=V.K(/(<([^>]+)>)/ig,"");if(V!==\'\'){E 7D=\'((jT--)?[a-7t-9]+(-[a-7t-9]+)*\\\\.)+[a-z]{2,}\';E 3J=2a 2l(\'^(8s|8K|5o)://\'+7D,\'i\');E a1=2a 2l(\'^\'+7D,\'i\');if(V.3N(3J)==-1&&V.3N(a1)===0&&q.G.5c){V=q.G.5c+\'://\'+V}E 1Q=($(\'#I-M-V-7Z\').6j(\'a0\'))?1q:O;if($V.12===0){E a=$(\'<a 2k="\'+V+\'">\'+q.L.6q($M)+\'</a>\');if(1Q)a.1c(\'1Q\',\'7K\');$M.2t(a)}N{$V.1c(\'2k\',V);if(1Q){$V.1c(\'1Q\',\'7K\')}N{$V.1K(\'1Q\')}}}N if($V.12!==0){$V.2t(q.L.6q($M))}q.1a.4j();q.1R.au();q.1e.1S()},j1:C($M){if(q.G.dq){$M.on(\'qH\',$.1d(q.M.bn,q))}E 7N=$.1d(C(e){q.1R.M=$M;q.M.8f=q.M.hk($M);$(1l).on(\'6R.I-M-4J-3v.\'+q.2G,$.1d(q.M.7W,q));if(!q.G.dp)F;q.M.8f.on(\'6R.I 5H.I\',$.1d(C(e){q.M.i2(e,$M)},q))},q);$M.3h(\'6R.I\').on(\'6R.I\',$.1d(q.M.7W,q));$M.3h(\'2y.I 5H.I\').on(\'2y.I 5H.I\',7N)},i2:C(e,$M){e.2w();q.M.4k={x:e.hY,y:e.ah,el:$M,dC:$M.2J()/$M.3n(),h:$M.3n()};e=e.7T||e;if(e.8G){q.M.4k.x=e.8G[0].hY;q.M.4k.y=e.8G[0].ah}q.M.hX()},hX:C(){$(1l).on(\'qI.I-M-4J qT.I-M-4J\',$.1d(q.M.hT,q));$(1l).on(\'iZ.I-M-4J qU.I-M-4J\',$.1d(q.M.hW,q))},hT:C(e){e.2w();e=e.7T||e;E 3n=q.M.4k.h;if(e.8G)3n+=(e.8G[0].ah-q.M.4k.y);N 3n+=(e.ah-q.M.4k.y);E 2J=8d.hV(3n*q.M.4k.dC);if(3n<50||2J<88)F;E 3n=8d.hV(q.M.4k.el.2J()/q.M.4k.dC);q.M.4k.el.1c({2J:2J,3n:3n});q.M.4k.el.2J(2J);q.M.4k.el.3n(3n);q.1e.1S()},hW:C(){q.iw=O;$(1l).3h(\'.I-M-4J\');q.M.7W()},bn:C(e){if(q.$T.1h(\'#I-M-2Q\').12!==0){e.2w();F O}q.$T.on(\'57.I-M-hD-57\',$.1d(C(){3A($.1d(q.M.bs,q),1)},q))},bs:C(){q.M.hC();q.1R.au();q.$T.3h(\'57.I-M-hD-57\');q.1x.4r();q.1e.1S()},hC:C(){q.$T.1h(\'1L[1f-3o-2i]\').1B(C(){E $el=$(q);$el.1c(\'4t\',$el.1c(\'1f-3o-2i\'));$el.1K(\'1f-3o-2i\')})},7W:C(e){if(e&&$(e.1Q).2q(\'#I-M-2Q\',q.$T[0]).12!==0)F;if(e&&e.1Q.1p==\'aA\'){E $M=$(e.1Q);$M.1c(\'1f-3o-2i\',$M.1c(\'4t\'))}E 3G=q.$T.1h(\'#I-M-2Q\');if(3G.12===0)F;$(\'#I-M-5l\').1u();$(\'#I-M-8f\').1u();3G.1h(\'1L\').1O({63:3G[0].1o.63,af:3G[0].1o.af,ae:3G[0].1o.ae,ab:3G[0].1o.ab});3G.1O(\'4B\',\'\');3G.1h(\'1L\').1O(\'hg\',\'\');3G.2t(C(){F $(q).26()});$(1l).3h(\'6R.I-M-4J-3v.\'+q.2G);if(1s q.M.4k!==\'1y\'){q.M.4k.el.1c(\'3T\',q.M.4k.el.1c(\'1o\'))}q.1e.1S()},hd:C($M,3G){if(q.G.dp&&!q.L.6M()){E 8a=$(\'<1j id="I-M-8f" 1f-I="3H"></1j>\');if(!q.L.7b()){8a.1O({2J:\'hi\',3n:\'hi\'})}8a.1c(\'5d\',O);3G.1F(8a);3G.1F($M);F 8a}N{3G.1F($M);F O}},hk:C($M){E 3G=$(\'<1j id="I-M-2Q" 1f-I="3H">\');3G.1O(\'7f\',$M.1O(\'7f\')).1c(\'5d\',O);if($M[0].1o.4B!=\'bj\'){3G.1O({63:$M[0].1o.63,af:$M[0].1o.af,ae:$M[0].1o.ae,ab:$M[0].1o.ab});$M.1O(\'4B\',\'\')}N{3G.1O({\'6N\':\'R\',\'4B\':\'bj\'})}$M.1O(\'hg\',\'.5\').3F(3G);if(q.G.dq){q.M.5l=$(\'<1j id="I-M-5l" 1f-I="3H">\'+q.1H.1b(\'7L\')+\'</1j>\');q.M.5l.1c(\'5d\',O);q.M.5l.on(\'2y\',$.1d(C(){q.M.hc($M)},q));3G.1F(q.M.5l);E hb=q.M.5l.7P();q.M.5l.1O(\'4B-2c\',\'-\'+hb/2+\'px\')}F q.M.hd($M,3G)},1u:C(M){E $M=$(M);E $V=$M.2q(\'a\',q.$T[0]);E $6K=$M.2q(\'6K\',q.$T[0]);E $1r=$M.1r();if($(\'#I-M-2Q\').12!==0){$1r=$(\'#I-M-2Q\').1r()}E $1N;if($6K.12!==0){$1N=$6K.1N();$6K.1u()}N if($V.12!==0){$1r=$V.1r();$V.1u()}N{$M.1u()}$(\'#I-M-2Q\').1u();if($6K.12!==0){q.1V.2W($1N)}N{q.1V.2W($1r)}q.1X.2u(\'dw\',$M[0].4t,$M);q.1a.4j();q.1e.1S()},1Y:C(2P,4Y,e){if(1s 2P.6U!=\'1y\'){q.1a.4j();q.J.3d();q.1X.2u(\'qs\',2P);F}E $1L;if(1s 2P==\'6Z\'){$1L=$(2P).1c(\'1f-I-8m-M\',\'1q\')}N{$1L=$(\'<1L>\');$1L.1c(\'4t\',2P.9b).1c(\'1f-I-8m-M\',\'1q\')}E Q=$1L;E do=q.L.4S(\'P\');if(do){Q=$(\'<29 />\').1F($1L)}if(4Y){q.J.8p();E 2r=q.J.6Q();q.1Y.dA(e,2r)}N{q.1a.4j()}q.J.3d();q.25.1U();q.1Y.B(q.L.6q(Q),O);E $M=q.$T.1h(\'1L[1f-I-8m-M=1q]\').1K(\'1f-I-8m-M\');if(do){$M.1r().26().3Y().5Z(\'<p />\')}N if(q.G.1M){if(!q.L.3z(q.1e.1b())){$M.a6(\'<br>\')}$M.3F(\'<br>\')}if(1s 2P==\'6Z\')F;q.1X.2u(\'75\',$M,2P)}}},3y:C(){F{bo:C(){if(!q.L.1P(\'2E\'))q.$T.2n();q.25.1U();q.J.3o();E R=q.J.4a();if(R&&R.1p==\'5v\'){q.3y.ho()}N if(R===O&&q.G.1M){q.3y.hx()}N{q.3y.hy()}q.J.3d();q.1e.1S()},ho:C(){1l.3Z(\'3y\');q.3y.aO();q.1x.ap();q.1x.4r()},hy:C(){$.1B(q.J.3X(),$.1d(C(i,4V){if(4V.1p===\'6F\'||4V.1p===\'dn\')F;E $el=q.L.bh(4V);E 2c=q.L.dr($el.1O(\'4B-2c\'))+q.G.ad;$el.1O(\'4B-2c\',2c+\'px\')},q))},hx:C(){E 4M=q.J.5Z(\'1i\');$(4M).1c(\'1f-8b\',\'I\');$(4M).1O(\'4B-2c\',q.G.ad+\'px\')},95:C(){q.25.1U();q.J.3o();E R=q.J.4a();if(R&&R.1p==\'5v\'){q.3y.hz()}N{q.3y.hA()}q.J.3d();q.1e.1S()},hz:C(){1l.3Z(\'7p\');E 1z=q.J.3B();E $2x=$(1z).2q(\'li\',q.$T[0]);q.3y.aO();if(!q.G.1M&&$2x.12===0){1l.3Z(\'9S\',O,\'p\');q.$T.1h(\'3p, ol, 29, p\').1B($.1d(q.L.4f,q))}q.1x.4r()},hA:C(){$.1B(q.J.3X(),$.1d(C(i,4V){E $el=q.L.bh(4V);E 2c=q.L.dr($el.1O(\'4B-2c\'))-q.G.ad;if(2c<=0){if(q.G.1M&&1s($el.1f(\'8b\'))!==\'1y\'){$el.2t($el.B()+\'<br />\')}N{$el.1O(\'4B-2c\',\'\');q.L.5r($el,\'1o\')}}N{$el.1O(\'4B-2c\',2c+\'px\')}},q))},aO:C(){E R=q.J.4a();if(q.14.53&&R&&R.1p==\'5v\'&&q.L.3z($(R).1g())){E $R=$(R);$R.1h(\'1j\').6h(\'.I-J-2r\').26().3Y();$R.1F(\'<br>\')}}}},28:C(){F{3a:C(1w){E 1m,1E;if(1s q.3a[1w].1o!=\'1y\')1m=\'1o\';N if(1s q.3a[1w][\'1G\']!=\'1y\')1m=\'1G\';if(1m)1E=q.3a[1w][1m];q.28.30(q.3a[1w].Y,1m,1E)},30:C(Y,1m,1E){E 1z=q.J.3B();if(1z&&1z.1p===\'qc\')F;q.8h=1q;if(q.L.4S(\'8o\')||q.L.h8())F;E 2d=[\'b\',\'4n\',\'i\',\'4m\',\'5x\',\'eM\',\'5Y\',\'hv\',\'hq\'];E hu=[\'5i\',\'5i\',\'em\',\'em\',\'u\',\'4h\',\'4h\',\'7Q\',\'7l\'];2B(E i=0;i<2d.12;i++){if(Y==2d[i])Y=hu[i]}if(q.G.4z){if($.3t(Y,q.G.4z)==-1)F}N{if($.3t(Y,q.G.4c)!==-1)F}q.28.1m=1m||O;q.28.1E=1E||O;q.25.1U();if(!q.L.1P(\'2E\')){q.$T.2n()}q.J.1b();if(q.14.53){q.28.i3(Y)}N{q.28.fS(Y)}},i3:C(Y){E 1z=q.J.3B();E $1r=$(1z).2q(Y+\'[1f-I-Y=\'+Y+\']\',q.$T[0]);if($1r.12!==0&&(q.28.1m!=\'1o\'&&$1r[0].1p!=\'6w\')){if(q.L.3z($1r.1g())){q.1V.54($1r[0]);$1r.1u();q.1e.1S()}N if(q.L.6T($1r)){q.1V.54($1r[0])}F}E Q=$(\'<\'+Y+\'>\').1c(\'1f-3H\',\'I\').1c(\'1f-I-Y\',Y);Q.B(q.G.6o);Q=q.28.dj(Q);E Q=q.1Y.Q(Q);q.1V.3P(Q);q.1e.1S()},fS:C(Y){q.28.eF(Y);q.J.3o();1l.3Z(\'eM\');q.$T.1h(\'7c\').1B($.1d(C(i,s){E $el=$(s);q.28.eG($el,Y);E $1j;if(q.28.1m){$1j=$(\'<1j>\').1c(\'1f-I-Y\',Y).1c(\'1f-3H\',\'I\');$1j=q.28.dj($1j)}N{$1j=$(\'<\'+Y+\'>\').1c(\'1f-I-Y\',Y).1c(\'1f-3H\',\'I\')}$el.2t($1j.B($el.26()));E $1r=$1j.1r();if($1r&&$1r[0].1p===\'U\'){$1j.1r().2t($1j)}if(Y==\'1j\'){if($1r&&$1r[0].1p===\'6w\'&&q.28.1m===\'1o\'){E 2C=q.28.1E.4o(\';\');2B(E z=0;z<2C.12;z++){if(2C[z]===\'\')F;E 1o=2C[z].4o(\':\');$1r.1O(1o[0],\'\');if(q.L.5r($1r,\'1o\')){$1r.2t($1r.26())}}}}},q));if(Y!=\'1j\'){q.$T.1h(q.G.4N.3c(\', \')).1B($.1d(C(i,s){E $el=$(s);if(s.1p===\'U\'&&s.4u.12===0){$el.2t($el.26());F}E ai=$el.1O(\'1g-7a\');if(ai===\'3K-eP\'){$el.1O(\'1g-7a\',\'\');q.L.5r($el,\'1o\')}},q))}if(Y!=\'4h\'){E eK=q;q.$T.1h(\'28\').1B(C(i,s){eK.L.4I(s,\'4h\')})}q.J.3d();q.1e.1S()},eG:C($el,Y){E 3u=q;$el.3O(Y).1B(C(){E $4w=$(q);if(!$4w.3i(\'I-J-2r\')){if(3u.28.1m==\'1o\'){E 2C=3u.28.1E.4o(\';\');2B(E z=0;z<2C.12;z++){if(2C[z]===\'\')F;E 1o=2C[z].4o(\':\');$4w.1O(1o[0],\'\');if(3u.L.5r($4w,\'1o\')){$4w.2t($4w.26())}}}N{$4w.26().3Y()}}})},eF:C(Y){q.J.3o();E 1h=\'\';if(q.28.1m==\'1G\')1h=\'[1f-I-1G=\'+q.28.1E+\']\';N if(q.28.1m==\'1o\'){1h=\'[1f-I-1o="\'+q.28.1E+\'"]\'}E 3u=q;if(Y!=\'4h\'){q.$T.1h(\'4h\').1B(C(i,s){3u.L.4I(s,\'28\')})}if(Y!=\'1j\'){q.$T.1h(Y).1B(C(){E $el=$(q);$el.2t($(\'<7c />\').B($el.26()))})}q.$T.1h(\'[1f-I-Y="\'+Y+\'"]\'+1h).1B(C(){if(1h===\'\'&&Y==\'1j\'&&q.1p.3e()==Y)F;E $el=$(q);$el.2t($(\'<7c />\').B($el.26()))});q.J.3d()},dj:C(Q){eJ(q.28.1m){9G\'1G\':if(Q.3i(q.28.1E)){Q.2S(q.28.1E);Q.1K(\'1f-I-1G\')}N{Q.2f(q.28.1E);Q.1c(\'1f-I-1G\',q.28.1E)}6n;9G\'1o\':Q[0].1o.q4=q.28.1E;Q.1c(\'1f-I-1o\',q.28.1E);6n}F Q},qd:C(){q.25.1U();E 1z=q.J.3B();E 23=q.J.e8();q.J.3o();if(1z&&1z.1p===\'6w\'){E $s=$(1z);$s.1K(\'1o\');if($s[0].4u.12===0){$s.2t($s.26())}}$.1B(23,$.1d(C(i,s){E $s=$(s);if($.3t(s.1p.3e(),q.G.4N)!=-1&&!$s.3i(\'I-J-2r\')){$s.1K(\'1o\');if($s[0].4u.12===0){$s.2t($s.26())}}},q));q.J.3d();q.1e.1S()},qe:C(1w){q.25.1U();E 1r=q.J.67();E 23=q.J.e8();q.J.3o();if(1r&&1r.1p===\'6w\'){E $s=$(1r);$s.1O(1w,\'\');q.L.5r($s,\'1o\');if($s[0].4u.12===0){$s.2t($s.26())}}$.1B(23,$.1d(C(i,s){E $s=$(s);if($.3t(s.1p.3e(),q.G.4N)!=-1&&!$s.3i(\'I-J-2r\')){$s.1O(1w,\'\');q.L.5r($s,\'1o\');if($s[0].4u.12===0){$s.2t($s.26())}}},q));q.J.3d();q.1e.1S()},dm:C(){q.25.1U();E 1z=q.J.3B();q.J.3o();1l.3Z(\'dm\');if(1z&&1z.1p===\'6w\'){$(1z).2t($(1z).26())}$.1B(q.J.6I(),$.1d(C(i,s){E $s=$(s);if($.3t(s.1p.3e(),q.G.4N)!=-1&&!$s.3i(\'I-J-2r\')){$s.2t($s.26())}},q));q.J.3d();q.1e.1S()},7O:C(3E){q.28.30(\'1j\',\'1G\',3E)},qn:C(1E){q.28.30(\'1j\',\'1o\',1E)}}},1Y:C(){F{1U:C(B,1x){q.3f.1u();B=q.1x.7R(B);if(1s 1x==\'1y\'){B=q.1x.8y(B,O)}q.$T.B(B);q.J.1u();q.2n.3P();q.1x.ap();q.1e.1S();q.1R.2R();if(1s 1x==\'1y\'){3A($.1d(q.1x.4r,q),10)}},1g:C(1g){q.3f.1u();1g=1g.4y();1g=$.3k(1g);1g=q.1x.aj(1g,O);q.$T.2n();if(q.L.1P(\'2E\')){q.1Y.ds(1g)}N{q.J.1b();q.14.55();E el=1l.3w("1i");el.3x=1g;E 4L=1l.9M(),Q,5K;56((Q=el.9N)){5K=4L.81(Q)}q.14.3L(4L);if(5K){E 14=q.14.7S();14.9I(5K);14.43(1q);q.2T.8T();q.2T.4l(14)}}q.1e.1S();q.1x.4r()},fc:C(B){q.1Y.B(B,O)},B:C(B,1x){q.3f.1u();if(1s 1x==\'1y\')1x=1q;q.$T.2n();B=q.1x.7R(B);if(1x){B=q.1x.8y(B)}if(q.L.1P(\'2E\')){q.1Y.ds(B)}N{if(q.1x.9D)q.1Y.eV(B);N 1l.3Z(\'qr\',O,B);q.1Y.eX()}q.1x.ap();if(!q.G.1M){q.$T.1h(\'p\').1B($.1d(q.L.4f,q))}q.1e.1S();q.1R.2R();if(1x){q.1x.4r()}},eX:C(){if(!q.L.1P(\'4b\'))F;E $1N=$(q.J.4a()).1N();if($1N.12>0&&$1N[0].1p==\'P\'&&$1N.B()===\'\'){$1N.1u()}},ds:C(B){if(q.L.gj()){E 1r=q.L.4S(\'P\');E $B=$(\'<1i>\').1F(B);E eU=$B.26().is(\'p, :87, dl, 3p, ol, 1i, 3W, 2Y, 29, 2F, du, 49, 87, c8, eE, eS\');if(1r&&eU)q.1Y.ey(1r,B);N q.1Y.ew(B);F}1l.J.92().gw(B)},eV:C(B){B=q.1x.7R(B);q.J.1b();q.14.55();E el=1l.3w(\'1i\');el.3x=B;E 4L=1l.9M(),Q,5K;56((Q=el.9N)){5K=4L.81(Q)}q.14.3L(4L);q.14.43(1q);q.1V.54(5K)},Q:C(Q,55){Q=Q[0]||Q;E B=q.L.6q(Q);B=q.1x.7R(B);if(B.1T(/</g)!==4e){Q=$(B)[0]}q.J.1b();if(55!==O){q.14.55()}q.14.3L(Q);q.14.43(O);q.J.4l();F Q},qf:C(Q,x,y){Q=Q[0]||Q;q.J.1b();E 14;if(1l.aq){E 3s=1l.aq(x,y);q.14.2W(3s.er,3s.2I);q.14.43(1q);q.14.3L(Q)}N if(1l.ao){14=1l.ao(x,y);14.3L(Q)}N if(1s 1l.31.an!="1y"){14=1l.31.an();14.ak(x,y);E 7e=14.eo();7e.ak(x,y);14.eA("ez",7e);14.7z()}},dA:C(e,Q){Q=Q[0]||Q;E 14;E x=e.qi,y=e.qk;if(1l.aq){E 3s=1l.aq(x,y);E 2T=1l.4D();14=2T.6l(0);14.2W(3s.er,3s.2I);14.43(1q);14.3L(Q)}N if(1l.ao){14=1l.ao(x,y);14.3L(Q)}N if(1s 1l.31.an!="1y"){14=1l.31.an();14.ak(x,y);E 7e=14.eo();7e.ak(x,y);14.eA("ez",7e);14.7z()}},ey:C(1r,B){E Q=1l.3w(\'1j\');Q.3E=\'I-ie-5C\';q.1Y.Q(Q);E 7m=$(1r).B();7m=\'<p>\'+7m.K(/<1j 1G="I-ie-5C"><\\/1j>/gi,\'</p>\'+B+\'<p>\')+\'</p>\';7m=7m.K(/<p><\\/p>/gi,\'\');$(1r).2t(7m)},ew:C(B){q.J.1b();q.14.55();E el=1l.3w("1i");el.3x=B;E 4L=1l.9M(),Q,5K;56((Q=el.9N)){5K=4L.81(Q)}q.14.3L(4L);q.14.43(O);q.J.4l()}}},1D:C(){F{3Q:C(e){if(q.7B)F;E 1k=e.7U;E 4W=(1k>=37&&1k<=40);q.1D.48=e.9u||e.6J;q.1D.1z=q.J.3B();q.1D.1r=q.J.67();q.1D.R=q.J.4a();q.1D.2F=q.L.bB(q.1D.1z,\'2F\');q.1D.29=q.L.bB(q.1D.1z,\'29\');q.1D.7Y=q.L.bB(q.1D.1z,\'7Y\');q.6m.3Q(e,1k);if(q.L.7b()){q.1D.fN(4W,1k);q.1D.g6(e,1k)}q.1D.fV(4W);q.1D.fY(e,1k);E eC=q.1X.2u(\'1D\',e);if(eC===O){e.2w();F O}if(q.G.al&&(q.L.1P(\'2E\')||q.L.1P(\'4b\'))&&(1k===q.3j.dW||1k===q.3j.eB)){E dy=O;E $3W=O;if(q.1D.R&&q.1D.R.1p===\'6F\'){$3W=$(q.1D.R).2q(\'3W\',q.$T[0])}if($3W&&$3W.1h(\'2Y\').2Z()[0]===q.1D.R){dy=1q}if(q.L.6T()&&dy){E Q=$(q.G.5S);$3W.3F(Q);q.1V.2W(Q)}}if(q.G.al&&1k===q.3j.dW){q.1D.fH()}if(!q.G.al&&1k===q.3j.70){e.2w();if(!q.14.53)q.14.55();F}if(1k==q.3j.70&&!e.6s&&!e.9u&&!e.6J){E fQ=q.1X.2u(\'nz\',e);if(fQ===O){e.2w();F O}if(q.1D.29&&q.1D.fk(e)===1q){F O}E 1z,$1N;if(q.1D.2F){F q.1D.fE(e)}N if(q.1D.29||q.1D.7Y){1z=q.J.3B();$1N=$(1z).1N();if($1N.12!==0&&$1N[0].1p==\'58\'){F q.1D.6x(e)}N if(q.L.6T()&&(1z&&1z!=\'6w\')){F q.1D.9x(e)}N{F q.1D.6x(e)}}N if(q.G.1M&&!q.1D.R){1z=q.J.3B();$1N=$(q.1D.1z).1N();if($1N.12!==0&&$1N[0].1p==\'58\'){F q.1D.6x(e)}N if(1z!==O&&$(1z).3i(\'I-7s-3g\')){q.1V.54(1z);$(1z).26().3Y();F q.1D.9x(e)}N{if(q.L.dN()){F q.1D.9x(e)}N if($1N.12===0&&1z===O&&1s $1N.ny!=\'1y\'){F q.1D.6x(e)}F q.1D.6x(e)}}N if(q.G.1M&&q.1D.R){3A($.1d(q.1D.fs,q),1)}N if(!q.G.1M&&q.1D.R){3A($.1d(q.1D.fm,q),1);if(q.1D.R.1p===\'5v\'){1z=q.J.3B();E $1r=$(1z).2q(\'li\',q.$T[0]);E $2e=$1r.2q(\'3p,ol\',q.$T[0]);if($1r.12!==0&&q.L.3z($1r.B())&&$2e.1N().12===0&&q.L.3z($2e.1h("li").2Z().B())){$2e.1h("li").2Z().1u();E Q=$(q.G.5S);$2e.3F(Q);q.1V.2W(Q);F O}}}N if(!q.G.1M&&!q.1D.R){F q.1D.fj(e)}}if(1k===q.3j.70&&(e.9u||e.6s)){F q.1D.i4(e)}if(1k===q.3j.dx||e.6J&&1k===ek||e.6J&&1k===e5){F q.1D.fG(e,1k)}if(1k===q.3j.84||1k===q.3j.8Q){E 23=q.J.6I();if(23){E 2p=23.12;E 2Z;2B(E i=0;i<2p;i++){E 3O=$(23[i]).3O(\'1L\');if(3O.12!==0){E 3u=q;$.1B(3O,C(z,s){E $s=$(s);if($s.1O(\'7f\')!=\'5p\')F;3u.1X.2u(\'dw\',s.4t,$s);2Z=s})}N if(23[i].1p==\'aA\'){if(2Z!=23[i]){q.1X.2u(\'dw\',23[i].4t,$(23[i]));2Z=23[i]}}}}}if(1k===q.3j.84){E R=q.J.4a();E ff=($(R).1O(\'4B-2c\')!==\'nC\');if(R&&ff&&q.14.53&&q.L.gp()){q.3y.95();e.2w();F}if(q.L.1P(\'4b\')){E 4G=q.J.iG();E am=$(4G).4G()[0];if(4G&&4G.1p===\'fT\')$(4G).1u();if(am&&am.1p===\'fT\')$(am).1u()}q.1D.hp();q.1D.ij(e)}q.1e.1S()},fN:C(4W,1k){if(!4W&&(q.1X.7g()==\'2y\'||q.1X.7g()==\'4W\')){q.1X.9K(O);if(q.1D.fJ(1k)){q.25.1U()}}},fJ:C(1k){E k=q.3j;E 4X=[k.84,k.8Q,k.70,k.a7,k.b2,k.dx,k.fK,k.fL,k.fM,k.fU];F($.3t(1k,4X)==-1)?1q:O},fV:C(4W){if(!4W)F;if((q.1X.7g()==\'2y\'||q.1X.7g()==\'4W\')){q.1X.9K(O);F}q.1X.9K(\'4W\')},g6:C(e,1k){if(q.1D.48&&1k===90&&!e.6s&&!e.g1&&q.G.25.12){e.2w();q.25.9l();F}N if(q.1D.48&&1k===90&&e.6s&&!e.g1&&q.G.9k.12!==0){e.2w();q.25.a9();F}N if(!q.1D.48){if(1k==q.3j.84||1k==q.3j.8Q||(1k==q.3j.70&&!e.9u&&!e.6s)||1k==q.3j.a7){q.25.1U()}}},fY:C(e,1k){if(q.1D.48&&1k===65){q.L.gW()}N if(1k!=q.3j.g0&&!q.1D.48){q.L.8U()}},fH:C(){E 2d=[q.1D.29,q.1D.2F,q.1D.7Y];2B(E i=0;i<2d.12;i++){if(2d[i]){q.1D.fC(2d[i]);F O}}},i4:C(e){q.25.1U();if(q.L.6T()){F q.1D.9x(e)}F q.1D.6x(e)},fG:C(e,1k){if(!q.G.fp)F 1q;if(q.L.3z(q.1e.1b())&&q.G.9Y===O)F 1q;e.2w();E Q;if(q.1D.2F&&!e.6s){Q=(q.G.6v)?1l.8W(9F(q.G.6v+1).3c(\'\\9Z\')):1l.8W(\'\\t\');q.1Y.Q(Q);q.1e.1S()}N if(q.G.9Y!==O){Q=1l.8W(9F(q.G.9Y+1).3c(\'\\9Z\'));q.1Y.Q(Q);q.1e.1S()}N{if(e.6J&&1k===e5)q.3y.95();N if(e.6J&&1k===ek)q.3y.bo();N if(!e.6s)q.3y.bo();N q.3y.95()}F O},fs:C(){E 4C=q.J.4a();E 9X=4C.3x.K(/<br\\s?\\/?>/gi,\'\');if((4C.1p===\'89\'||4C.1p===\'P\')&&9X===\'\'&&!$(4C).3i(\'I-T\')){E br=1l.3w(\'br\');$(4C).2t(br);q.1V.bT(br);q.1e.1S();F O}},fm:C(){E 4C=q.J.4a();E 9X=4C.3x.K(/<br\\s?\\/?>/gi,\'\');if(4C.1p===\'89\'&&q.L.3z(9X)&&!$(4C).3i(\'I-T\')){E p=1l.3w(\'p\');p.3x=q.G.6o;$(4C).2t(p);q.1V.2W(p);q.1e.1S();F O}N if(q.G.fh&&4C.1p==\'P\'){$(4C).1K(\'1G\').1K(\'1o\')}},fj:C(e){e.2w();q.J.1b();E p=1l.3w(\'p\');p.3x=q.G.6o;q.14.55();q.14.3L(p);q.1V.2W(p);q.1e.1S();F O},fk:C(e){if(!q.L.6T())F;E 5q=$.3k($(q.1D.R).B());if(5q.3N(/(<br\\s?\\/?>){2}$/i)!=-1){e.2w();if(q.G.1M){E br=1l.3w(\'br\');$(q.1D.29).3F(br);q.1V.bT(br);$(q.1D.R).B(5q.K(/<br\\s?\\/?>$/i,\'\'))}N{E Q=$(q.G.5S);$(q.1D.29).3F(Q);q.1V.2W(Q)}F 1q}F},fC:C(2j){if(!q.L.6T())F;q.25.1U();if(q.G.1M){E 26=$(\'<1i>\').1F($.3k(q.$T.B())).26();E 2Z=26.2Z()[0];if(2Z.1p==\'6w\'&&2Z.3x===\'\'){2Z=26.4G()[0]}if(q.L.6q(2Z)!=q.L.6q(2j))F;E br=1l.3w(\'br\');$(2j).3F(br);q.1V.54(br)}N{if(q.$T.26().2Z()[0]!==2j)F;E Q=$(q.G.5S);$(2j).3F(Q);q.1V.2W(Q)}},fE:C(e){e.2w();E Q=1l.8W(\'\\n\');q.J.1b();q.14.55();q.14.3L(Q);q.1V.54(Q);q.1e.1S();F O},6x:C(e){F q.1D.bR(e)},9x:C(e){F q.1D.bR(e,1q)},bR:C(e,fv){e.fw();q.J.1b();E 5t=1l.3w(\'br\');if(q.L.1P(\'2E\')){q.14.43(O);q.14.3P(q.14.bQ,q.14.bO)}N{q.14.55()}q.14.3L(5t);E $9W=$(5t).1r("a");if($9W.12>0){$9W.1h(5t).1u();$9W.3F(5t)}if(fv===1q){E $1N=$(5t).1N();if($1N.12!==0&&$1N[0].1p===\'58\'&&q.L.dN()){q.1V.54(5t);q.1e.1S();F O}E bP=1l.3w(\'br\');q.14.3L(bP);q.1V.54(bP)}N{if(q.L.1P(\'2E\')){E 3g=1l.3w(\'1j\');3g.3x=\'&#9T;\';$(5t).3F(3g);q.1V.54(3g);$(3g).1u()}N{E 14=1l.92();14.9I(5t);14.43(1q);E J=3l.4D();J.8T();J.4l(14)}}q.1e.1S();F O},hp:C(){E $1z=$(q.1D.1z);if($1z.1g().3N(/^\\6g$/g)===0){$1z.1u()}},ij:C(e){E $1z=$(q.1D.1z);E $1r=$(q.1D.1r);E 2Y=$1z.2q(\'2Y\',q.$T[0]);if(2Y.12!==0&&$1z.2q(\'li\',q.$T[0])&&$1r.3O(\'li\').12===1){if(!q.L.3z($1z.1g()))F;e.2w();$1z.1u();$1r.1u();q.1V.2W(2Y)}}}},2s:C(){F{3Q:C(e){if(q.7B)F;E 1k=e.7U;q.2s.1z=q.J.3B();q.2s.1r=q.J.67();E $1r=q.L.4p($(q.2s.1r).1r());E kA=q.1X.2u(\'2s\',e);if(kA===O){e.2w();F O}if(!q.G.1M&&q.2s.1z.a8==3&&q.2s.1z.12<=1&&(q.2s.1r===O||q.2s.1r.1p==\'e6\')){q.2s.9U()}if(!q.G.1M&&q.L.4p(q.2s.1z)&&q.2s.1z.1p===\'89\'){q.2s.9U(O)}if(!q.G.1M&&$(q.2s.1r).3i(\'I-7s-3g\')&&($1r===O||$1r[0].1p==\'e6\')){$(q.2s.1r).26().3Y();q.2s.9U()}if(q.2z.aD()&&q.2z.kB(1k))q.2z.30();if(1k===q.3j.8Q||1k===q.3j.84){if(q.L.1P(\'4b\')){E 2Y=$(q.1D.1z).2q(\'2Y\',q.$T[0]);if(2Y.9B()!==0&&2Y.1g()!==\'\'){e.2w();F O}}q.1x.4r();if(q.1R.M){e.2w();q.M.7W();q.25.1U();q.M.1u(q.1R.M);q.1R.M=O;F O}q.$T.1h(\'p\').1B($.1d(C(i,s){q.L.4f(i,$(s).B())},q));if(q.G.1M&&q.2s.1z&&q.2s.1z.1p==\'89\'&&q.L.3z(q.2s.1z.3x)){$(q.2s.1z).3F(q.J.5a());q.J.3d();$(q.2s.1z).1u()}F q.2s.kN(e)}},9U:C(8O){E $1z=$(q.2s.1z);E Q;if(8O===O){Q=$(\'<p>\').1F($1z.B())}N{Q=$(\'<p>\').1F($1z.8O())}$1z.2t(Q);E 1N=$(Q).1N();if(1s(1N[0])!==\'1y\'&&1N[0].1p==\'58\'){1N.1u()}q.1V.3P(Q)},kN:C(e){E B=$.3k(q.$T.B());if(!q.L.3z(B))F;e.2w();if(q.G.1M){q.$T.B(q.J.5a());q.J.3d()}N{q.$T.B(q.G.5S);q.2n.2W()}q.1e.1S();F O}}},1H:C(){F{2R:C(){q.G.bU=q.G.kn[q.G.1H]},1b:C(1w){F(1s q.G.bU[1w]!=\'1y\')?q.G.bU[1w]:\'\'}}},3K:C(){F{1Y:C(){q.25.1U();E 1Z=q.J.3X();if(1Z[0]!==O&&q.3K.jZ(1Z)){if(!q.L.1P(\'2E\'))q.$T.2n();F}if(q.L.1P(\'2E\')){q.3K.aR()}N{q.3K.kc()}},jZ:C(1Z){E 9y=[\'li\',\'2Y\',\'5P\',\'29\',\'7Y\',\'2F\',\'dl\',\'dt\',\'dd\'];E 3I=1Z[0].1p.3e();E 2Z=q.J.kJ();2Z=(1s 2Z==\'1y\')?3I:2Z.1p.3e();E bN=$.3t(3I,9y)!=-1;E kl=$.3t(2Z,9y)!=-1;if((bN&&kl)||bN){F 1q}},aR:C(){q.L.8z();q.25.1U();q.1Y.Q(1l.3w(\'hr\'));q.L.bk();q.1e.1S()},kc:C(){q.25.1U();E bV=\'<p id="I-1Y-3K"><br /></p>\';if(q.G.1M)bV=\'<br id="I-1Y-3K">\';1l.3Z(\'na\',O,\'<hr>\'+bV);q.3K.k9();q.1e.1S()},k9:C(){E Q=q.$T.1h(\'#I-1Y-3K\');E 1N=$(Q).1N()[0];E 1Q=1N;if(q.L.1P(\'4b\')&&1N&&1N.3x===\'\'){1Q=$(1N).1N()[0];$(1N).1u()}if(1Q){Q.1u();if(!q.G.1M){q.$T.2n();q.3K.2W(1Q)}}N{Q.1K(\'id\');q.3K.2W(Q[0])}},2W:C(Q){if(1s Q===\'1y\')F;E jQ=1l.8W(\'\\6g\');q.J.1b();q.14.2W(Q,0);q.14.3L(jQ);q.14.43(1q);q.J.4l()}}},V:C(){F{2O:C(e){if(1s e!=\'1y\'&&e.2w)e.2w();if(!q.1R.c7(\'a\')){q.1a.2R(\'V\',q.1H.1b(\'ba\'),jS)}N{q.1a.2R(\'V\',q.1H.1b(\'ca\'),jS)}q.1a.cy();E kE=!q.1R.c7(\'a\')?q.1H.1b(\'1Y\'):q.1H.1b(\'7L\');q.V.kL=q.1a.cz(kE);q.J.1b();q.V.kG();q.V.kg();if(q.V.1Q==\'7K\')$(\'#I-V-7Z\').6j(\'a0\',1q);q.V.$9n=$(\'#I-V-2i\');q.V.$bZ=$(\'#I-V-2i-1g\');q.V.$bZ.2K(q.V.1g);q.V.$9n.2K(q.V.2i);q.V.kL.on(\'2y\',$.1d(q.V.1Y,q));$(\'.I-V-3q\').1u();q.J.3o();q.1a.2O();q.V.$9n.2n()},kg:C(){E jV=3u.jU.2k.K(/\\/$/i,\'\');if(1s q.V.2i!=="1y"){q.V.2i=q.V.2i.K(jV,\'\');q.V.2i=q.V.2i.K(/^\\/#/,\'#\');q.V.2i=q.V.2i.K(\'bY:\',\'\');if(!q.G.5c){E 3J=2a 2l(\'^(8s|8K|5o)://\'+3u.jU.n4,\'i\');q.V.2i=q.V.2i.K(3J,\'\')}}},kG:C(){q.V.$Q=O;E $el=$(q.J.3B()).2q(\'a\',q.$T[0]);if($el.12!==0&&$el[0].1p===\'A\'){q.V.$Q=$el;q.V.2i=$el.1c(\'2k\');q.V.1g=$el.1g();q.V.1Q=$el.1c(\'1Q\')}N{q.V.1g=q.2T.4y();q.V.2i=\'\';q.V.1Q=\'\'}},1Y:C(){q.3f.1u();E 1Q=\'\';E V=q.V.$9n.2K();E 1g=q.V.$bZ.2K().K(/(<([^>]+)>)/ig,"");if($.3k(V)===\'\'){q.V.$9n.2f(\'I-3D-6U\').on(\'2s\',C(){$(q).2S(\'I-3D-6U\');$(q).3h(\'2s\')});F}if(V.3N(\'@\')!=-1&&/(8s|8K|5o):\\/\\//i.bE(V)===O){V=\'bY:\'+V}N if(V.3N(\'#\')!==0){if($(\'#I-V-7Z\').6j(\'a0\')){1Q=\'7K\'}E 7D=\'((jT--)?[a-7t-9]+(-[a-7t-9]+)*\\\\.)+[a-z]{2,}\';E 3J=2a 2l(\'^(8s|8K|5o)://\'+7D,\'i\');E a1=2a 2l(\'^\'+7D,\'i\');E km=2a 2l(\'\\.(B|nh)$\',\'i\');if(V.3N(3J)==-1&&V.3N(km)==-1&&V.3N(a1)===0&&q.G.5c){V=q.G.5c+\'://\'+V}}q.V.1U(1g,V,1Q);q.1a.4j()},1U:C(1g,V,1Q){1g=$.3k(1g.K(/<|>/g,\'\'));q.J.3d();E 1Z=q.J.3X();if(1g===\'\'&&V===\'\')F;if(1g===\'\'&&V!==\'\')1g=V;if(q.V.$Q){q.25.1U();E $V=q.V.$Q,$el=$V.3O();if($el.12>0){56($el.12){$el=$el.3O()}$el=$el.2h()}N{$el=$V}$V.1c(\'2k\',V);$el.1g(1g);if(1Q!==\'\'){$V.1c(\'1Q\',1Q)}N{$V.1K(\'1Q\')}q.J.9g($V);q.1e.1S()}N{if(q.L.1P(\'4b\')&&q.V.1g===\'\'){E $a=$(\'<a />\').1c(\'2k\',V).1g(1g);if(1Q!==\'\')$a.1c(\'1Q\',1Q);q.1Y.Q($a);q.J.9g($a)}N{E $a;if(q.L.1P(\'2E\')){$a=$(\'<a 2k="\'+V+\'">\').1g(1g);if(1Q!==\'\')$a.1c(\'1Q\',1Q);$a=$(q.1Y.Q($a));if(q.J.e1().1T(/\\s$/)){$a.3F(" ")}q.J.9g($a)}N{1l.3Z(\'nt\',O,V);$a=$(q.J.3B()).2q(\'a\',q.$T[0]);if(q.L.1P(\'4b\')){$a=$(\'a[k3=""]\')}if(1Q!==\'\')$a.1c(\'1Q\',1Q);$a.1K(\'1o\').1K(\'k3\');if(q.J.e1().1T(/\\s$/)){$a.3F(" ")}if(q.V.1g!==\'\'||q.V.1g!=1g){if(!q.G.1M&&1Z&&1Z.12<=1){$a.1g(1g)}q.J.9g($a)}}}q.1e.1S();q.1X.2u(\'nu\',$a)}3A($.1d(C(){q.1R.5n()},q),5)},6P:C(e){if(1s e!=\'1y\'&&e.2w){e.2w()}E 23=q.J.6I();if(!23)F;q.25.1U();E 2p=23.12;E 5n=[];2B(E i=0;i<2p;i++){if(23[i].1p===\'A\'){5n.2N(23[i])}E $Q=$(23[i]).2q(\'a\',q.$T[0]);$Q.2t($Q.26())}q.1X.2u(\'nv\',5n);$(\'.I-V-3q\').1u();q.1e.1S()},7O:C(3E){q.V.8g(3E,\'7O\')},2f:C(3E){q.V.8g(3E,\'2f\')},2S:C(3E){q.V.8g(3E,\'2S\')},8g:C(3E,1C){E 5n=q.J.kq([\'a\']);if(5n===O)F;$.1B(5n,C(){$(q)[1C](3E)})}}},2z:C(){F{kB:C(1k){F 1k==q.3j.70||1k==q.3j.a7},aD:C(){F q.G.a2&&(q.G.c1||q.G.bX||q.G.93)&&!q.L.4S(\'8o\')},30:C(){E 2z=q.2z,G=q.G;q.$T.1h(":6h(4R,1L,a,2F)").ni().26().bW(C(){F q.a8===3&&$.3k(q.5O)!=""&&!$(q).1r().is("2F")&&(q.5O.1T(G.2z.4v.72)||q.5O.1T(G.2z.4v.71)||q.5O.1T(G.2z.4v.M)||q.5O.1T(G.2z.4v.2i))}).1B(C(){E 1g=$(q).1g(),B=1g;if(G.93&&(B.1T(G.2z.4v.72)||B.1T(G.2z.4v.71))){B=2z.93(B)}N if(G.bX&&B.1T(G.2z.4v.M)){B=2z.kT(B)}N if(G.c1){B=2z.a2(B)}$(q).a6(1g.K(1g,B)).1u()});E ka=q.$T.1h(\'.I-2z-41\').1B(C(){E $el=$(q);$el.2S(\'I-2z-41\');if($el.1c(\'1G\')===\'\')$el.1K(\'1G\');F $el[0]});q.1X.2u(\'2z\',ka);q.1e.1S()},93:C(B){E bM=\'<4R 1G="I-2z-41" 2J="nm" 3n="no" 4t="\',bK=\'" nn="0" o0></4R>\';if(B.1T(q.G.2z.4v.72)){B=B.K(q.G.2z.4v.72,bM+\'//7n.72.a5/7i/$1\'+bK)}if(B.1T(q.G.2z.4v.71)){B=B.K(q.G.2z.4v.71,bM+\'//oI.71.a5/6Y/$2\'+bK)}F B},kT:C(B){E 3M=B.1T(q.G.2z.4v.M);if(3M){B=B.K(B,\'<1L 4t="\'+3M+\'" 1G="I-2z-41" />\');if(q.G.1M){if(!q.L.3z(q.1e.1b())){B=\'<br>\'+B}}B+=\'<br>\'}F B},a2:C(B){E 3M=B.1T(q.G.2z.4v.2i);if(3M){3M=$.oJ(3M,C(v,k){F $.3t(v,3M)===k});E 12=3M.12;2B(E i=0;i<12;i++){E 2k=3M[i],1g=2k,5c=q.G.5c+\'://\';if(2k.1T(/(5o?|8K):\\/\\//i)!==4e){5c=""}if(1g.12>q.G.cs){1g=1g.aB(0,q.G.cs)+\'...\'}1g=fl(1g);E cu="\\\\b";if($.3t(2k.ct(-1),["/","&","="])!=-1){cu=""}E kx=2a 2l(\'(\'+2k.K(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,"\\\\$&")+cu+\')\',\'g\');B=B.K(kx,\'<a 2k="\'+5c+$.3k(2k)+\'" 1G="I-2z-41">\'+$.3k(1g)+\'</a>\')}}F B}}},2e:C(){F{3m:C(4H){q.3f.1u();if(!q.L.1P(\'2E\'))q.$T.2n();q.25.1U();q.J.3o();E 1r=q.J.67();E $2e=$(1r).2q(\'ol, 3p\',q.$T[0]);if(!q.L.4p($2e)&&$2e.12!==0){$2e=O}E cq,cn;E 1u=O;if($2e&&$2e.12){1u=1q;E cr=$2e[0].1p;cq=(4H===\'5z\'&&cr===\'8D\');cn=(4H===\'5m\'&&cr===\'8N\')}if(cq){q.L.4I($2e,\'ol\')}N if(cn){q.L.4I($2e,\'3p\')}N{if(1u){q.2e.1u(4H,$2e)}N{q.2e.1Y(4H)}}q.J.3d();q.1e.1S()},1Y:C(4H){E 1z=q.J.3B();E $2Y=$(1z).2q(\'2Y, 5P\',q.$T[0]);if(q.L.1P(\'2E\')&&q.G.1M){q.2e.aR(4H)}N{1l.3Z(\'1Y\'+4H)}E 1r=q.J.67();E $2e=$(1r).2q(\'ol, 3p\',q.$T[0]);if($2Y.12!==0){E iK=$2Y.8O();$2Y.3F(iK).1u(\'\')}if(q.L.3z($2e.1h(\'li\').1g())){E $3O=$2e.3O(\'li\');$3O.1h(\'br\').1u();$3O.1F(q.J.5a());if(q.G.1M&&q.L.1P(\'4b\')&&$3O.9B()==2&&q.L.3z($3O.eq(1).1g())){$3O.eq(1).1u()}}if($2e.12){E $7X=$2e.1r();if(q.L.4p($7X)&&$7X[0].1p!=\'5v\'&&q.L.6X($7X[0])){$7X.2t($7X.26())}}if(!q.L.1P(\'2E\')){q.$T.2n()}q.1x.4r()},aR:C(4H){E 4M=q.J.5Z(\'1i\');E aP=$(4M).B();E 85=(4H==\'5z\')?$(\'<ol>\'):$(\'<3p>\');E 8c=$(\'<li>\');if($.3k(aP)===\'\'){8c.1F(q.J.5a());85.1F(8c);q.$T.1h(\'#J-2r-1\').2t(85)}N{E 8k=aP.4o(/<br\\s?\\/?>/gi);if(8k){2B(E i=0;i<8k.12;i++){if($.3k(8k[i])!==\'\'){85.1F($(\'<li>\').B(8k[i]))}}}N{8c.1F(aP);85.1F(8c)}$(4M).2t(85)}},1u:C(4H,$2e){if($.3t(\'3p\',q.J.3X()))4H=\'5m\';1l.3Z(\'1Y\'+4H);E $1z=$(q.J.3B());q.3y.aO();if(!q.G.1M&&$1z.2q(\'li, 5P, 2Y\',q.$T[0]).12===0){1l.3Z(\'9S\',O,\'p\');q.$T.1h(\'3p, ol, 29\').1B($.1d(q.L.4f,q))}E $3W=$(q.J.3B()).2q(\'3W\',q.$T[0]);E $4G=$3W.4G();if(!q.G.1M&&$3W.12!==0&&$4G.12!==0&&$4G[0].1p==\'58\'){$4G.1u()}q.1x.4r()}}},1a:C(){F{aM:{},iW:C(){q.G.1a={iX:6f()+\'<49 id="I-1a-M-7L">\'+\'<2L>\'+q.1H.1b(\'1J\')+\'</2L>\'+\'<3D 1m="1g" id="I-M-1J" />\'+\'<2L 1G="I-M-V-42">\'+q.1H.1b(\'V\')+\'</2L>\'+\'<3D 1m="1g" id="I-M-V" 1G="I-M-V-42" 4K-2L="\'+q.1H.1b(\'V\')+\'" />\'+\'<2L 1G="I-M-V-42"><3D 1m="iP" id="I-M-V-7Z" 4K-2L="\'+q.1H.1b(\'aL\')+\'"> \'+q.1H.1b(\'aL\')+\'</2L>\'+\'<2L 1G="I-M-4g-42">\'+q.1H.1b(\'cC\')+\'</2L>\'+\'<7z 1G="I-M-4g-42" id="I-M-5g" 4K-2L="\'+q.1H.1b(\'cC\')+\'">\'+\'<42 1E="5p">\'+q.1H.1b(\'5p\')+\'</42>\'+\'<42 1E="2c">\'+q.1H.1b(\'2c\')+\'</42>\'+\'<42 1E="5u">\'+q.1H.1b(\'5u\')+\'</42>\'+\'<42 1E="4s">\'+q.1H.1b(\'4s\')+\'</42>\'+\'</7z>\'+\'</49>\',M:6f()+\'<49 id="I-1a-M-1Y">\'+\'<1i id="I-1a-M-4d"></1i>\'+\'</49>\',22:6f()+\'<49 id="I-1a-22-1Y">\'+\'<1i id="I-1a-22-1v-2Q">\'+\'<2L>\'+q.1H.1b(\'6k\')+\'</2L>\'+\'<3D 1m="1g" id="I-6k" 4K-2L="\'+q.1H.1b(\'6k\')+\'" /><br><br>\'+\'<1i id="I-1a-22-1v"></1i>\'+\'</1i>\'+\'</49>\',V:6f()+\'<49 id="I-1a-V-1Y">\'+\'<2L>cD</2L>\'+\'<3D 1m="2i" id="I-V-2i" 4K-2L="cD" />\'+\'<2L>\'+q.1H.1b(\'1g\')+\'</2L>\'+\'<3D 1m="1g" id="I-V-2i-1g" 4K-2L="\'+q.1H.1b(\'1g\')+\'" />\'+\'<2L><3D 1m="iP" id="I-V-7Z"> \'+q.1H.1b(\'aL\')+\'</2L>\'+\'</49>\'};$.7E(q.G,q.G.1a)},cB:C(1w,2A){q.1a.aM[1w]=2A},oX:C($1a){q.1a.$94=$(\'<1i>\').1c(\'id\',\'I-1a-94\');$1a.6t(q.1a.$94)},oY:C(id,1w,8Z){E $5I=$(\'<a 2k="#" 3T="5I\'+id+\'">\').1g(1w);if(8Z){$5I.2f(\'8Z\')}E 3u=q;$5I.on(\'2y\',C(e){e.2w();$(\'.I-5I\').3v();$(\'.I-\'+$(q).1c(\'3T\')).2O();3u.1a.$94.1h(\'a\').2S(\'8Z\');$(q).2f(\'8Z\')});q.1a.$94.1F($5I)},oZ:C(1w,ic){q.G.1a[1w]=ic},i9:C(1w){F q.G.1a[1w]},oU:C(){F q.$aX.1h(\'49\')},2R:C(62,1J,2J){q.1a.62=62;q.1a.2J=2J;q.1a.2o();q.1a.jr();q.1a.i7(1J);q.1a.ik();q.1a.i8();if(1s q.1a.aM[62]!=\'1y\'){q.1a.aM[62].6e(q)}},2O:C(){q.L.d8();if(q.L.6M()){q.1a.cx()}N{q.1a.aZ()}if(q.G.cA){q.$4F.2f("I-1a-jP")}q.$74.2O();q.$4F.2O();q.$1a.1c(\'6S\',\'-1\');q.$1a.2n();q.1a.ip();q.L.8z();if(!q.L.6M()){3A($.1d(q.1a.aZ,q),0);$(3l).on(\'4J.I-1a\',$.1d(q.1a.4J,q))}q.1X.2u(\'oP\',q.1a.62,q.$1a);$(1l).3h(\'oO.1a\');q.$1a.1h(\'3D[1m=1g],3D[1m=2i],3D[1m=oQ]\').on(\'1D.I-1a\',$.1d(q.1a.iu,q))},aZ:C(){E 3n=q.$1a.oR();E aT=$(3l).3n();E 7u=$(3l).2J();if(q.1a.2J>7u){q.$1a.1O({2J:\'96%\',63:(aT/2-3n/2)+\'px\'});F}if(3n>aT){q.$1a.1O({2J:q.1a.2J+\'px\',63:\'oS\'})}N{q.$1a.1O({2J:q.1a.2J+\'px\',63:(aT/2-3n/2)+\'px\'})}},cx:C(){q.$1a.1O({2J:\'96%\',63:\'2%\'})},4J:C(){if(q.L.6M()){q.1a.cx()}N{q.1a.aZ()}},i7:C(1J){q.$9e.B(1J)},i8:C(){q.$aX.B(q.1a.i9(q.1a.62))},ik:C(){if(1s $.fn.iv===\'1y\')F;q.$1a.iv({iw:q.$9e});q.$9e.1O(\'oa\',\'oc\')},iu:C(e){if(e.7U!=13)F;e.2w();q.$1a.1h(\'1t.I-1a-7M-21\').2y()},cy:C(){E 1t=$(\'<1t>\').2f(\'I-1a-21 I-1a-4j-21\').B(q.1H.1b(\'it\'));1t.on(\'2y\',$.1d(q.1a.4j,q));q.$9i.1F(1t)},io:C(2L){F q.1a.cm(2L,\'83\')},cz:C(2L){F q.1a.cm(2L,\'7M\')},cm:C(2L,3E){E 1t=$(\'<1t>\').2f(\'I-1a-21\').2f(\'I-1a-\'+3E+\'-21\').B(2L);q.$9i.1F(1t);F 1t},ip:C(){E 4i=q.$9i.1h(\'1t\');E cl=4i.12;if(cl===0)F;4i.1O(\'2J\',(88/cl)+\'%\')},2o:C(){q.1a.jw();q.$4F=$(\'<1i id="I-1a-2Q"/>\').3v();q.$1a=$(\'<1i id="I-1a" 9c="o9" 4K-o8="I-1a-87" />\');q.$9e=$(\'<87 id="I-1a-87"/>\');q.$8X=$(\'<1t 1m="1t" id="I-1a-4j" 6S="1" 4K-2L="o3" />\').B(\'&o2;\');q.$aX=$(\'<1i id="I-1a-31" />\');q.$9i=$(\'<c8 />\');q.$1a.1F(q.$9e);q.$1a.1F(q.$8X);q.$1a.1F(q.$aX);q.$1a.1F(q.$9i);q.$4F.1F(q.$1a);q.$4F.aU(1l.31)},jw:C(){q.$74=$(\'<1i id="I-1a-o5">\').3v();$(\'31\').6t(q.$74)},jr:C(){q.$8X.on(\'2y.I-1a\',$.1d(q.1a.4j,q));$(1l).on(\'2s.I-1a\',$.1d(q.1a.9a,q));q.$T.on(\'2s.I-1a\',$.1d(q.1a.9a,q));q.$4F.on(\'2y.I-1a\',$.1d(q.1a.4j,q))},jC:C(){q.$8X.3h(\'2y.I-1a\');$(1l).3h(\'2s.I-1a\');q.$T.3h(\'2s.I-1a\');q.$4F.3h(\'2y.I-1a\');$(3l).3h(\'4J.I-1a\')},9a:C(e){if(e.7U!=q.3j.b2)F;q.1a.4j(O)},4j:C(e){if(e){if(!$(e.1Q).3i(\'I-1a-4j-21\')&&e.1Q!=q.$8X[0]&&e.1Q!=q.$4F[0]){F}e.2w()}if(!q.$4F)F;q.1a.jC();q.L.bJ();q.$74.1u();q.$4F.iM(\'of\',$.1d(C(){q.$4F.1u();3A($.1d(q.L.bk,q),0);if(e!==1y)q.J.3d();$(1l.31).1O(\'bI\',q.1a.og);q.1X.2u(\'ot\',q.1a.62)},q))}}},1R:C(){F{2R:C(){if(1s q.G.jL!="1y")F;if(q.L.1P(\'2E\')){E 3u=q;q.$T.1h(\'2F, 1e\').on(\'ay\',C(){3u.$T.1c(\'5d\',O);$(q).1c(\'5d\',1q)}).on(\'az\',C(){3u.$T.1c(\'5d\',1q);$(q).1K(\'5d\')})}q.1R.au();q.1R.5n()},1A:C(e,2g){q.1R.4i(e,2g);q.1R.79()},c7:C($el,$1z){if(1s $1z==\'1y\'){E $1z=$(q.J.3B())}F $1z.is($el)||$1z.dL($el).12>0},79:C(){E $1z=$(q.J.3B());$.1B(q.G.1R.79,$.1d(C(1k,1E){E 1R=1E.1R,2j=1R.2j,$2x=1E.2x,c3=1s 1R[\'in\']!=\'1y\'?1R[\'in\']:O,c6=1s 1R[\'2m\']!=\'1y\'?1R[\'2m\']:O;if($1z.2q(2j).9B()>0){q.1R.c4($2x,c3,c6)}N{q.1R.c4($2x,c6,c3)}},q))},c4:C($2x,9s,ax){if(ax&&1s ax[\'1c\']!=\'1y\'){q.1R.c5($2x,ax.1c,1q)}if(1s 9s[\'1c\']!=\'1y\'){q.1R.c5($2x,9s.1c)}if(1s 9s[\'1J\']!=\'1y\'){$2x.1g(9s[\'1J\'])}},c5:C($2x,jq,cb){$.1B(jq,C(1k,1E){if(1k==\'1G\'){if(!cb){$2x.2f(1E)}N{$2x.2S(1E)}}N{if(!cb){$2x.1c(1k,1E)}N{$2x.1K(1k)}}})},cc:C($2x,2g,2X){if(1s 2X.1R=="1y")F;2X.2x=$2x;q.G.1R.79.2N(2X)},4i:C(e,2g){E 1z=q.J.3B();E 1r=q.J.67();if(e!==O){q.1t.cj()}N{q.1t.cj(2g)}if(e===O&&2g!==\'B\'){if($.3t(2g,q.G.b5)!=-1)q.1t.oq(2g);F}$.1B(q.G.cg,$.1d(C(1k,1E){E aw=$(1r).2q(1k,q.$T[0]);E ck=$(1z).2q(1k,q.$T[0]);if(aw.12!==0&&!q.L.4p(aw))F;if(!q.L.4p(ck))F;if(aw.12!==0||ck.2q(1k,q.$T[0]).12!==0){q.1t.9q(1E)}},q));E $1r=$(1r).2q(q.G.8F.4y().3e(),q.$T[0]);if(q.L.4p(1r)&&$1r.12){E 5g=($1r.1O(\'1g-5g\')===\'\')?\'2c\':$1r.1O(\'1g-5g\');q.1t.9q(\'5g\'+5g)}},oi:C(Y,2g){q.G.b5.2N(2g);q.G.cg[Y]=2g},au:C(){q.$T.1h(\'1L\').1B($.1d(C(i,1L){E $1L=$(1L);$1L.2q(\'a\',q.$T[0]).on(\'2y\',C(e){e.2w()});if(q.L.1P(\'2E\'))$1L.1c(\'oh\',\'on\');q.M.j1($1L)},q));$(1l).on(\'2y.I-M-83.\'+q.2G,$.1d(C(e){q.1R.M=O;if(e.1Q.1p==\'aA\'&&q.L.4p(e.1Q)){q.1R.M=(q.1R.M&&q.1R.M==e.1Q)?O:e.1Q}},q))},5n:C(){if(!q.G.j4)F;q.$T.1h(\'a\').on(\'5H.I.\'+q.2G+\' 2y.I.\'+q.2G,$.1d(q.1R.jc,q));q.$T.on(\'5H.I.\'+q.2G+\' 2y.I.\'+q.2G,$.1d(q.1R.cf,q));$(1l).on(\'5H.I.\'+q.2G+\' 2y.I.\'+q.2G,$.1d(q.1R.cf,q))},jl:C($V){F $V.2I()},jc:C(e){E $el=$(e.1Q);if($el[0].1p==\'aA\')F;if($el[0].1p!==\'A\')$el=$el.2q(\'a\',q.$T[0]);if($el[0].1p!==\'A\')F;E $V=$el;E 3s=q.1R.jl($V);E 3q=$(\'<1j 1G="I-V-3q"></1j>\');E 2k=$V.1c(\'2k\');if(2k===1y){2k=\'\'}if(2k.12>24)2k=2k.aB(0,24)+\'...\';E jj=$(\'<a 2k="\'+$V.1c(\'2k\')+\'" 1Q="7K" />\').B(2k).2f(\'I-V-3q-7M\');E jf=$(\'<a 2k="#" />\').B(q.1H.1b(\'7L\')).on(\'2y\',$.1d(q.V.2O,q)).2f(\'I-V-3q-7M\');E je=$(\'<a 2k="#" />\').B(q.1H.1b(\'6P\')).on(\'2y\',$.1d(q.V.6P,q)).2f(\'I-V-3q-7M\');3q.1F(jj).1F(\' | \').1F(jf).1F(\' | \').1F(je);3q.1O({2U:(3s.2U+5L($V.1O(\'3K-3n\'),10))+\'px\',2c:3s.2c+\'px\'});$(\'.I-V-3q\').1u();$(\'31\').1F(3q)},cf:C(e){e=e.7T||e;E 1Q=e.1Q;E $1r=$(1Q).2q(\'a\',q.$T[0]);if($1r.12!==0&&$1r[0].1p===\'A\'&&1Q.1p!==\'A\'){F}N if((1Q.1p===\'A\'&&q.L.4p(1Q))||$(1Q).3i(\'I-V-3q-7M\')){F}$(\'.I-V-3q\').1u()}}},2V:C(){F{2R:C(B){if(q.G.1M)F B;if(B===\'\'||B===\'<p></p>\')F q.G.5S;B=B+"\\n";q.2V.aC=[];q.2V.z=0;B=B.K(/(<br\\s?\\/?>){1,}\\n?<\\/29>/gi,\'</29>\');B=q.2V.jk(B);B=q.2V.j6(B);B=q.2V.jF(B);B=q.2V.jp(B);B=q.2V.8M(B);B=q.2V.j7(B);B=B.K(2a 2l(\'<br\\\\s?/?>\\n?<(\'+q.G.ej.3c(\'|\')+\')(.*?[^>])>\',\'gi\'),\'<p><br /></p>\\n<$1$2>\');F $.3k(B)},jk:C(B){E $1i=$(\'<1i />\').1F(B);$1i.1h(\'29 p\').2t(C(){F $(q).1F(\'<br />\').26()});B=$1i.B();$1i.1h(q.G.ej.3c(\', \')).1B($.1d(C(i,s){q.2V.z++;q.2V.aC[q.2V.z]=s.7v;B=B.K(s.7v,\'\\n{K\'+q.2V.z+\'}\')},q));F B},j6:C(B){E dX=B.1T(/<!--([\\w\\W]*?)-->/gi);if(!dX)F B;$.1B(dX,$.1d(C(i,s){q.2V.z++;q.2V.aC[q.2V.z]=s;B=B.K(s,\'\\n{K\'+q.2V.z+\'}\')},q));F B},j7:C(B){$.1B(q.2V.aC,C(i,s){s=(1s s!==\'1y\')?s.K(/\\$/g,\'&#36;\'):s;B=B.K(\'{K\'+i+\'}\',s)});F B},jp:C(B){E 4O=B.4o(2a 2l(\'\\n\',\'g\'),-1);B=\'\';if(4O){E 2p=4O.12;2B(E i=0;i<2p;i++){if(!4O.ow(i))F;if(4O[i].3N(\'{K\')==-1){4O[i]=4O[i].K(/<p>\\n\\t?<\\/p>/gi,\'\');4O[i]=4O[i].K(/<p><\\/p>/gi,\'\');if(4O[i]!==\'\'){B+=\'<p>\'+4O[i].K(/^\\n+|\\n+$/g,"")+"</p>"}}N B+=4O[i]}}F B},jF:C(B){B=B.K(/<br \\/>\\s*<br \\/>/gi,"\\n\\n");B=B.K(/<br\\s?\\/?>\\n?<br\\s?\\/?>/gi,"\\n<br /><br />");B=B.K(2a 2l("\\r\\n",\'g\'),"\\n");B=B.K(2a 2l("\\r",\'g\'),"\\n");B=B.K(2a 2l("/\\n\\n+/"),\'g\',"\\n\\n");F B},8M:C(B){B=B.K(2a 2l(\'</29></p>\',\'gi\'),\'</29>\');B=B.K(2a 2l(\'<p></29>\',\'gi\'),\'</29>\');B=B.K(2a 2l(\'<p><29>\',\'gi\'),\'<29>\');B=B.K(2a 2l(\'<29></p>\',\'gi\'),\'<29>\');B=B.K(2a 2l(\'<p><p \',\'gi\'),\'<p \');B=B.K(2a 2l(\'<p><p>\',\'gi\'),\'<p>\');B=B.K(2a 2l(\'</p></p>\',\'gi\'),\'</p>\');B=B.K(2a 2l(\'<p>\\\\s?</p>\',\'gi\'),\'\');B=B.K(2a 2l("\\n</p>",\'gi\'),\'</p>\');B=B.K(2a 2l(\'<p>\\t?\\t?\\n?<p>\',\'gi\'),\'<p>\');B=B.K(2a 2l(\'<p>\\t*</p>\',\'gi\'),\'\');F B}}},5C:C(){F{3Q:C(e){if(!q.G.jJ){3A($.1d(q.1e.1S,q),1);F}q.7B=1q;q.25.1U();q.J.3o();q.L.8z();q.5C.ju();$(3l).on(\'6b.I-jv\',$.1d(C(){$(3l).3U(q.bm)},q));3A($.1d(C(){E B=q.$5e.B();q.$5e.1u();q.J.3d();q.L.bk();q.5C.1Y(B);$(3l).3h(\'6b.I-jv\');if(q.2z.aD())q.2z.30()},q),1)},ju:C(){q.$5e=$(\'<1i>\').B(\'\').1c(\'5d\',\'1q\').1O({4g:\'82\',2J:0,2U:0,2c:\'-o4\'});if(q.L.1P(\'2E\')){q.$2Q.1F(q.$5e)}N{if($(\'.1a-31\').12>0){$(\'.1a-31\').1F(q.$5e)}N{$(\'31\').1F(q.$5e)}}q.$5e.2n()},1Y:C(B){B=q.1X.2u(\'od\',B);B=(q.L.9w())?q.1x.8y(B,O):q.1x.8y(B);B=q.1X.2u(\'5C\',B);if(q.L.9w()){q.1Y.1U(B,O)}N{q.1Y.B(B,O)}q.L.8U();q.7B=O;3A($.1d(q.1x.4r,q),10);3A($.1d(C(){E ii=q.$T.1h(\'1j\');$.1B(ii,C(i,s){E B=s.3x.K(/\\6g/,\'\');if(B===\'\'&&s.4u.12===0)$(s).1u()})},q),10)}}},3f:C(){F{9Q:C(){if(!q.3f.is())F;q.$T.1c(\'3f\',q.$2j.1c(\'3f\'));q.3f.3m();q.$T.on(\'1D.I-3f\',$.1d(q.3f.3m,q))},3m:C(){3A($.1d(C(){E 1C=q.L.3z(q.$T.B(),O)?\'2f\':\'2S\';q.$T[1C](\'I-3f\')},q),5)},1u:C(){q.$T.2S(\'I-3f\')},is:C(){if(q.G.3f){F q.$2j.1c(\'3f\',q.G.3f)}N{F!(1s q.$2j.1c(\'3f\')==\'1y\'||q.$2j.1c(\'3f\')===\'\')}}}},5E:C(){F{2O:C(){$(1l.31).1F($(\'<1i id="I-5E"><1j></1j></1i>\'));$(\'#I-5E\').oN()},3v:C(){$(\'#I-5E\').iM(oM,C(){$(q).1u()})}}},J:C(){F{1b:C(){q.2T=1l.4D();if(1l.4D&&q.2T.6l&&q.2T.7A){q.14=q.2T.6l(0)}N{q.14=1l.92()}},4l:C(){52{q.2T.8T()}51(e){}q.2T.4l(q.14)},3B:C(){E el=O;q.J.1b();if(q.2T&&q.2T.7A>0){el=q.2T.6l(0).ko}F q.L.4p(el)},67:C(4V){4V=4V||q.J.3B();if(4V){F q.L.4p($(4V).1r()[0])}F O},iG:C(){F 3l.4D().iI.oB},oz:C(){F 3l.4D().iI.oA},4a:C(Q){Q=Q||q.J.3B();56(Q){if(q.L.7J(Q.1p)){F($(Q).3i(\'I-T\'))?O:Q}Q=Q.e4}F O},e8:C(23,2d){q.J.1b();if(q.14&&q.14.53){F O}E 5U=[];23=(1s 23==\'1y\'||23===O)?q.J.6I():23;E 4N=q.G.4N;4N.2N(\'1j\');if(1s 2d!==\'1y\'){2B(E i=0;i<2d.12;i++){4N.2N(2d[i])}}$.1B(23,$.1d(C(i,Q){if($.3t(Q.1p.3e(),4N)!=-1){5U.2N(Q)}},q));F(5U.12===0)?O:5U},kq:C(2d){q.J.1b();if(q.14&&q.14.53){F O}E 5U=[];E 23=q.J.6I();$.1B(23,$.1d(C(i,Q){if($.3t(Q.1p.3e(),2d)!=-1){5U.2N(Q)}},q));F(5U.12===0)?O:5U},3X:C(23){q.J.1b();if(q.14&&q.14.53){F[q.J.4a()]}E 1Z=[];23=(1s 23==\'1y\')?q.J.6I():23;$.1B(23,$.1d(C(i,Q){if(q.L.6X(Q)){q.J.kI=Q;1Z.2N(Q)}},q));F(1Z.12===0)?[q.J.4a()]:1Z},kJ:C(){F q.J.kI},6I:C(){q.J.1b();E 78=q.J.ei(1);E 9J=q.J.ei(2);if(q.14.53===O){if(3l.4D){E 2T=3l.4D();if(2T.7A>0){E 14=2T.6l(0);E kf=14.ko,ef=14.ef;E 7F=14.7S();7F.43(O);7F.3L(9J);7F.2W(kf,ef);7F.43(1q);7F.3L(78);14.9I(78);14.ks(9J);2T.8T();2T.4l(14)}}}N{q.J.k0(q.14,78,1q);9J=78}E 23=[];E 9z=0;E 3u=q;q.$T.1h(\'*\').1B(C(){if(q==78){E 1r=$(q).1r();if(1r.12!==0&&1r[0].1p!=\'e6\'&&3u.L.4p(1r[0])){23.2N(1r[0])}23.2N(q);9z=1}N{if(9z>0){23.2N(q);9z=9z+1}}if(q==9J){F O}});E eb=[];E 2p=23.12;2B(E i=0;i<2p;i++){if(23[i].id!=\'23-2r-1\'&&23[i].id!=\'23-2r-2\'){eb.2N(23[i])}}q.J.kp();F eb},ei:C(6d){F $(\'<1j id="23-2r-\'+6d+\'" 1G="I-23-2r" 1f-3H="I">\'+q.G.6o+\'</1j>\')[0]},k0:C(14,Q,1m){E 14=14.7S();52{14.43(1m);14.3L(Q)}51(e){}},kp:C(){$(1l).1h(\'1j.I-23-2r\').1u();q.$T.1h(\'1j.I-23-2r\').1u()},nQ:C(2b,2h){q.1V.eh(2b,2h)},5Z:C(Y){q.J.1b();if(q.14.53)F O;E 4M=1l.3w(Y);4M.81(q.14.nT());q.14.3L(4M);F 4M},9g:C(Q){if(q.L.1P(\'4b\')){Q=Q[0]||Q;E 14=1l.92();14.9j(Q)}N{q.1V.1U(Q,0,Q,1)}},bd:C(){q.J.1b();q.14.9j(q.$T[0]);q.J.4l()},1u:C(){q.J.1b();q.2T.8T()},3o:C(){q.J.g2()},g2:C(){q.J.1b();E 5M=q.J.6Q(1);q.J.ed(q.14,5M,1q);if(q.14.53===O){E 9C=q.J.6Q(2);q.J.ed(q.14,9C,O)}q.eT=q.$T.B()},6Q:C(6d){if(1s 6d==\'1y\')6d=1;F $(\'<1j id="J-2r-\'+6d+\'" 1G="I-J-2r"  1f-3H="I">\'+q.G.6o+\'</1j>\')[0]},5a:C(6d){F q.L.6q(q.J.6Q(6d))},ed:C(14,Q,1m){14=14.7S();52{14.43(1m);14.3L(Q)}51(e){q.2n.2W()}},3d:C(){E 5M=q.$T.1h(\'1j#J-2r-1\');E 9C=q.$T.1h(\'1j#J-2r-2\');if(q.L.1P(\'4b\')){q.$T.2n()}if(5M.12!==0&&9C.12!==0){q.1V.1U(5M,0,9C,0)}N if(5M.12!==0){q.1V.1U(5M,0,5M,0)}N{q.$T.2n()}q.J.8p();q.eT=O},8p:C(){q.$T.1h(\'1j.I-J-2r\').1B(C(i,s){E 1g=$(s).1g().K(/\\6g/g,\'\');if(1g===\'\')$(s).1u();N $(s).2t(C(){F $(q).26()})})},e1:C(){q.J.1b();F q.2T.4y()},q5:C(){E B=\'\';q.J.1b();if(q.2T.7A){E dY=1l.3w(\'1i\');E 2p=q.2T.7A;2B(E i=0;i<2p;++i){dY.81(q.2T.6l(i).qN())}B=dY.3x}F q.1x.9R(B)},go:C(B){q.J.1b();q.14.55();E 1i=1l.3w("1i");1i.3x=B;E 4L=1l.9M(),4w;56((4w=1i.9N)){4L.81(4w)}q.14.3L(4L)},qE:C(B){B=q.J.5a(1)+B+q.J.5a(2);q.J.1b();if(3l.4D&&3l.4D().6l){q.J.go(B)}N if(1l.J&&1l.J.92){q.14.gw(B)}q.J.3d();q.1e.1S()}}},6m:C(){F{3Q:C(e,1k){if(!q.G.6m){if((e.9u||e.6J)&&(1k===66||1k===73))e.2w();F O}$.1B(q.G.6m,$.1d(C(5f,4A){E 4X=5f.4o(\',\');E 2p=4X.12;2B(E i=0;i<2p;i++){if(1s 4X[i]===\'6Z\'){q.6m.7N(e,$.3k(4X[i]),$.1d(C(){E 1C;if(4A.1C.3N(/\\./)!=\'-1\'){1C=4A.1C.4o(\'.\');if(1s q[1C[0]]!=\'1y\'){q[1C[0]][1C[1]].9E(q,4A.6p)}}N{q[4A.1C].9E(q,4A.6p)}},q))}}},q))},7N:C(e,4X,fq){E g5={8:"pS",9:"5I",10:"F",13:"F",16:"6E",17:"48",18:"80",19:"pB",20:"pA",27:"py",32:"3g",33:"pE",34:"pF",35:"2h",36:"lb",37:"2c",38:"ls",39:"4s",40:"l8",45:"1Y",46:"4h",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",88:"4",mN:"5",mS:"6",mT:"7",ln:"8",le:"9",mP:"*",lY:"+",me:"-",md:".",m4:"/",lV:"f1",mJ:"f2",q1:"f3",mD:"f4",pN:"f5",pa:"f6",p9:"f7",p3:"f8",ps:"f9",pk:"pZ",qD:"qF",qA:"qu",qw:"qx",qz:"6b",qS:"-",qR:";",qJ:"=",q9:",",q8:"-",qo:".",ql:"/",qh:"`",e5:"[",nG:"\\\\",ek:"]",nF:"\'"};E e9={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"nM","=":"+",";":": ","\'":"\\"",",":"<",".":">","/":"?","\\\\":"|"};4X=4X.3e().4o(" ");E bu=g5[e.3j],9h=6f.nW(e.7U).3e(),86="",7j={};$.1B(["80","48","5h","6E"],C(68,bz){if(e[bz+\'nX\']&&bu!==bz){86+=bz+\'+\'}});if(bu)7j[86+bu]=1q;if(9h){7j[86+9h]=1q;7j[86+e9[9h]]=1q;if(86==="6E+"){7j[e9[9h]]=1q}}2B(E i=0,2p=4X.12;i<2p;i++){if(7j[4X[i]]){e.2w();F fq.9E(q,fA)}}}}},2H:C(){F{1b:C(1e){if(!q.G.2H)F 1e;E dZ=[\'fx\',\'31\',\'e0\',\'hr\',\'i?n9\',\'V\',\'5h\',\'n5\',\'1o\',\'3V\',\'3W\',\'ee\',\'e7\',\'e3\'];E e2=[\'li\',\'dt\',\'dt\',\'h[1-6]\',\'42\',\'3V\'];E 8H=[\'p\',\'29\',\'1i\',\'dl\',\'iT\',\'64\',\'oV\',\'iA\',\'ol\',\'2F\',\'7z\',\'2Y\',\'5P\',\'6O\',\'3p\'];q.2H.jE=2a 2l(\'^<(/?\'+dZ.3c(\'|/?\')+\'|\'+e2.3c(\'|\')+\')[ >]\');q.2H.j8=2a 2l(\'^<(br|/?\'+dZ.3c(\'|/?\')+\'|/\'+e2.3c(\'|/\')+\')[ >]\');q.2H.8H=2a 2l(\'^</?(\'+8H.3c(\'|\')+\')[ >]\');E i=0,bl=1e.12,3S=0,2b=4e,2h=4e,Y=\'\',2m=\'\',5b=\'\';q.2H.8L=0;2B(;i<bl;i++){3S=i;if(-1==1e.4x(i).4Q(\'<\')){2m+=1e.4x(i);F q.2H.eg(2m)}56(3S<bl&&1e.6a(3S)!=\'<\'){3S++}if(i!=3S){5b=1e.4x(i,3S-i);if(!5b.1T(/^\\s{2,}$/g)){if(\'\\n\'==2m.6a(2m.12-1))2m+=q.2H.7r();N if(\'\\n\'==5b.6a(0)){2m+=\'\\n\'+q.2H.7r();5b=5b.K(/^\\s+/,\'\')}2m+=5b}if(5b.1T(/\\n/))2m+=\'\\n\'+q.2H.7r()}2b=3S;56(3S<bl&&\'>\'!=1e.6a(3S)){3S++}Y=1e.4x(2b,3S-2b);i=3S;E t;if(\'!--\'==Y.4x(1,3)){if(!Y.1T(/--$/)){56(\'-->\'!=1e.4x(3S,3)){3S++}3S+=2;Y=1e.4x(2b,3S-2b);i=3S}if(\'\\n\'!=2m.6a(2m.12-1))2m+=\'\\n\';2m+=q.2H.7r();2m+=Y+\'>\\n\'}N if(\'!\'==Y[1]){2m=q.2H.bD(Y+\'>\',2m)}N if(\'?\'==Y[1]){2m+=Y+\'>\\n\'}N if(t=Y.1T(/^<(3V|1o|2F)/i)){t[1]=t[1].3e();Y=q.2H.ec(Y);2m=q.2H.bD(Y,2m);2h=6f(1e.4x(i+1)).3e().4Q(\'</\'+t[1]);if(2h){5b=1e.4x(i+1,2h);i+=2h;2m+=5b}}N{Y=q.2H.ec(Y);2m=q.2H.bD(Y,2m)}}F q.2H.eg(2m)},7r:C(){E s=\'\';2B(E j=0;j<q.2H.8L;j++){s+=\'\\t\'}F s},eg:C(1e){1e=1e.K(/\\n\\s*\\n/g,\'\\n\');1e=1e.K(/^[\\s\\n]*/,\'\');1e=1e.K(/[\\s\\n]*$/,\'\');1e=1e.K(/<3V(.*?)>\\n<\\/3V>/gi,\'<3V$1></3V>\');q.2H.8L=0;F 1e},ec:C(Y){E 8E=\'\';Y=Y.K(/\\n/g,\' \');Y=Y.K(/\\s{2,}/g,\' \');Y=Y.K(/^\\s+|\\s+$/g,\' \');E ea=\'\';if(Y.1T(/\\/$/)){ea=\'/\';Y=Y.K(/\\/+$/,\'\')}E m;56(m=/\\s*([^= ]+)(?:=(([\'"\']).*?\\3|[^ ]+))?/.5j(Y)){if(m[2])8E+=m[1].3e()+\'=\'+m[2];N if(m[1])8E+=m[1].3e();8E+=\' \';Y=Y.4x(m[0].12)}F 8E.K(/\\s*$/,\'\')+ea+\'>\'},bD:C(Y,2m){E nl=Y.1T(q.2H.8H);if(Y.1T(q.2H.jE)||nl){2m=2m.K(/\\s*$/,\'\');2m+=\'\\n\'}if(nl&&\'/\'==Y.6a(1))q.2H.8L--;if(\'\\n\'==2m.6a(2m.12-1))2m+=q.2H.7r();if(nl&&\'/\'!=Y.6a(1))q.2H.8L++;2m+=Y;if(Y.1T(q.2H.j8)||Y.1T(q.2H.8H)){2m=2m.K(/ *$/,\'\')}F 2m}}},1I:C(){F{ja:C(){if(q.G.4z)q.G.4c=O;if(q.G.4T)q.G.1K=O;if(q.G.1M)F;E 2d=[\'p\',\'49\'];if(q.G.4z)q.1I.jd(2d);if(q.G.4c)q.1I.jg(2d)},jd:C(2d){E 2p=2d.12;2B(E i=0;i<2p;i++){if($.3t(2d[i],q.G.4z)==-1){q.G.4z.2N(2d[i])}}},jg:C(2d){E 2p=2d.12;2B(E i=0;i<2p;i++){E 3s=$.3t(2d[i],q.G.4c);if(3s!=-1){q.G.4c.bi(3s,1)}}},2R:C(B,44){q.1I.2D={4c:q.G.4c,4z:q.G.4z,6G:q.G.6G,5B:q.G.5B,5A:q.G.5A,5y:q.G.5y,1K:q.G.1K,4T:q.G.4T,6L:q.G.6L,4f:q.G.4f};$.7E(q.1I.2D,44);B=q.1I.6G(B);q.1I.$1i=$(\'<1i />\').1F(B);q.1I.5B();q.1I.5A();q.1I.ji();q.1I.1K();q.1I.4f();q.1I.j5();q.1I.5y();q.1I.6L();B=q.1I.$1i.B();q.1I.$1i.1u();F B},6G:C(B){if(!q.1I.2D.6G)F B;F B.K(/<!--[\\s\\S]*?-->/gi,\'\')},5B:C(B){if(!q.1I.2D.5B)F B;E 2p=q.1I.2D.5B.12;E 5F=[],dB=[];2B(E i=0;i<2p;i++){dB.2N(q.1I.2D.5B[i][1]);5F.2N(q.1I.2D.5B[i][0])}$.1B(5F,$.1d(C(1k,1E){q.1I.$1i.1h(1E).2t(C(){F $("<"+dB[1k]+" />",{B:$(q).B()})})},q))},5A:C(){if(!q.1I.2D.5A)F;E 2p=q.1I.2D.5A.12;q.1I.$1i.1h(\'1j\').1B($.1d(C(n,s){E $el=$(s);E 1o=$el.1c(\'1o\');2B(E i=0;i<2p;i++){if(1o&&1o.1T(2a 2l(\'^\'+q.1I.2D.5A[i][0],\'i\'))){E 1p=q.1I.2D.5A[i][1];$el.2t(C(){E Y=1l.3w(1p);F $(Y).1F($(q).26())})}}},q))},ji:C(){if(!q.1I.2D.4c&&q.1I.2D.4z){q.1I.$1i.1h(\'*\').6h(q.1I.2D.4z.3c(\',\')).1B(C(i,s){if(s.3x===\'\')$(s).1u();N $(s).26().3Y()})}if(q.1I.2D.4c){q.1I.$1i.1h(q.1I.2D.4c.3c(\',\')).1B(C(i,s){if($(s).3i(\'I-3V-Y\')||$(s).3i(\'I-J-2r\'))F;if(s.3x===\'\')$(s).1u();N $(s).26().3Y()})}},1K:C(){E 2p;if(!q.1I.2D.1K&&q.1I.2D.4T){E ce=[],cd=[];2p=q.1I.2D.4T.12;2B(E i=0;i<2p;i++){ce.2N(q.1I.2D.4T[i][0]);cd.2N(q.1I.2D.4T[i][1])}q.1I.$1i.1h(\'*\').1B($.1d(C(n,s){E $el=$(s);E 3s=$.3t($el[0].1p.3e(),ce);E 5D=q.1I.jn(3s,cd,$el);if(5D){$.1B(5D,C(z,f){$el.1K(f)})}},q))}if(q.1I.2D.1K){2p=q.1I.2D.1K.12;2B(E i=0;i<2p;i++){E 8j=q.1I.2D.1K[i][1];if($.bc(8j))8j=8j.3c(\' \');q.1I.$1i.1h(q.1I.2D.1K[i][0]).1K(8j)}}},jn:C(3s,5J,$el){E 5D=[];if(3s==-1){$.1B($el[0].4u,C(i,2x){5D.2N(2x.1w)})}N if(5J[3s]==\'*\'){5D=[]}N{$.1B($el[0].4u,C(i,2x){if($.bc(5J[3s])){if($.3t(2x.1w,5J[3s])==-1){5D.2N(2x.1w)}}N if(5J[3s]!=2x.1w){5D.2N(2x.1w)}})}F 5D},j3:C(el,bv){bv=2a 2l(bv,"g");F el.1B(C(){E 3u=$(q);E 2p=q.4u.12-1;2B(E i=2p;i>=0;i--){E 2x=q.4u[i];if(2x&&2x.oj&&2x.1w.3N(bv)>=0){3u.1K(2x.1w)}}})},4f:C(){if(!q.1I.2D.4f)F;q.1I.$1i.1h(q.1I.2D.4f.3c(\',\')).1B(C(){E $el=$(q);E 1g=$el.1g();1g=1g.K(/\\6g/g,\'\');1g=1g.K(/&5s;/gi,\'\');1g=1g.K(/\\s/g,\'\');if(1g===\'\'&&$el.3O().12===0){$el.1u()}})},j5:C(){q.1I.$1i.1h(\'li p\').26().3Y()},5y:C(){if(!q.1I.2D.5y)F;E 2d=q.1I.2D.5y;if($.bc(q.1I.2D.5y))2d=q.1I.2D.5y.3c(\',\');q.1I.j3(q.1I.$1i.1h(2d),\'^(1f-)\')},6L:C(){if(!q.1I.2D.6L)F;q.1I.$1i.1h(q.1I.2D.6L.3c(\',\')).1B(C(){if(q.4u.12===0){$(q).26().3Y()}})}}},1A:C(){F{3Q:C(){F{B:{1J:q.1H.1b(\'B\'),1C:\'1e.3m\'},3a:{1J:q.1H.1b(\'3a\'),1n:{p:{1J:q.1H.1b(\'j2\'),1C:\'R.30\'},29:{1J:q.1H.1b(\'ci\'),1C:\'R.30\'},2F:{1J:q.1H.1b(\'1e\'),1C:\'R.30\'},h1:{1J:q.1H.1b(\'jb\'),1C:\'R.30\'},h2:{1J:q.1H.1b(\'jH\'),1C:\'R.30\'},h3:{1J:q.1H.1b(\'jI\'),1C:\'R.30\'},h4:{1J:q.1H.1b(\'jM\'),1C:\'R.30\'},h5:{1J:q.1H.1b(\'jD\'),1C:\'R.30\'}}},4n:{1J:q.1H.1b(\'4n\'),1C:\'28.30\'},4m:{1J:q.1H.1b(\'4m\'),1C:\'28.30\'},5Y:{1J:q.1H.1b(\'5Y\'),1C:\'28.30\'},5x:{1J:q.1H.1b(\'5x\'),1C:\'28.30\'},5m:{1J:\'&o6; \'+q.1H.1b(\'5m\'),1C:\'2e.3m\'},5z:{1J:\'1. \'+q.1H.1b(\'5z\'),1C:\'2e.3m\'},7p:{1J:\'< \'+q.1H.1b(\'7p\'),1C:\'3y.95\'},3y:{1J:\'> \'+q.1H.1b(\'3y\'),1C:\'3y.bo\'},M:{1J:q.1H.1b(\'M\'),1C:\'M.2O\'},22:{1J:q.1H.1b(\'22\'),1C:\'22.2O\'},V:{1J:q.1H.1b(\'V\'),1n:{V:{1J:q.1H.1b(\'ba\'),1C:\'V.2O\',1R:{2j:\'a\',in:{1J:q.1H.1b(\'ca\'),},2m:{1J:q.1H.1b(\'ba\')}}},6P:{1J:q.1H.1b(\'6P\'),1C:\'V.6P\',1R:{2j:\'a\',2m:{1c:{\'1G\':\'I-1n-V-c9\',\'4K-7o\':1q}}}}}},3b:{1J:q.1H.1b(\'3b\'),1n:{2c:{1J:q.1H.1b(\'jt\'),1C:\'3b.2c\'},5u:{1J:q.1H.1b(\'jx\'),1C:\'3b.5u\'},4s:{1J:q.1H.1b(\'jB\'),1C:\'3b.4s\'},9d:{1J:q.1H.1b(\'jA\'),1C:\'3b.9d\'}}},b3:{1J:q.1H.1b(\'b3\'),1C:\'3K.1Y\'}}},2o:C(){q.1A.iV();q.1A.iN();q.1A.iU();if(q.G.4i.12===0)F;q.$1A=q.1A.ir();q.1A.iQ();q.1A.1F();q.1A.i5();q.1A.ia();q.1A.iz();if(q.G.b5){q.$T.on(\'iZ.I 2s.I 2n.I\',$.1d(q.1R.1A,q))}},ir:C(){F $(\'<3p>\').2f(\'I-1A\').1c({\'id\':\'I-1A-\'+q.2G,\'9c\':\'1A\'})},i5:C(){$.1B(q.G.1A.3a.1n,$.1d(C(i,s){if($.3t(i,q.G.3a)==-1)83 q.G.1A.3a.1n[i]},q))},ia:C(){$.1B(q.G.4i,$.1d(C(i,2g){if(!q.G.1A[2g])F;if(2g===\'22\'){if(q.G.76===O)F;N if(!q.G.76&&q.G.7V===O)F}if(2g===\'M\'){if(q.G.75===O)F;N if(!q.G.75&&q.G.7V===O)F}E 2X=q.G.1A[2g];q.$1A.1F($(\'<li>\').1F(q.1t.2o(2g,2X)))},q))},1F:C(){if(q.G.bf){q.$1A.2f(\'I-1A-oT\');$(q.G.bf).B(q.$1A)}N{q.$2Q.6t(q.$1A)}},iz:C(){if(!q.L.7b())F;if(q.G.bf)F;if(!q.G.iS)F;q.1A.cp();$(q.G.6y).on(\'6b.I.\'+q.2G,$.1d(q.1A.cp,q))},iQ:C(){if(q.L.6M()&&q.G.iO){q.$1A.2f(\'I-1A-bI\')}},iU:C(){if(q.G.4E)F;E 68=q.G.4i.4Q(\'B\');if(68!==-1){q.G.4i.bi(68,1)}},iV:C(){if(q.G.cw.12===0)F;$.1B(q.G.cw,$.1d(C(i,s){E 68=q.G.4i.4Q(s);q.G.4i.bi(68,1)},q))},iN:C(){if(!q.L.6M()||q.G.cv.12===0)F;$.1B(q.G.cv,$.1d(C(i,s){E 68=q.G.4i.4Q(s);q.G.4i.bi(68,1)},q))},cp:C(){E 3U=$(q.G.6y).3U();E 6C=1;if(q.G.6y===1l){6C=q.$2Q.2I().2U}if((3U+q.G.6z)>6C){q.1A.iD(3U,6C)}N{q.1A.iC()}},iD:C(3U,6C){E 2U=q.G.6z+3U-6C;E 2c=0;E 2h=6C+q.$2Q.3n()-32;E 2J=q.$2Q.7P();q.$1A.2f(\'1A-82-2Q\');q.$1A.1O({4g:\'8u\',2J:2J,2U:2U+\'px\',2c:2c});if(3U>2h)$(\'.I-1n-\'+q.2G+\':c2\').3v();q.1A.iJ();q.$1A.1O(\'iH\',(3U<2h)?\'c2\':\'k4\')},iC:C(){q.$1A.1O({4g:\'oC\',2J:\'bj\',2U:0,2c:0,iH:\'c2\'});q.1A.jO();q.$1A.2S(\'1A-82-2Q\')},iJ:C(){E 2U=q.$1A.6c()+q.G.6z;E 4g=\'82\';if(q.G.6y!==1l){2U=(q.$1A.6c()+q.$1A.2I().2U)+q.G.6z;4g=\'8u\'}$(\'.I-1n-\'+q.2G).1B(C(){$(q).1O({4g:4g,2U:2U+\'px\'})})},jO:C(){E 2U=(q.$1A.6c()+q.$1A.2I().2U);$(\'.I-1n-\'+q.2G).1B(C(){$(q).1O({4g:\'8u\',2U:2U+\'px\'})})}}},1v:C(){F{3Q:C(id,2i,2A){q.1v.4Y=O;q.1v.2A=2A;q.1v.2i=2i;q.1v.$el=$(id);q.1v.$4d=$(\'<1i id="I-4d" />\');q.1v.$cE=$(\'<1i id="I-4d-3f" />\').1g(q.1H.1b(\'kD\'));q.1v.$3D=$(\'<3D 1m="22" 1w="22" />\');q.1v.$cE.1F(q.1v.$3D);q.1v.$4d.1F(q.1v.$cE);q.1v.$el.1F(q.1v.$4d);q.1v.$4d.3h(\'I.1v\');q.1v.$3D.3h(\'I.1v\');q.1v.$4d.on(\'oL.I.1v\',$.1d(q.1v.bn,q));q.1v.$4d.on(\'oK.I.1v\',$.1d(q.1v.k6,q));q.1v.$3D.on(\'kR.I.1v\',$.1d(C(e){e=e.7T||e;q.1v.b9(q.1v.$3D[0].5R[0],e)},q));q.1v.$4d.on(\'57.I.1v\',$.1d(C(e){e.2w();q.1v.$4d.2S(\'7k-c0\').2f(\'7k-57\');q.1v.bs(e)},q))},kQ:C(22,e){q.1v.4Y=1q;q.1v.b9(22,e)},bs:C(e){e=e.7T||e;E 5R=e.bG.5R;q.1v.b9(5R[0],e)},b9:C(22,e){if(q.G.7V){q.1v.bL(22);q.1v.kr(22);F}E 4q=!!3l.b6?2a b6():4e;if(3l.b6){q.1v.bL(22);E 1w=(q.1v.1m==\'M\')?q.G.k1:q.G.k2;4q.1F(1w,22)}q.5E.2O();q.1X.2u(\'o1\',e,4q);q.1v.ky(4q,e)},bL:C(22){q.1v.k8(22);if(q.1v.4Y){q.1v.2i=(q.1v.1m==\'M\')?q.G.75:q.G.76;q.1v.2A=(q.1v.1m==\'M\')?q.M.1Y:q.22.1Y}},k8:C(22){q.1v.1m=\'M\';if(q.G.kb.4Q(22.1m)==-1){q.1v.1m=\'22\'}},6V:C(7H,fd){if(7H===O||1s 7H!==\'41\')F fd;$.1B(7H,$.1d(C(k,v){if(v!==4e&&v.4y().4Q(\'#\')===0)v=$(v).2K();fd.1F(k,v)},q));F fd},ky:C(4q,e){if(q.1v.1m==\'M\'){4q=q.1v.6V(q.G.nq,4q);4q=q.1v.6V(q.1v.b7,4q)}N{4q=q.1v.6V(q.G.nr,4q);4q=q.1v.6V(q.1v.bC,4q)}E 2M=2a bq();2M.bw(\'ns\',q.1v.2i);2M.cF("X-n7-n8","bq");2M.fu=$.1d(C(){if(2M.bS==4){E 1f=2M.fr;1f=1f.K(/^\\[/,\'\');1f=1f.K(/\\]$/,\'\');E 2P;52{2P=(1s 1f===\'6Z\'?$.jY(1f):1f)}51(n6){2P={6U:1q}}q.5E.3v();if(!q.1v.4Y){q.1v.$4d.2S(\'7k-57\')}q.1v.2A(2P,q.1v.4Y,e)}},q);2M.dk(4q)},bn:C(e){e.2w();q.1v.$4d.2f(\'7k-c0\')},k6:C(e){e.2w();q.1v.$4d.2S(\'7k-c0\')},nf:C(){q.1v.b7={}},ne:C(1w,1E){q.1v.b7[1w]=1E},nd:C(1w){83 q.1v.b7[1w]},nc:C(){q.1v.bC={}},nw:C(1w,1E){q.1v.bC[1w]=1E},nx:C(1w){83 q.1v.bC[1w]},kr:C(22){q.1v.fz(22,$.1d(C(kw){q.1v.g4(22,kw)},q))},fz:C(22,2A){E 2M=2a bq();E 6A=\'?\';if(q.G.7V.3N(/\\?/)!=\'-1\')6A=\'&\';2M.bw(\'nR\',q.G.7V+6A+\'1w=\'+22.1w+\'&1m=\'+22.1m,1q);if(2M.fy)2M.fy(\'1g/nS; nP=x-nN-nO\');E fi=q;2M.fu=C(e){if(q.bS==4&&q.dv==bt){fi.5E.2O();2A(fl(q.fr))}N if(q.bS==4&&q.dv!=bt){}};2M.dk()},g3:C(bx,2i){E 2M=2a bq();if("nY"in 2M){2M.bw(bx,2i,1q)}N if(1s fX!="1y"){2M=2a fX();2M.bw(bx,2i)}N{2M=4e}F 2M},g4:C(22,2i){E 2M=q.1v.g3(\'nL\',2i);if(!2M){}N{2M.nD=$.1d(C(){if(2M.dv==bt){q.5E.3v();E bA=2i.4o(\'?\');if(!bA[0]){F O}if(!q.1v.4Y){q.1v.$4d.2S(\'7k-57\')}E 2P={9b:bA[0]};if(q.1v.1m==\'22\'){E 2C=bA[0].4o(\'/\');2P.6k=2C[2C.12-1]}q.1v.2A(2P,q.1v.4Y,O)}N{}},q);2M.nK=C(){};2M.1v.nJ=C(e){};2M.cF(\'p0-p1\',22.1m);2M.cF(\'x-qg-qm\',\'qq-qp\');2M.dk(22)}}}},L:C(){F{6M:C(){F/(eQ|eH|eO|ht)/.bE(b8.bb)},7b:C(){F!/(eQ|eH|q3|eO|ht)/.bE(b8.bb)},q0:C(7H){F g8.5w.4y.6e(7H)==\'[41 6f]\'},3z:C(B,he){B=B.K(/[\\6g-\\q7\\qb]/g,\'\');B=B.K(/&5s;/gi,\'\');B=B.K(/<\\/?br\\s?\\/?>/g,\'\');B=B.K(/\\s/g,\'\');B=B.K(/^<p>[^\\W\\w\\D\\d]*?<\\/p>$/i,\'\');B=B.K(/<4R(.*?[^>])>$/i,\'4R\');B=B.K(/<4E(.*?[^>])>$/i,\'4E\');if(he!==O){B=B.K(/<[^\\/>][^>]*><\\/[^>]+>/gi,\'\');B=B.K(/<[^\\/>][^>]*><\\/[^>]+>/gi,\'\')}B=$.3k(B);F B===\'\'},dr:C(5f){if(1s(5f)===\'1y\')F 0;F 5L(5f.K(\'px\',\'\'),10)},n2:C(6H){if(1s 6H==\'1y\')F;if(6H.3N(/^#/)==-1)F 6H;E hm=/^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;6H=6H.K(hm,C(m,r,g,b){F r+r+g+g+b+b});E bg=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.5j(6H);F\'qQ(\'+5L(bg[1],16)+\', \'+5L(bg[2],16)+\', \'+5L(bg[3],16)+\')\'},6q:C(el){F $(\'<1i>\').1F($(el).eq(0).8O()).B()},bh:C(el){if($.3t(el.1p,q.G.8F)!==-1){F $(el)}N{F $(el).2q(q.G.8F.4y().3e(),q.$T[0])}},5r:C(el,1c){E $el=$(el);if(1s $el.1c(1c)==\'1y\'){F 1q}if($el.1c(1c)===\'\'){$el.1K(1c);F 1q}F O},4f:C(i,s){E $s=$($.dQ(s));$s.1h(\'.I-7s-3g\').1K(\'1o\').1K(\'1G\');if($s.1h(\'hr, br, 1L, 4R, 4E\').12!==0)F;E 1g=$.3k($s.1g());if(q.L.3z(1g,O)){$s.1u()}},8z:C(){q.gs=q.$T.3U();q.bm=$(3l).3U();if(q.G.9p)q.gq=$(q.G.9p).3U()},bk:C(){if(1s q.8z===\'1y\'&&1s q.bm===\'1y\')F;$(3l).3U(q.bm);q.$T.3U(q.gs);if(q.G.9p)$(q.G.9p).3U(q.gq)},bH:C(){E 3g=1l.3w(\'1j\');3g.3E=\'I-7s-3g\';3g.3x=q.G.6o;F 3g},4Z:C(Q){E 2d=q.G.4N;2d.2N(\'1j\');if(Q.1p==\'8o\')2d.2N(\'a\');$(Q).1h(2d.3c(\',\')).6h(\'1j.I-J-2r\').26().3Y()},6i:C(Q,4Z){E 3u=q;$(Q).2t(C(){if(4Z===1q)3u.L.4Z(q);F $(q).26()});F $(Q)},4I:C(Q,Y,4Z){E 5F;E 3u=q;$(Q).2t(C(){5F=$(\'<\'+Y+\' />\').1F($(q).26());2B(E i=0;i<q.4u.12;i++){5F.1c(q.4u[i].1w,q.4u[i].1E)}if(4Z===1q)3u.L.4Z(5F);F 5F});F 5F},gp:C(){E R=q.J.4a();if(!R)F O;E 2I=q.1V.b4(R);F(2I===0)?1q:O},6T:C(2j){if(1s 2j==\'1y\'){E 2j=q.J.4a();if(!2j)F O}E 2I=q.1V.b4(2j);E 1g=$.3k($(2j).1g()).K(/\\n\\r\\n/g,\'\');F(2I==1g.12)?1q:O},dN:C(){E R=q.$T[0];E 2I=q.1V.b4(R);E 1g=$.3k($(R).B().K(/(<([^>]+)>)/gi,\'\'));F(2I==1g.12)?1q:O},6X:C(R){R=R[0]||R;F R&&q.L.7J(R.1p)},7J:C(Y){if(1s Y==\'1y\')F O;F q.gm.bE(Y)},bB:C(1z,Y){E 2j=$(1z).2q(Y,q.$T[0]);if(2j.12==1){F 2j[0]}F O},9w:C(){F q.bd},gW:C(){q.bd=1q},8U:C(){q.bd=O},4p:C(el){if(!el){F O}if($(el).dL(\'.I-T\').12===0||$(el).3i(\'I-T\')){F O}F el},h8:C(){F q.L.4S([\'dK\',\'di\',\'cS\',\'cR\',\'cI\',\'cH\'])},4S:C(1p){E 1r=q.J.67();E 1z=q.J.3B();if($.bc(1p)){E cJ=0;$.1B(1p,$.1d(C(i,s){if(q.L.cM(1z,1r,s)){cJ++}},q));F(cJ===0)?O:1q}N{F q.L.cM(1z,1r,1p)}},cM:C(1z,1r,1p){1p=1p.lF();F 1r&&1r.1p===1p?1r:1z&&1z.1p===1p?1z:O},lG:C(){F(q.L.1P(\'2E\')&&5L(q.L.1P(\'bp\'),10)<9)?1q:O},lJ:C(){F(q.L.1P(\'2E\')&&5L(q.L.1P(\'bp\'),10)<10)?1q:O},gj:C(){F!!b8.bb.1T(/lB\\/7\\./)},1P:C(1P){E 4U=b8.bb.3e();E 1T=/(de)[\\/]([\\w.]+)/.5j(4U)||/(hw)[ \\/]([\\w.]+)/.5j(4U)||/(7q)[ \\/]([\\w.]+).*(db)[ \\/]([\\w.]+)/.5j(4U)||/(7q)[ \\/]([\\w.]+)/.5j(4U)||/(kX)(?:.*bp|)[ \\/]([\\w.]+)/.5j(4U)||/(2E) ([\\w.]+)/.5j(4U)||4U.4Q("l3")>=0&&/(dc)(?::| )([\\w.]+)/.5j(4U)||4U.4Q("kZ")<0&&/(4b)(?:.*? dc:([\\w.]+)|)/.5j(4U)||[];if(1P==\'db\')F(1s 1T[3]!=\'1y\')?1T[3]==\'db\':O;if(1P==\'bp\')F 1T[2];if(1P==\'7q\')F(1T[1]==\'hw\'||1T[1]==\'de\'||1T[1]==\'7q\');if(1T[1]==\'dc\')F 1P==\'2E\';if(1T[1]==\'de\')F 1P==\'7q\';F 1P==1T[1]},bF:C(ev,es,2I){E i=ev.4Q(es,2I);F i>=0?i:O},d8:C(){E $31=$(\'B\');E 7u=3l.7P;if(!7u){E cZ=1l.lk.lp();7u=cZ.4s-8d.mO(cZ.2c)}E kP=1l.31.kC<7u;E by=q.L.kv();$31.1O(\'bI\',\'k4\');if(kP)$31.1O(\'hh-4s\',by)},kv:C(){E $31=$(\'31\');E 7G=1l.3w(\'1i\');7G.3E=\'I-hf-j0\';$31.1F(7G);E by=7G.m8-7G.kC;$31[0].m6(7G);F by},bJ:C(){$(\'B\').1O({\'bI\':\'\',\'hh-4s\':\'\'});$(\'31\').1u(\'I-hf-j0\')}}}};$(3l).on(\'2R.eN.I\',C(){$(\'[1f-eN="I"]\').I()});47.5w.3Q.5w=47.5w})(o7);',62,1669,'||||||||||||||||||||||||||this|||||||||||html|function||var|return|opts||redactor|selection|replace|utils|image|else|false||node|block||editor||link|||tag||||length||range||||||modal|get|attr|proxy|code|data|text|find|div|span|key|document|type|dropdown|style|tagName|true|parent|typeof|button|remove|upload|name|clean|undefined|current|toolbar|each|func|keydown|value|append|class|lang|tidy|title|removeAttr|img|linebreaks|next|css|browser|target|observe|sync|match|set|caret|formatted|core|insert|blocks||btn|file|nodes||buffer|contents||inline|blockquote|new|start|left|tags|list|addClass|btnName|end|url|element|href|RegExp|out|focus|build|len|closest|marker|keyup|replaceWith|setCallback|textarea|preventDefault|item|click|linkify|callback|for|arr|settings|msie|pre|uuid|tabifier|offset|width|val|label|xhr|push|show|json|box|load|removeClass|sel|top|paragraphize|setStart|btnObject|td|last|format|body|||||||||formatting|alignment|join|restore|toLowerCase|placeholder|space|off|hasClass|keyCode|trim|window|toggle|height|save|ul|tooltip|autosave|pos|inArray|self|hide|createElement|innerHTML|indent|isEmpty|setTimeout|getCurrent|CodeMirror|input|className|after|imageBox|verified|first|re|line|insertNode|matches|search|children|setEnd|init|font|point|rel|scrollTop|script|table|getBlocks|unwrap|execCommand||object|option|collapse|options|||Redactor|ctrl|section|getBlock|mozilla|deniedTags|droparea|null|removeEmpty|position|del|buttons|close|resizeHandle|addRange|italic|bold|split|isRedactorParent|formData|clearUnverified|right|src|attributes|regexps|child|substr|toString|allowedTags|command|margin|blockElem|getSelection|source|modalBox|prev|cmd|replaceToTag|resize|aria|frag|wrapper|inlineTags|htmls|orgn|indexOf|iframe|isCurrentOrParent|allowedAttr|ua|elem|arrow|keys|direct|removeInlineTags||catch|try|collapsed|setAfter|deleteContents|while|drop|BR||getMarkerAsHtml|cont|linkProtocol|contenteditable|pasteBox|str|align|meta|strong|exec|isFunction|editter|unorderedlist|links|https|none|tmp|removeEmptyAttr|nbsp|br1|center|LI|prototype|underline|removeDataAttr|orderedlist|replaceStyles|replaceTags|paste|attributesRemove|progress|replacement|toggleType|touchstart|tab|allowed|lastNode|parseInt|node1|quot|nodeValue|th|replaceDivs|files|emptyHtml|lastList|inlines|currentList|currentLevel|methods|deleted|wrap|||templateName|marginTop|form|||getParent|index|containerTag|charAt|scroll|innerHeight|num|call|String|u200B|not|replaceWithContents|prop|filename|getRangeAt|shortcuts|break|invisibleSpace|params|getOuterHtml|visual|shiftKey|prepend|instance|preSpaces|SPAN|insertBreakLine|toolbarFixedTarget|toolbarFixedTopOffset|mark|Insert|boxTop|module|shift|TD|removeComments|hex|getNodes|metaKey|figure|removeWithoutAttr|isMobile|display|tr|unlink|getMarker|mousedown|tabindex|isEndOfElement|error|getHiddenFields|editorDiv|isBlock|video|string|ENTER|vimeo|youtube||modalOverlay|imageUpload|fileUpload|focn|startNode|dropdowns|decoration|isDesktop|strike|posFromIndex|endRange|float|getEvent|level|embed|possible|drag|sub|parHtml|www|disabled|outdent|webkit|getTabs|invisible|z0|windowWidth|outerHTML|blocksSize|keyPosition|dropact|select|rangeCount|rtePaste|hideAll|pattern|extend|boundaryRange|scrollDiv|obj|weight|isBlockTag|_blank|edit|action|handler|toggleClass|innerWidth|sup|setVerified|cloneRange|originalEvent|which|s3|hideResize|listParent|figcaption|blank|alt|appendChild|fixed|delete|BACKSPACE|tmpList|modif|header|100|DIV|imageResizer|tagblock|tmpLi|Math|event|resizer|setClass|blurClickedElement|setMode|attrs|items|returnValue|inserted|codemirror|PRE|removeMarkers|blockLevelElements|plugins|http|linkmarker|absolute|focusNode|Delete|imageFloatMargin|onPaste|saveScroll|act|classSize|replaceParagraphsToBr|UL|tagout|alignmentTags|targetTouches|newLevel|isRemoveInline|param|ftp|cleanlevel|clear|OL|clone|imageMargin|DELETE|icon|cite|removeAllRanges|disableSelectAll|lastLevel|createTextNode|modalClose|audio|active|||createRange|convertVideoLinks|tabber|decrease|||||closeHandler|filelink|role|justify|modalHeader|small|selectElement|character|modalFooter|selectNodeContents|rebuffer|undo|autosaveInterval|inputUrl|amp|scrollTarget|setActive|Add|addProperties|events|ctrlKey|isMobileUndoRedo|isSelectAll|insertDblBreakLine|exceptTags|counter||size|node2|singleLine|apply|Array|case|Header|setStartAfter|endNode|addEvent|methodVal|createDocumentFragment|firstChild|autosaveFields|isContainerTable|enable|onSync|formatblock|x200b|replaceToParagraph|eventName|parentA|blockHtml|tabAsSpaces|u00a0|checked|re2|convertLinks|editorHtml|selectionMarkers|com|before|SPACE|nodeType|redo|isTextarea|marginRight|onClick|indentValue|marginLeft|marginBottom|imageFloat|pageY|property|getPlainText|moveToPoint|enterKey|prev2|createTextRange|caretRangeFromPoint|normalizeLists|caretPositionFromPoint|getOffset|encodeEntities|cloned|images|classname|parentEl|deleteProperties|mouseover|mouseout|IMG|substring|safes|isEnabled|formatWrap|formatListToBlockquote|minHeight|bind|maxHeight|caretRange|BLOCKQUOTE|link_new_tab|callbacks|samp|fixEmptyIndent|wrapperHtml|matchContainers|insertInIe|kbd|windowHeight|appendTo|prevList|spaces|modalBody|mso|showOnDesktop|onPasteTidy|clearStyle|ESC|horizontalrule|getOffsetOfElement|activeButtons|FormData|imageFields|navigator|traverseFile|link_insert|userAgent|isArray|selectAll||toolbarExternal|result|getAlignmentElement|splice|auto|restoreScroll|codeLength|saveBodyScroll|onDrag|increase|version|XMLHttpRequest||onDrop|200|special|regex|open|method|scrollbarWidth|specialKey|s3file|isTag|fileFields|placeTag|test|strpos|dataTransfer|createSpaceElement|overflow|enableBodyScroll|iframeEnd|setConfig|iframeStart|firstFound|endOffset|br2|endContainer|insertBreakLineProcessing|readyState|setBefore|curLang|extra|filter|convertImageLinks|mailto|inputText|hover|convertUrlLinks|visible|inValues|setDropdownProperties|setDropdownAttr|outValues|isCurrent|footer|inactive|link_edit|isDelete|addDropdown|allowedAttrData|allowedAttrTags|closeTooltip|activeButtonsStates||quote|setInactiveAll|currentEl|buttonsSize|createButton|isOrderedCmdUnordered|Column|observeScroll|isUnorderedCmdOrdered|listTag|linkSize|slice|regexB|buttonsHideOnMobile|buttonsHide|showOnMobile|createCancelButton|createActionButton|highContrast|addCallback|image_position|URL|placeholdler|setRequestHeader|getTextFromHtml|H6|H5|matched|tagsEmpty|dfn|isCurrentOrParentOne|attrAllowed|Link|headers|add|H4|H3|saveFormTags|convertInline|clearUnverifiedRemove|verifiedTags|listType|listsIds|documentElementRect|formatTableWrapping|content|headTag|count|modules|autosaveName|autosaveOnChange|direction|disableBodyScroll|setAfterOrBefore|fonts|safari|rv||opr|RedactorPlugins|getModuleMethods|syncCode|H2|setFormat|send||removeFormat|TH|isP|imageResizable|imageEditable|normalize|htmlIe||address|status|imageDelete|TAB|isEndOfTable|Table|nodeToCaretPositionFromPoint|rTags|ratio|imageDisplay|selectionStart|selectionEnd|enlargeOffset|removeSpaces|markerLength|showCode|H1|parents|htmlLength|isEndOfEditor|isFocused|redactorImageLink|parseHTML|one|dropdownWidth|formattingAdd|dropdownObject|Row|DOWN|commentsMatches|container|ownLine|head|getText|contOwnLine|tfoot|parentNode|219|BODY|thead|getInlines|hotkeysShiftNums|suffix|finalNodes|cleanTag|setMarker|tbody|startOffset|finish|setOffset|getNodesMarker|paragraphizeBlocks|221||||duplicate|onClickCallback||offsetNode|needle|createTooltip|setEvent|haystack|ie11PasteFrag|disableIeLinks|ie11FixInserting|EndToEnd|setEndPoint|RIGHT|keydownStop|disableMozillaEditing|aside|formatConvert|formatRemoveSameChildren|iPod|args|switch|_this|orgo|strikethrough|tools|BlackBerry|through|iPhone|lastChild|article|savedSel|blocksMatch|execHtml|scope|htmlFixMozilla|haspopup|the|beforekey|||||||||||afterkey|htmlWithoutClean||fullscreen|indented|setEventDropUpload|cleanStyleOnEnter|that|insertParagraph|exitFromBlockquote|decodeURIComponent|replaceDivToParagraph||codeKeydownCallback|tabKey|origHandler|responseText|replaceDivToBreakLine|setEventDrop|onreadystatechange|dbl|stopPropagation|area|overrideMimeType|s3executeOnSignedUrl|arguments|dragImageUpload|insertAfterLastElement|setEvents|insertNewLine|dragFileUpload|onTab|onArrowDown|blur|checkKeyEvents|CTRL|META|ALT|checkEvents|isBlured|focusEnd|stop|setHelpers|formatMultiple|HR|SHIFT|addArrowsEvent|focusCallback|XDomainRequest|setupSelectAll|codeKeyupCallback|LEFT_WIN|altKey|createMarkers|s3createCORSRequest|s3uploadToS3|hotkeysSpecialKeys|setupBuffer|Function|Object|internal|textareaIndenting|onPasteExtra|choose|Mso|setInactive|setActiveInVisual|tempEnd|tempStart||isIe11|modified|indenting|reIsBlock|Center|replaceSelection|isStartOfElement|saveTargetScroll|bmso|saveEditorScroll||clearInterval|removeData|pasteHTML|Video|eventNamespace|Align|destroy|all|indexFromPos|matchBlocks|newTag|replaceDivsToBr|restoreFormTags|onSet|matchBR|savePreFormatting|getPreCode|getOnlyImages|restoreSelectionMarker|saveCodeFormatting|removeDirtyStyles|isSingleLine|onPasteIeFixLinks|setSelectionRange|Code|setInactiveInCode|showVisual|anchor|enableSelectAll|setValue|startSync|onPasteRemoveSpans|onPasteRemoveEmpty|||||||onChange|isCurrentOrParentHeader|selected|onPasteWord|editerWidth|showEdit|loadResizableControls|removeEmptyTags|scrollbar|opacity|padding|15px|cleanSpaces|loadEditableControls|Head|shorthandRegex|walker|increaseLists|removeInvisibleSpace|subscript||foco|Android|replaced|superscript|chrome|increaseText|increaseBlocks|decreaseLists|decreaseBlocks|to|fixImageSourceAfterDrop|inside|imageLink|buttonSave|nofollow|imagePosition|floatValue|buttonDelete|_delete|pastePlainText|FIGCAPTION|Apple|Image|700|floating|linkNofollow|Right|moveResize|Left|round|stopResize|startResize|pageX|chars|update|setFloating|setResizable|formatCollapsed|onShiftEnter|setFormattingTags|replaceElement|setTitle|setContent|getTemplate|loadButtons|alignElement|template|||||jsxhr|spans|removeEmptyListInTable|setDraggable|isNeedReplaceElement|setText||createDeleteButton|setButtonsWidth|bindModuleMethods|createContainer||cancel|setEnter|draggable|handle|isLinebreaksOrNoBlocks|setBlocks|setFixed|map|setMultiple|observeScrollDisable|observeScrollEnable|setCollapsed|formatTags|getPrev|visibility|anchorNode|setDropdownsFixed|newTd|commonAncestorContainer|fadeOut|hideButtonsOnMobile|toolbarOverflow|checkbox|setOverflow|success|toolbarFixed|fieldset|isButtonSourceNeeded|hideButtons|loadTemplates|imageEdit|callbackName|mouseup|measure|setEditable|paragraph|removeAttrs|linkTooltip|removeParagraphsInLists|getSafesComments|restoreSafes|lineAfter|Color|setupAllowed|header1|showTooltip|addToAllowed|aUnlink|aEdit|removeFromDenied|Edit|removeTags|aLink|getSafes|getTooltipPosition|here|removeAttrGetRemoves|Drop|replaceBreaksToParagraphs|properties|enableEvents|shortcutsAdd|align_left|createPasteBox|freeze|buildOverlay|align_center|loadModules|loadOptions|align_justify|align_right|disableEvents|header5|lineBefore|replaceBreaksToNewLines|png|header2|header3|cleanOnPaste|List|destroyed|header4|gif|unsetDropdownsFixed|contrast|textNode|elements|600|xn|location|thref|createContainerBox|insertAfter|parseJSON|isExceptLastOrFirst|setNodesMarker|imageUploadParam|fileUploadParam|_moz_dirty|hidden|setCodeAndCall|onDragLeave|createTextarea|getType|setFocus|objects|imageTypes|insertInOthersBrowsers|getUndo|fromElement|startPointNode|cleanUrl|empty|run|getRedo|fromTextarea|lastFound|re3|langs|startContainer|removeNodesMarkers|getInlinesTags|s3uploadFile|setEndBefore|setForce|getTextareaName|measureScrollbar|signedURL|regexp|sendData|loadContent|keyupStop|isKey|clientWidth|upload_label|buttonText|enableEditor|getData|callEditor|lastBlock|getLastBlock|loadEditor|buttonInsert|setRedo|formatEmpty|setOptions|isOverflowing|directUpload|change|formatBlockquote|convertImages|dir|setUndo|pop|opera|drop_file_here|compatible|UP|ltr|VERSION|trident|cut|docs|sid|hgroup|down|guid|rowspan|home|Name|Download|105|math|removePhp|uploadImageField||legend|documentElement|textContent|innerText|104|download|getBoundingClientRect|stripTags|savePreCode|up||Alignment|Open|colspan|youtu|Anchor|fake|Or|Trident|Underline|LEFT|10px|toUpperCase|isOldIe|Choose|or_choose|isLessIe10|jpe|such|post|enableInlineTableEditing|setToPoint|Infinity|nextNode|SHOW_TEXT|AutoUrlDetect|done|ajax|112|reg|No|107|enableObjectResizing|strict|1000|getCoords|setInterval|111|Horizontal|removeChild|setAwesome|offsetWidth|Justify|addFirst|addBefore|Rule|110|109|removeIcon|autosaveError|createTreeWalker|NodeFilter|caretOffset|setStartBefore|disable|changeIcon|setEndAfter|u2122|trade|application|blurCallback|WordDocument|addAfter|TEXTAREA|sdata|getOwnPropertyNames|converted|xml|1strike|shapes|merge|Deleted|115|applet|spacerun|yes|floor|use|113|u2026|hellip|u2014|101|abs|106|u00a9|copy|102|103|u2010|dash|toggleAttr|setAttr|toggleData|setData|mdash|slevel|hexToRgb|Below|host|noscript|err|Requested|With|frame|insertHtml|insert_column_left|clearFileFields|removeImageFields|addImageFields|clearImageFields|insert_row_below|php|addBack|insert_row_above|insert_table||500|frameborder|281|Above|uploadImageFields|uploadFileFields|POST|createLink|insertedLink|deletedLink|addFileFields|removeFileFields|context|enter|FOOTER|ASIDE|0px|onload|optional|222|220|rows|delete_table|onprogress|onerror|PUT|_|user|defined|charset|fromPoint|GET|plain|extractContents|insert_column_right|delete_row|fromCharCode|Key|withCredentials|delete_column|allowfullscreen|uploadStart|times|Close|9999px|overlay|bull|jQuery|labelledby|dialog|cursor|Outdent|move|pasteBefore|Quote|fast|bodyOveflow|unselectable|addButton|specified|backcolor||fontcolor||Font|Back|toggleActive||Ordered|modalClosed|Bold|Unordered|hasOwnProperty|Normal|Indent|getNext|nextSibling|previousSibling|relative|Unlink|Cancel|Save|HTML|ARTICLE|player|grep|dragleave|dragover|1500|fadeIn|focusin|modalOpened|email|outerHeight|20px|external|getModal|frameset|Formatting|createTabber|addTab|addTemplate|Content|Type|SECTION|119|Embed|getObject|getBox|getEditor|ADDRESS|118|117|getValue|DT|DD|OUTPUT|getElement|getTextarea|HEADER|Email|Text|121|max|dropdownShow|web|video_html_code|Callback|getToolbar|_data|120|namespace|listSelections|setSelection|menu||esc|cleanEmptyParagraph|capslock|pause|summary|details|pageup|pagedown|getOnlyLinksAndImages|Upload|File|nav|Vimeo|alignleft|DL|116|setSize|refresh|setCursor|Youtube|backspace|alignright|aligncenter|syncBefore|jpeg|ins|Ss|f10|isString|114|columns|iPad|cssText|getHtml|Columns|u200D|189|188|add_head|uFEFF|TR|removeStyle|removeStyleRule|nodeToPoint|amz|192|clientX|Rows|clientY|191|acl|toggleStyle|190|read|public|insertHTML|imageUploadError|delete_head|f12|705|144|numlock|image_web_link|145|123|Web|dropdownHide|122|replaceWithHtml|f11|fileUploadError|dragstart|mousemove|187|None|Position|Title|cloneContents|Italic|dropdownShown|rgb|186|173|touchmove|touchend'.split('|'),0,{}))
>>>>>>> parent of 7093d97... 2020 Update
